\documentclass{amsart}
\usepackage[utf8]{inputenc}

\newcommand{\nirpdftitle}{191 Term Paper}
\usepackage{import}
\inputfrom{.}{pre}
\usepackage[backend=biber,
    style=alphabetic,
    sorting=ynt
]{biblatex}
\addbibresource{../bib.bib}
\addtolength{\headheight}{12.0pt}

\pagestyle{contentpage}

\title{Modular Forms and Converse Theorems}
\author{Nir Elber}
\date{5 May 2023}
\lhead{} \chead{} \rhead{\textit{CONVERSE THEOREMS}}

\begin{document}

\begin{abstract}
	\noindent We introduce the basics of modular forms in order to state and prove Hecke's converse theorem \cite{hecke-converse}. Throughout, we will give commentary at a high level, but all proofs will assume little background beyond complex analysis and Fourier analysis.
\end{abstract}

\maketitle

\setcounter{tocdepth}{2}
\tableofcontents

\section{Introduction}
The goal of this note is to introduce modular forms in order to state and prove Hecke's converse theorem \cite{hecke-converse}. As such, we will spend a little time explaining why one might care.

Speaking roughly to avoid technicalities for the moment, a modular form is some highly symmetric holomorphic function $f$. For example, one can express $f$ via a Fourier expansion
\[f(z)=\sum_{n=0}^\infty a_ne^{2\pi inz}.\]
For convenience, we will assume that $a_0=0$. It will be productive to relate $f$ to an $L$-function, which we will define in the natural way as
\[L(s,f)\coloneqq\sum_{n=1}^\infty\frac{a_n}{n^s}.\]
The symmetries enforced on $f$ turn out to rather formally imply that the ``completed $L$-function'' $\Lambda(s,f)\coloneqq(2\pi)^{-s}\Gamma(s)L(s,f)$ satisfies a functional equation
\begin{equation}
	\Lambda(s,f)=(-1)^{k/s}\Lambda(k-s,f) \label{eq:l-func-eq}
\end{equation}
for some integer $k$ depending on $f$. Roughly speaking, the main ingredient in this result is the computation that the Mellin transform of $f$ equals $\Lambda(s,f)$. As such, it is not too surprising that applying Mellin inversion allows us to go the other way.
\begin{theorem}[Hecke]
	Suppose that the function
	\[L(s,f)\coloneqq\sum_{n=1}^\infty\frac{a_n}{n^s}\]
	satisfies the functional equation \eqref{eq:l-func-eq}. Then, under suitable growth conditions, the function $f(s)\coloneqq\sum_{n=1}^\infty a_ne^{2\pi inz}$ is a modular form.
\end{theorem}
This is our converse theorem. We will state and prove this result more formally later.\todo{}

\section{Congruence Subgroups}
In this note, we will be primarily interested in modular forms. Roughly speaking, these are highly symmetric functions, so to begin our definition, we ought to discuss the symmetries we want to obey.
\begin{definition}[congruence subgroup]
	Fix a positive integer $N$. Then we define the subgroup
	\[\Gamma(N)\coloneqq\left\{\begin{bmatrix}
		a & b \\
		c & d
	\end{bmatrix}\in\op{SL}_2(\ZZ):\begin{bmatrix}
		a & b \\
		c & d
	\end{bmatrix}\equiv\begin{bmatrix}
		1 & 0 \\
		0 & 1
	\end{bmatrix}\pmod N\right\}.\]
	Then a subgroup $\Gamma\subseteq\op{SL}_2(\ZZ)$ is a \textit{congruence subgroup} if and only if $\Gamma$ contains $\Gamma(N)$ for some positive integer $N$; the least $N$ such that $\Gamma\supseteq\Gamma(N)$ is the \textit{level} of $\Gamma$.
\end{definition}
Note that the $\Gamma(N)$ are all normal subgroups of $\op{SL}_2(\ZZ)$ because $\Gamma(N)$ is the kernel of the reduction map $\op{SL}_2(\ZZ)\to\op{SL}_2(\ZZ/N\ZZ)$. In this article, our focus will be on level $1$, which means $\Gamma=\Gamma(1)=\op{SL}_2(\ZZ)$, but it will be occasionally useful to have the language for more general congruence subgroups.

Because we will primarily focus on level $1$, the following result will alleviate some headaches.
\begin{proposition} \label{prop:gens-for-sl2z}
	The group $\op{SL}_2(\ZZ)$ is generated by the matrices
	\[S\coloneqq\begin{bmatrix}
		0 & -1 \\
		1 & 0
	\end{bmatrix}\qquad\text{and}\qquad T\coloneqq\begin{bmatrix}
		1 & 1 \\
		0 & 1
	\end{bmatrix}.\]
\end{proposition}
\begin{proof}
	This is essentially the Euclidean algorithm. We must show that
	\[\gamma\coloneqq\begin{bmatrix}
		a & b \\
		c & d
	\end{bmatrix}\]
	can be written as a product of $S$s and $T$s for any $\gamma\in\op{SL}_2(\ZZ)$. By multiplying $\gamma$ by $S^2=-I$, we may assume that $a\ge0$. Observe that
	\[S\gamma=\begin{bmatrix}
		-c & -b \\
		a & d
	\end{bmatrix},\]
	so multiplying $\gamma$ by $S$ on the left lets us also require $a=|a|\ge|c|$. Continuing, we note that
	\[T^n\gamma=\begin{bmatrix}
		a+nc & b+nd \\
		c & d
	\end{bmatrix},\]
	so applying the division algorithm to $\gamma$ lets us assume that $0\le a<|c|$ or $c=0$. Namely, repeatedly multiplying $\gamma$ by $S$ and $T$ on the left (applying the Euclidean algorithm) lets us enforce $c=0$. But then $ad=\det\gamma=1$ and $a\ge0$ enforces $a=d=1$. At this point, we can complete the proof by noting
	\[\gamma=\begin{bmatrix}
		1 & b \\
		0 & 1
	\end{bmatrix}=T^b,\]
	so $\gamma$ is in fact a product of $S$s and $T$s.
\end{proof}

Thus far, we have described the groups which will be our symmetries, but we must have these groups act on something.
\begin{definition}
	The group $\op{GL}_2(\RR)$ acts on $\PP^1_\CC\coloneqq\CC\cup\{\infty\}$ by the multiplication
	\[\begin{bmatrix}
		a & b \\
		c & d
	\end{bmatrix}z\coloneqq\frac{az+b}{cz+d}\qquad\text{and}\qquad\begin{bmatrix}
		a & b \\
		c & d
	\end{bmatrix}\infty\coloneqq\frac bd.\]
	Namely, if the denominator is zero, we say that the output is $\infty$.
\end{definition}
In reality, what's going on is that $\op{GL}_2(\RR)$ acts on $\CC^2\setminus\{(0,0)\}$ by matrix-vector multiplication. Mapping $\CC^2\setminus\{(0,0)\}\to\PP^1_\CC$ by $(z,w)\mapsto z/w$ (and $(z,0)\mapsto\infty$) yields the above action of $\op{GL}_2(\RR)$ on $\PP^1_\CC$.

Roughly speaking, we are going to want to restrict our action to $\mathbb H\coloneqq\{z\in\CC:\op{Im}z>0\}$, so we must track the imaginary part in our action. Well, for $x+yi\in\CC$, we compute
\[\op{Im}\left(\begin{bmatrix}
	a & b \\
	c & d
\end{bmatrix}z\right)=\op{Im}\left(\frac{az+b}{cz+d}\right)=\frac{(ad-bc)\op{Im}z}{|cz+d|^2}.\]
Thus, for any $\gamma\in\op{SL}_2(\ZZ)$ so that $\det\gamma=1$, we see that $z\in\mathbb H\cup\PP^1_\QQ$ implies that $\gamma z\in\mathbb H\cup\PP^1_\QQ$. In total, we have defined an action of $\op{SL}_2(\ZZ)$ on $\mathbb H\cup\PP^1_\QQ\subseteq\PP^1_\CC$. For brevity, we define $\mathbb H^*\coloneqq\mathbb H\cup\PP^1_\QQ$. Elements of $\PP^1_\QQ$ are called ``cusps.''
\begin{remark}
	Notably, the orbit of $\infty$ under the action of $\op{SL}_2(\ZZ)$ is all of $\PP^1_\QQ$, which explains why we are forcing ourselves to include it. It turns out that $\mathbb H^*$ has the structure of a complex manifold.
\end{remark}

\section{Modular Forms}

\subsection{The Definition}
Roughly speaking, a modular form is a holomorphic function symmetric under a congruence subgroup. We will give the technically correct definition to begin and then explain why we have chosen this definition.
\begin{definition}[modular form, cusp form]
	Fix an integer $k$ and congruence subgroup $\Gamma\subseteq\op{SL}_2(\ZZ)$. A \textit{meromorphic modular form of weight $k$ and level $\Gamma$} is a meromorphic function $f\colon\mathbb H^*\to\CC$ such that
	\begin{equation}
		f\left(\begin{bmatrix}
			a & b \\
			c & d
		\end{bmatrix}z\right)=(cz+d)^kf(z)\qquad\text{for all}\qquad\begin{bmatrix}
			a & b \\
			c & d
		\end{bmatrix}\in\Gamma. \label{eq:symmetry-condition}
	\end{equation}
	If $f$ is holomorphic on $\mathbb H^*$, then $f$ is a \textit{modular form of weight $k$ and level $\Gamma$}. In other words, we need $f$ to be holomorphic on $\mathbb H$ as well as ``holomorphic at each cusp $c\in\PP^1_\QQ$'' in that $|f(z)|$ is bounded as $z\to c$; namely, $z\to\infty$ means that $\op{Im}z\to\infty$. If $f$ vanishes at each cusp, then $f$ is a \textit{cusp form}.
\end{definition}
\begin{remark}
	Morally, one would define being holomorphic on $\mathbb H^*$ by providing a complex manifold structure on $\mathbb H^*$ so that we may talk about holomorphic maps $\mathbb H^*\to\CC$. Roughly speaking, our boundedness condition approaching cusps is the same notion as being holomorphic in the sense of these complex manifolds by the Removable singularity theorem. This is essentially the content of \Cref{prop:q-expansion}.
\end{remark}
% It is not totally clear what is meant by ``holomorphic on $\mathbb H^*$'' because of the addition of the mysterious points $\PP^1_\QQ$. The correct formulation of this condition is to regard $\mathbb H^*$ as a complex manifold so that we are asking for $f$ to be a holomorphic map of complex manifolds. More concretely, we may ask for $f$ to be holomorphic on the open subset $\mathbb H\subseteq\CC$ and to be ``holomorphic on the cusps'' in the sense that $|f(z)|$ is bounded as $z\to c$ for any $c\in\PP^1_\QQ$; here, $z\to\infty$ means that $\op{Im}z\to\infty$. We might write $z\to i\infty$.
% To see that this boundedness is the same notion as being holomorphic as a complex manifold, we should place some complex manifold structure on an open neighborhood of $\infty$ (or any of the other elements of $\PP^1_\QQ$) and check that boundedness is the same thing as 
The chief mystery in our definition of a modular form is the presence of the factor $(cz+d)^k$. As a first explanation, there are simply not many modular forms of weight $0$: we will not prove it, but all these modular forms are constant functions. One might complain that it is not clear that there are modular forms of higher weights, but we assure the reader that such modular forms exist. We will not need this in the sequel, but it is worth saying that the Eisenstein series
\[G_k(z)\coloneqq\sum_{\substack{(m,n)\in\ZZ^2\\(m,n)\ne(0,0)}}\frac1{(mz+n)^k}\]
converges uniformly for $k\ge4$ and produces a nonzero modular form of weight $k$ and level $\op{SL}_2(\ZZ)$ when $k\ge4$ is even.\footnote{Plugging in $-I$ to the symmetry condition in \eqref{eq:symmetry-condition} reveals that $f(z)=(-1)^kf(z)$, so all nonzero modular forms for $\op{SL}_2(\ZZ)$ have even weight.}

An alternate perspective is that we are trying to find $\Gamma$-invariant $k$-fold differential forms on $\mathbb H^*$. Indeed, if $f(z)\cdot(dz)^k$ is a $\Gamma$-invariant $k$-fold differential form on $\mathbb H^*$, then we can compute
\[f(z)\cdot(dz)^k=f\left(\frac{az+b}{cz+d}\right)\cdot \left(d\,\frac{az+b}{cz+d}\right)^k=(cz+d)^{-2k}f(z)\cdot(dz)^k\]
for any matrix in $\Gamma$. (We have used the fact that $\Gamma\subseteq\op{SL}_2(\ZZ)$ in the above computation.) Rearranging the above equation produces the desired symmetry condition for the weight $2k$.

\subsection{The \texorpdfstring{$q$}{q}-Expansion}
It is not entirely obvious how to write down a modular form; for example, we were able to write down the Eisenstein series $G_k$ via some kind of infinite series, but such series expansions have no reason to generalize to other modular forms, even of level $\op{SL}_2(\ZZ)$. It turns out that the best way to write down a modular form is via Fourier analysis.
\begin{proposition}[{$q$-expansion}] \label{prop:q-expansion}
	Let $f\colon\mathbb H\to\CC$ be a holomorphic function which is also holomorphic at $i\infty$. If $f(z)=f(z+1)$, then there are complex numbers $a_0,a_1,\ldots$ such that
	\[f(z)=\sum_{n=0}^\infty a_nq^n\]
	where $q\coloneqq e^{2\pi iz}$. Such an expansion is called a ``$q$-expansion.''
\end{proposition}
\begin{proof}
	Roughly speaking, what's going on here is that the periodicity requirement $f(z)=f(z+1)$ implies that we can give $f$ a Fourier expansion. Then being bounded as $z\to\infty$ implies that the negative terms of our Fourier series must vanish.

	With that said, it is possible to provide an argument avoiding Fourier analysis. Define the function $\overline f$ by $\overline f\left(e^{2\pi inz}\right)\coloneqq f(z)$ for $z\in\mathbb H$. To see that $\overline f$ is well-defined, we note that $e^{2\pi inz_1}=e^{2\pi inz_2}$ if and only if $z_1-z_2$ is an integer, but then $f(z_1)=f(z_2)$ because $f(z)=f(z+1)$ for any $z$. Now, the codomain of $\overline f$ is $\CC$, and its domain is given by
	\[\left\{e^{2\pi inz}:z\in\mathbb H\right\}=\left\{e^{-z}:\op{Re}z>0\right\}=\{q:0<|q|<1\}.\]
	Thus, we have defined a function $\overline f$ from the punctured open disk of radius $1$ to $\CC$. In fact, we can check by hand that $\overline f$ is holomorphic: for any $q$ and $q'$ with $q=e^{2\pi inz}$ and $q'=e^{2\pi inz'}$, we see
	\[\frac{\overline f(q)-\overline f(q')}{q-q'}=\frac{f(z)-f(z')}{z-z'}\cdot\frac{z-z'}{e^{2\pi inz}-e^{2\pi inz'}}.\]
	Because $f$ is holomorphic, and the function $z\mapsto e^{2\pi inz}$, we see that the limit on the right-hand side is finite as $z'\to z$, so the limit on the left-hand side is finite as $q'\to q$, meaning that $\overline f$ is holomorphic.

	Now, we would like to extend $\overline f$ to the full open disk of radius $1$. For this, we note that $|f(z)|$ being bounded as $\op{Im}z\to\infty$ translates into $|\overline f(q)|$ being bounded as $q\to0$. So because $\overline f$ is already holomorphic on the punctured open disk of radius $1$, the Removable singularity theorem allows us to extend $\overline f$ to a holomorphic function on the open disk of radius $1$. Being holomorphic, we may give $\overline f$ a Taylor expansion
	\[\overline f(q)=\sum_{n=0}^\infty a_nq^n,\]
	so plugging in $f(z)=\overline f\left(e^{2\pi inz}\right)$ completes the proof.
\end{proof}
\begin{example} \label{ex:gk-q-expansion}
	For even $k\ge4$, the $q$-expansion of $G_k(z)$ is given by
	\[G_k(z)=2\zeta(k)+\frac{2(2\pi i)^k}{(k-1)!}\sum_{n=1}^\infty\sigma_{k-1}(n)q^n.\]
	We will not need this for the main theorem, so we will not prove it.
\end{example}
\begin{remark}
	If $f$ is a modular form of level $\Gamma(N)$, then we see
	\[f(z+N)=f\left(\begin{bmatrix}
		1 & N \\
		0 & 1
	\end{bmatrix}z\right)=f(z),\]
	so the holomorphic function $g(z)\coloneqq f(z/N)$ will have a $q$-expansion by \Cref{prop:q-expansion}. Thus, we are able to give $f$ the $q$-expansion
	\[f(z)=\sum_{n=0}^\infty a_nq^{n/N}.\]
\end{remark}
\Cref{prop:q-expansion} only partially uses the symmetry condition of a modular form, of any level. One can ask if it is possible to ``see'' the other symmetries in this $q$-expansion as well, though in practice this is hard. As a partial result, we note that these symmetry conditions are able to place constraints on the size of our coefficients.
\begin{proposition} \label{prop:coeff-bound}
	Let $f\colon\mathbb H^*\to\CC$ be a modular form of level $\Gamma(N)$ and weight $k$ have $q$-expansion given by $f(z)=\sum_{n=0}^\infty a_ne^{2\pi inz/N}$. If $f$ is a cusp form (i.e., vanishes at all cusps) or $k<0$, then there is an absolute constant $C_f$ such that $|a_n|\le C_fNe^{2\pi ny/N}y^{-k/2}$ for any real $y>0$.
\end{proposition}
\begin{proof}
	Define the function $i\colon\mathbb H\to\RR$ by $h(z)\coloneqq|f(z)|(\op{Im}z)^{k/2}$. The point is that $f$ is invariant under $\Gamma(N)$ and vanishes as $z\to c$ for any cusp $c\in\PP^1_\QQ$. To see the invariance, we compute
	\[\left|f\left(\begin{bmatrix}
		a & b \\
		c & d
	\end{bmatrix}z\right)\right|\left(\op{Im}\begin{bmatrix}
		a & b \\
		c & d
	\end{bmatrix}z\right)^{k/2}=|cz+d|^k|f(z)|\cdot\frac{(\op{Im}z)^{k/2}}{|cz+d|^{k}}=|f(z)|(\op{Im}z)^{k/2}.\]
	To see that $h$ vanishes as $z\to c$ at a cusp $c\in\PP^1_\QQ$, we note that $f$ is surely bounded as $z\to c$, so we get the result for free if $k<0$. On the other hand, translating the given cusp to $i\infty$ via $\op{SL}_2(\ZZ)$, we note that $f$ vanishing at $c$ turns into $a_0=0$ of the corresponding $q$-expansion. As such, $e^{-2\pi iz/N}f(z)\to a_1$ as $z\to i\infty$, so $|f(z)|(\op{Im}z)^{k/2}\to 0$ as $z\to i\infty$ because $e^{-2\pi iz/N}(\op{Im}z)^{k/2}\to0$ as $z\to i\infty$ (rapidly).

	In total, we claim that $h$ is bounded. Because $h$ is bounded in open neighborhoods around each cusp, we may subtract out such open neighborhoods to be left with a compact subset of $\mathbb H^*/\Gamma(N)$, whereupon the result follows because continuous functions on compact sets are bounded. More explicitly, we note that $f(z+N)=f(z)$ means that we only have to look in a fixed vertical strip of $\mathbb H$, and the fact that $h$ vanishes at the cusps implies that $h$ is bounded for large values of $\op{Im}z$ and similar for the other cusps. So it suffices to look at values of $h$ on a compact subset of $\mathbb H$ and argue as above.

	Because $h$ is bounded on $\mathbb H^*$, let $C$ denote its maximum. We now extract our Fourier coefficients. On one hand, the Cauchy integral formula applied to the $q$-expansoin of $f$ yields
	\[a_n=\int_0^Nf(x+yi)e^{-2\pi in(x+yi)/N}\,dx=e^{2\pi ny/N}\int_0^Nf(x+yi)e^{-2\pi inx/N}\,dx\]
	for any real $y>0$. However, we can upper-bound this as
	\[|a_n|\le e^{2\pi ny/N}\int_0^N|f(x+yi)|\,dy\le CNe^{2\pi ny/N}y^{-k/2},\]
	which is what we wanted.
\end{proof}
\begin{corollary}
	The only modular form $f$ of level $\Gamma(N)$ and weight $k$ for $k<0$ is the zero function.
\end{corollary}
\begin{proof}
	Suppose $f(z)=\sum_{n=0}^\infty a_ne^{2\pi inz/N}$ is such a modular form. Sending $y\to0^+$ in \Cref{prop:coeff-bound} implies that $a_n=0$ for all $n$.
\end{proof}
\begin{corollary} \label{cor:cusp-form-coeffs}
	Let $f\colon\mathbb H^*\to\CC$ be a modular form of level $\Gamma(N)$ and weight $k$ have $q$-expansion given by $f(z)=\sum_{n=0}^\infty a_ne^{2\pi inz/N}$. If $f$ vanishes at all cusps, then there is an absolute constant $C$ such that $|a_n|\le CNe^{2\pi/N}n^{k/2}$.
\end{corollary}
\begin{proof}
	Set $y=1/n$ in \Cref{prop:coeff-bound}.
\end{proof}
\begin{remark} \label{rem:mod-forms-cusps}
	Suppose $f$ is a modular form of level $\op{SL}_2(\ZZ)$. Then one can see that any nonzero modular form $f(z)=\sum_{n=0}^\infty a_nq^n$ of weight $k$ has $k\ge4$ and $k$ even; in particular, one can show with some effort that there are no modular nonzero modular forms of weight $2$. As such there exists a constant $a$ such that $g(z)\coloneqq f(z)-aG_k(z)$ is a cusp form. Upon comparing $q$-expansions of the cusp form $g$ in \Cref{cor:cusp-form-coeffs} and of $G_k$ in \Cref{ex:gk-q-expansion}, we see that $f(z)=g(z)+aG_k(z)$ must have $a_n=O\left(n^{k-1}\right)$.
\end{remark}

% \begin{proposition} \label{prop:weight-0}
% 	Let $f$ be a modular form of weight $0$. Then $f$ is a constant function.
% \end{proposition}
% \begin{proof}
% 	Omitted for now.\todo{}
% \end{proof}

\section{Hecke's Converse Theorem}
For the main content of this article, we will focus on ``level $1$,'' meaning $\Gamma=\op{SL}_2(\ZZ)$; most of our results and definitions generalize appropriately, but this convention will ease notation. Notably, if the level has been omitted from a modular form, we will assume that the modular form has level $\op{SL}_2(\ZZ)$. Notably, by \Cref{prop:gens-for-sl2z}, it suffices to check the symmetry conditions
\begin{equation}
	f(z+1)=f(Tz)=f(z)\qquad\text{and}\qquad f(-1/z)=f(Sz)=z^kf(z). \label{eq:level-1-symmetry-condition}
\end{equation}
Indeed, one can directly compute that if $f$ satisfies the symmetry condition of \eqref{eq:symmetry-condition} for $\gamma$ and $\gamma'$, then $f$ satisfies the symmetry condition for $\gamma\gamma'$ and $\gamma^{-1}$.

\subsection{The \texorpdfstring{$L$}{ L}-Function}
We fix some notation. Given a modular form $f$ of weight $k$ with $q$-expansion $f(z)=\sum_{n=0}^\infty a_nq^n$, we define the $L$-function
\[L(s,f)\coloneqq\sum_{n=1}^\infty\frac{a_n}{n^s}.\]
By \Cref{rem:mod-forms-cusps}, we see that the coefficients of $a_n$ have polynomial growth, so $L(s,f)$ converges absolutely and uniformly to a holomorphic function in some right-half plane of $\CC$. Notably, we have lost the $a_0$ term. As with the story of the $\zeta$-function and the Jacobi $\theta$-function, we might hope that the symmetry conditions of $f$ will give rise to a functional equation for $L$. Indeed, this is the case. We begin with a lemma.
\begin{lemma} \label{lem:computed-completed-l-func}
	Let $f$ be a modular form of weight $k$. For $\op{Re}s>k$, we have
	\[\int_0^\infty(f(yi)-a_0)y^s\,\frac{dy}y=(2\pi)^{-s}\Gamma(s)L(s,f).\]
\end{lemma}
\begin{proof}
	This is a direct computation. It is not yet obvious that the integral on the left even converges, so we will work from the right to the left. Write
	\begin{align*}
		(2\pi)^{-s}\Gamma(s)L(s,f) &= \sum_{n=1}^\infty\left(a_n(2\pi)^{-s}\int_0^\infty e^{-y}y^s\,\frac{dy}y\right) \\
		&= \sum_{n=1}^\infty\int_0^\infty a_ne^{-y}\left(\frac y{2\pi}\right)^s\,\frac{dy}y \\
		&= \sum_{n=1}^\infty\int_0^\infty a_ne^{2\pi i(yi)}y^s\,\frac{dy}y.
	\end{align*}
	Now, we note that we have absolute convergence of this sum of integral: reversing the computation, we are trying to show that $(2\pi)^{-s}\Gamma(s)\sum_{n=1}^\infty\frac{|a_n|}{n^s}$ converges, which is true because $a_n=O\left(n^{k-1}\right)$ and $\op{Re}s>k$. Exchanging the sum and the integral produces the desired result.
\end{proof}
The point is that we are able to recover the ``completed'' $L$-function
\[\Lambda(s,f)\coloneqq(2\pi)^{-s}\Gamma(s)L(s,f)\]
as the Mellin transform of $f(yi)-a_0$. This provides a more concrete connection between the modular form $f$ and its attached $L$-function. With this in hand, we can prove that $\Lambda$ has a meromorphic continuation and functional equation.
\begin{proposition} \label{prop:fe}
	Let $f$ be a modular form of weight $k$ with $q$-expansion $f(z)=\sum_{n=0}^\infty a_nq^n$. Then $\Lambda(s,f)$ has a meromorphic continuation to all of $\CC$ with at worst simple poles at $s=0$ and $s=k$ with residues $-a_0$ and $(-1)^{k/2}a_0$. Furthermore, $\Lambda$ satisfies the functional equation
	\[\Lambda(s,f)=(-1)^{k/2}\Lambda(k-s,f).\]
\end{proposition}
Notably, if $a_0=0$, then $\Lambda$ is actually holomorphic on all $\CC$.
\begin{proof}
	One can see the functional equation more or less directly from the symmetry condition $f(i/y)=(yi)^kf(iy)$ from \eqref{eq:level-1-symmetry-condition} plugged into \Cref{lem:computed-completed-l-func}. However, it will be more efficient in exposition to produce the analytic continuation and the functional equation at once. As such, the plan is to roughly follow Riemann's original proof of the functional equation of $\zeta$, writing everything out as integrals away from $0$ where convergence is safe. With this in mind, we use \Cref{lem:computed-completed-l-func} to write
	\[\Lambda(s,f)=\int_0^1(f(yi)-a_0)y^s\,\frac{dy}y+\int_1^\infty(f(yi)-a_0)y^s\,\frac{dy}y.\]
	Now, $(f(z)-a_0)/q\to a_1$ as $z\to i\infty$ by definition of the $q$-expansion, so $(f(yi)-a_0)e^{2\pi y}\to a_1$ as $y\to\infty$, so $f(yi)-a_0$ vanishes rapidly as $y\to\infty$, meaning that the integral on the right converges absolutely and uniformly on compacts to a holomorphic function for all $s\in\CC$. It remains to deal with the integral on the left, for which we use the relation
	\[f(i/y)=(yi)^kf(yi)=(-1)^{k/2}y^kf(yi)\]
	coming from plugging $yi$ into \eqref{eq:level-1-symmetry-condition}. Indeed, for $\op{Re}s>k$ where we have absolute convergence of everything by the previous lemma, we use the above symmetry condition combined with the substitution $y\mapsto1/y$ to write
	\begin{align*}
		\int_0^1(f(yi)-a_0)y^s\,\frac{dy}y &= (-1)^{k/2}\int_0^1f(i/y)y^{s-k}\,\frac{dy}y-\frac{a_0}s \\
		&= (-1)^{k/2}\int_1^\infty f(yi)y^{k-s}\,\frac{dy}y-\frac{a_0}s \\
		&= (-1)^{k/2}\int_1^\infty(f(yi)-a_0)y^{k-s}\,\frac{dy}y-\frac{a_0}s-(-1)^{k/2}\frac{a_0}{k-s}.
	\end{align*}
	At this point, we may collect our terms in $\Lambda(s,f)$ back together into
	\[\Lambda(s,f)=\left(\int_1^\infty(f(yi)-a_0)y^s\,\frac{dy}y-\frac{a_0}s\right)+(-1)^{k/2}\left(\int_1^\infty(f(yi)-a_0)y^{k-s}\,\frac{dy}y-\frac{a_0}{k-s}\right).\]
	Now, as discussed before, the integrals on the right-hand side converge absolutely and uniformly on compacts to a holomorphic function on all $\CC$, from which the meromorphic continuation of $\Lambda(s,f)$ follows. The above expression for $\Lambda(s,f)$ also implies that $\Lambda(s,f)=(-1)^{k/2}\Lambda(k-s,f)$ upon plugging in $k-s$.
\end{proof}
\begin{remark}
	\Cref{prop:fe} is somewhat remarkable in that it tells us that $L(s,f)$ ``remembers'' the constant term $a_0$ of the modular form $f$ even though it is not featured in the actual $L$-function.
\end{remark}

\subsection{The Converse Theorem}
The main input to \Cref{prop:fe} was the computation of $\Lambda(s,f)$ as a Mellin transform of $f(yi)-a_0$ plus the symmetry condition \eqref{eq:level-1-symmetry-condition}. As such, it is not too surprising that one can invert the Mellin transform in order to use the functional equation of $\Lambda$ to produce a symmetry condition for $f$. Here is our precise statement.
\begin{theorem}[Hecke]
	Let $\{a_n\}_{n=0}^\infty$ be a sequence of complex numbers such that $|a_n|=O\left(n^c\right)$ for some real number $c>0$. For $\op{Re}s>c+1$, define
	\[L(s,f)\coloneqq\sum_{n=1}^\infty\frac{a_n}{n^s}\qquad\text{and}\qquad\Lambda(s,f)\coloneqq(2\pi)^{-s}\Gamma(s)L(s,f).\]
	Further, suppose the following of $\Lambda$ for some even positive integer $k$.
	\begin{itemize}
		\item $\Lambda$ has a meromorphic continuation to $\CC$ with at worst simple poles at $s=0$ and $s=k$ with residues $-a_0$ and $(-1)^{k/2}a_0$, respectively
		\item $\Lambda$ is bounded in the vertical strips $\{s:\sigma_1\le\op{Re}s\le\sigma_2,\left|\op{Im}s\right|\ge1\}$ for any real numbers $\sigma_1<\sigma_2$.
		\item $\Lambda$ satisfies the functional equation $\Lambda(s,f)=i^k\Lambda(k-s,f)$.
	\end{itemize}
	Then $f(z)\coloneqq\sum_{n=0}^\infty a_ne^{2\pi inz}$ is a modular form of weight $k$.
\end{theorem}
\begin{proof}
	The infinite series defining $f$ converges absolutely and uniformly on compacts for $\op{Im}z>0$ because $|a_n|=O\left(n^c\right)$. Thus, $f$ defines a holomorphic function on $\mathbb H$. Furthermore, as $z\to i\infty$, we see that $f(z)\to a_0$, so $f$ is holomorphic on $\mathbb H^*$. It remains to check the symmetry conditions in \eqref{eq:level-1-symmetry-condition}. By the definition of $f$, we note that $e^{2\pi in(z+1)}=e^{2\pi inz}$ for any $z\in\mathbb H$, so $f(z+1)=f(z)$ for any $z\in\mathbb H$. It remains to check that
	\[f(-1/z)\stackrel?=z^kf(z)\]
	for any $z\in\mathbb H$. Because $f$ is holomorphic on $\mathbb H$, the left- and right-hand sides of this equation are both holomorphic, so it suffices to check that $f(-1/z)=z^kf(z)$ on the positive imaginary axis. In other words, it suffices to check that
	\begin{equation}
		f(i/y)\stackrel?=i^ky^kf(yi) \label{eq:needed-s-symmetry}
	\end{equation}
	for any $y>0$. For this, we note that \Cref{lem:computed-completed-l-func} still computes the Mellin transform of $f(yi)-a_0$ for $\op{Re}s>c$, so for any $\sigma>\max\{c,k\}$, Mellin inversion implies
	\[f(iy)-a_0=\frac1{2\pi i}\int_{\sigma-i\infty}^{\sigma+i\infty}\Lambda(s,f)y^{-s}\,ds.\]
	Now, we will be able to produce \eqref{eq:needed-s-symmetry} after moving the contour and applying the functional equation. Moving the contour requires the following result.
	\begin{proposition}[Phragmen--Lindel\"of principle] \label{prop:pl}
		Suppose $f$ is a function holomorphic over $\{s\in\CC:\op{Re}s\in[\sigma_1,\sigma_2],\op{Im}s>c\}$. Further, suppose there is $\alpha>0$ such that $f(\sigma+it)=O\left(e^{t^\alpha}\right)$ for $\sigma\in[\sigma_1,\sigma_2]$. If $f(\sigma+it)=O_\sigma\left(t^M\right)$ for $\sigma\in\{\sigma_1,\sigma_2\}$, then $f(\sigma+it)=O\left(t^M\right)$ for $\sigma\in[\sigma_1,\sigma_2]$.
	\end{proposition}
	\begin{proof}
		Omitted.
	\end{proof}
	We now attempt to move the contour from $\op{Re}s=\sigma$ to $\op{Re}s=k-\sigma$ via \Cref{prop:pl}. Because $\sigma>k$, we see that $L(s,f)$ absolutely converges and is therefore bounded on $\op{Re}s=\sigma$; thus, because $\Gamma(\sigma+it)\to0$ as $t\to\pm\infty$, we see that $\Lambda(\sigma+it,f)y^{-(\sigma+it)}\to0$ as $t\to\pm\infty$. The functional equation for $\Lambda$ implies that $\Lambda(k-(\sigma+it),f)y^{-(k-(\sigma+it))}\to0$ as $t\to\pm\infty$ as well, so \Cref{prop:pl} tells us that $\Lambda(k-s,f)y^{-s}\to0$ as $\op{Im}s\to\pm\infty$ uniformly for $\op{Re}s\in[k-\sigma,\sigma]$. Thus, noting that $\Lambda(s,f)$ has only at worst simple poles at $s=0$ and $s=k$ with known residues, the Residue theorem grants
	\begin{align*}
		\lim_{N\to\infty}\frac1{2\pi i}\left(\int_{\sigma-iN}^{\sigma+iN}\Lambda(s,f)y^{-s}\,ds-\int_{(k-\sigma)-iN}^{(k-\sigma)+iN}\Lambda(s,f)y^{-s}\,ds\right) &= \op{Res}_{s=0}\Lambda(s,f)y^{-s}+\op{Res}_{s=k}\Lambda(s,f)y^{-s} \\
		&= -a_0+(-1)^{k/2}a_0y^{-k}.
	\end{align*}
	Bringing everything together, we use the functional equation to see
	\begin{align*}
		f(iy)-a_0 &= \frac1{2\pi i}\int_{\sigma-i\infty}^{\sigma+i\infty}\Lambda(s,f)y^{-s}\,ds \\
		&= \frac1{2\pi i}\int_{(k-\sigma)-i\infty}^{(k-\sigma)+i\infty}\Lambda(s,f)y^{-s}\,ds-a_0+(-1)^{k/2}a_0y^{-k} \\
		&= \frac{(-1)^{k/2}}{2\pi i}\int_{(k-\sigma)-i\infty}^{(k-\sigma)+i\infty}\Lambda(k-s,f)y^{-s}\,ds-a_0+(-1)^{k/2}a_0y^{-k} \\
		&= \frac{(-1)^{k/2}}{2\pi i}\int_{\sigma-i\infty}^{\sigma+i\infty}\Lambda(s,f)y^{-(k-s)}\,ds-a_0+(-1)^{k/2}a_0y^{-k} \\
		&= (-1)^{k/2}y^{-k}(f(i/y)-a_0)-a_0+(-1)^{k/2}a_0y^{-k}.
	\end{align*}
	Rearranging yields \eqref{eq:needed-s-symmetry}, so we are done.
\end{proof}

% \section{Hecke Operators}

\printbibliography[title={References}]

\end{document}