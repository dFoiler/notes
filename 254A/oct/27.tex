% !TEX root = ../notes.tex














Here we go.

\subsection{Metric Completions}
We recall we had the following theorem.
\begin{theorem}
	Every nontrivial valued ring $(R,|\cdot|)$ can be embedded as a dense subring into of a complete valued ring $(\hat R,|\cdot|^\wedge),$ and the latter is unique up to unique isomorphism over $R.$ If $R$ is a field (archimedean) (non-archimedean), then $\hat R$ is also a field (archimedean) (non-archimedean).
\end{theorem}
\begin{proof}
	Set $R_0:=R^\NN$ the space of $\NN$-indexed sequences of elements of $R.$ Further, let $R_1\subseteq R_0$ be the subset consisting of the Cauchy sequences. We do the Cauchy sequence construction of $\hat R$; we have the following.
	\begin{lemma}
		We have that $R_1$ is a subring of $R_0.$
	\end{lemma}
	\begin{proof}
		We have the following checks.
		\begin{itemize}
			\item We have the identity because $1=(1,1,\ldots)$ is constant and hence Cauchy, so $1\in R_1.$
			\item We see $R_1$ is an additive subgroup by adding/subtracting the two Cauchy sequences termwise.
			\item We have that $R_1$ is closed under multiplication by multiplying the two Cauchy sequences termwise. Namely, if $\{a_k\}_{k\in\NN},\{b_k\}_{k\in\NN}\in R_1,$ then
			\[|a_nb_n-a_mb_m|\le|a_n|\cdot|b_m-b_n|+|b_m|\cdot|a_m-a_n|\]
			by the triangle inequality. The $|a_\bullet|$ and $|b_\bullet|$ are bounded because the sequence is Cauchy, so the above implies our sequence is Cauchy.
			\qedhere
		\end{itemize}
	\end{proof}
	\begin{lemma}
		Fix $\mf q:=\{(a_n)\in R_1:|a_n|\to0\}.$ Then $\mf q$ is a prime $R$-ideal.
	\end{lemma}
	\begin{proof}
		The fact that this is an additive subgroup follows by writing out what we need and then doing 104-type arguments. This is an ideal because $a\in\mf q$ and $b\in R$ will have $ab\in\mf q$ because the sequence $b$ will be bounded.
		
		Lastly, $\mf q$ is prime because $1\notin\mf q$ (because $|1|\to1$), and if $(a_n),(b_n)\notin\mf q,$ then these are Cauchy sequences and so $|a_\bullet|$ and $|b_\bullet|$ will converge in $\RR,$ which must converge to some nonzero value. It follows that $|a_\bullet b_\bullet|$ will also converge to a nonzero value, so $(a_nb_n)\notin\mf q$ as well.
	\end{proof}
	We now set $\hat R:=R_1/\mf q,$ and we see that this is entire by the above; it might feel amazing that this means $R$ is entire as well, but this essentially follows from being valued.

	To be explicit, we note that each $a,b=(a_n)\in R_1$ must have $\lim_{n\to\infty}|a_n|$ convergent and finite, and similar for $b.$ Then if we suppose $a-b\in\mf q,$ then we can see that
	\[\lim_{n\to\infty}|a_n|=\lim_{n\to\infty}|b_n|,\]
	so we may take this limit as our definition of $|\cdot|^\wedge:\hat R\to\RR.$ We can check that this is an absolute value on $\hat R,$ which we will not show explicitly here because it should mostly be a matter of writing out the checks.

	We note that we have the mapping $R\to R_0$ by taking $r\mapsto(r,r,\ldots).$ We can see that this is a ring homomorphism and with image contained in $R_1$ because constant sequences are Cauchy. So we have a map
	\[R\into R_1.\]
	Moreover, we can see that the only way for the absolute value to go to $0$ is for $|r|=0$ which is equivalent to $r=0,$ so the pre-image of $\mf q$ under this embedding is $0.$ So we have an induced injective map
	\[\iota:R\into\hat R.\]
	We also note that $|\iota(r)|^\wedge=|r|,$ so this is indeed a morphism of valued rings. This lets us view $(R,|\cdot|)$ as a valued subring of $\hat R.$

	This embedding is dense somewhat clearly\todo{it is?}, and it is is unique up to unique isomorphism, which we leave as an exercise.\footnote{One way to do this would be universal property for $R\mapsto\hat R.$} Similarly, the last claims about $\hat R$ preserving structure for $R$ we leave as an exercise, though we outline them below.
	\begin{itemize}
		\item If $R$ is a field, then we can take the Cauchy sequence in $\hat R$ termwise inverting.
		\item If $R$ is archimedean, then this is equivalent to the statement that $\{|n|:n\in\NN\}$ is unbounded in $R,$ so this will also be true in $\hat R.$
		\item If $R$ is non-archimedean, then this is equivalent to the statement that $\{|n|:n\in\NN\}$ is bounded in $R,$ so this will also be true in $\hat R.$
		\qedhere
	\end{itemize}
\end{proof}
As an aside, we mention the following categorical result.
\begin{proposition}
	Fix $(R,|\cdot|)$ and $(S,|\cdot|)$ with a morphism $\varphi:R\to S$ between them. Then the following diagram commutes.
	% https://q.uiver.app/?q=WzAsNCxbMCwwLCJSIl0sWzEsMCwiUyJdLFswLDEsIlxcaGF0IFIiXSxbMSwxLCJcXGhhdCBTIl0sWzAsMSwiXFx2YXJwaGkiXSxbMiwzLCJcXGhhdFxcdmFycGhpIl0sWzAsMiwiIiwxLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiaG9vayIsInNpZGUiOiJ0b3AifX19XSxbMSwzLCIiLDEseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6InRvcCJ9fX1dXQ==
	\[\begin{tikzcd}
		R & S \\
		{\hat R} & {\hat S}
		\arrow["\varphi", from=1-1, to=1-2]
		\arrow["\hat\varphi", from=2-1, to=2-2]
		\arrow[hook, from=1-1, to=2-1]
		\arrow[hook, from=1-2, to=2-2]
	\end{tikzcd}\]
	Here, $\hat\varphi$ is induced pointwise.
\end{proposition}
\begin{proof}
	One can show this by hand using our construction of $\hat R$ and $\hat S.$
\end{proof}
Let's now specialize to Dedekind rings.
\begin{proposition}
	Fix $A$ a Dedekind ring with $K$ its fraction field. Fix $\mf p$ a nonzero prime of $A,$ and let $\nu_\mf p:K\to\ZZ\cup\{\infty\}$ be the discrete valuation of $\mf p.$ Further fix $c>1$ and define
	\[|x|_\mf p:=c^{-\nu_\mf p(x)},\]
	where $x\in K.$ If we complete $(A,|\cdot|_\mf p)$ and $(K,|\cdot|_\mf p)$ to $(\hat A,|\cdot|^\wedge_\mf p)$ and $(K,|\cdot|_\mf p^\wedge)$ respectively, then we have the following.
	\begin{enumerate}[label=(\alph*)]
		\item There is a canonical isomorphism
		\[\hat A\cong\limit A/\mf p^\bullet.\]
		\item $\hat A$ is a discrete valuation ring with valuation $-\log_c|\cdot|_\mf p^\wedge$ and fraction field $\hat K.$
	\end{enumerate}
\end{proposition}
\begin{proof}
	We do these one at a time.
	\begin{enumerate}[label=(\alph*)]
		\item Fix $n\in\NN.$ We define $\varphi_n:\hat A\to A/\mf p^n.$ Here, take $\alpha\in\hat A$ represented by the Cauchy sequence $(a_0,a_1,\ldots),$ and we note that the Cauchy condition implies there is $N$ such that $|a_k-a_\ell|\le c^{-n}$ for each $k,\ell\ge N,$ which implies that $a_k-a_\ell\in\mf p^n,$ so
		\[a_k\equiv a_\ell\pmod{\mf p^k}\]
		for each $k,\ell\ge N.$ In particular, $a_k\pmod{\mf p^n}$ has stabilized past $N,$ so we define
		\[\varphi_n(\alpha):=[a_k]_{\mf p^n}.\]
		We note that $\varphi_n$ is well-defined: the exact lifting does not matter because a different Cauchy sequence $(a_0',a_1',\ldots)$ will also eventually stabilize$\pmod{\mf p^n}$ past (say) $N',$ but because the two sequences converge to the same $\alpha,$ we eventually have
		\[|a_k-a_k'|\le c^{-n}\]
		for sufficiently large $k.$ But now $a_k\equiv a_k'\pmod{\mf p^n}$ for sufficiently large $n,$ which is what we wanted.

		We now note that $\varphi_n$ is a ring homomorphism by the ``look at it'' test, and we also see that the following diagram commutes for a similar reason.
		% https://q.uiver.app/?q=WzAsMyxbMSwwLCJcXGhhdCBBIl0sWzAsMiwiQS9cXG1mIHBebiJdLFsyLDIsIkEvXFxtZiBwXntuKzF9Il0sWzIsMSwiIiwwLHsic3R5bGUiOnsiaGVhZCI6eyJuYW1lIjoiZXBpIn19fV0sWzAsMSwiXFx2YXJwaGlfbiIsMl0sWzAsMiwiXFx2YXJwaGlfe24rMX0iXV0=
		\[\begin{tikzcd}
			& {\hat A} \\
			\\
			{A/\mf p^n} && {A/\mf p^{n+1}}
			\arrow[two heads, from=3-3, to=3-1]
			\arrow["{\varphi_n}"', from=1-2, to=3-1]
			\arrow["{\varphi_{n+1}}", from=1-2, to=3-3]
		\end{tikzcd}\]
		It remains to show that $\hat A$ equipped with these morphisms satisfies the universal property. So fix a ring $B$ with maps $\psi_n:B\to A/\mf p^n$ making the following diagram commute.
		% https://q.uiver.app/?q=WzAsNCxbMCwyLCJBL1xcbWYgcF5uIl0sWzIsMiwiQS9cXG1mIHBee24rMX0iXSxbMSwxLCJcXGhhdCBBIl0sWzEsMCwiQiJdLFsxLDAsIiIsMCx7InN0eWxlIjp7ImhlYWQiOnsibmFtZSI6ImVwaSJ9fX1dLFsyLDAsIlxcdmFycGhpX24iXSxbMiwxLCJcXHZhcnBoaV97bisxfSIsMl0sWzMsMCwiXFxwc2lfbiIsMix7ImN1cnZlIjoyfV0sWzMsMSwiXFxwc2lfe24rMX0iLDAseyJjdXJ2ZSI6LTJ9XSxbMywyLCJcXHZhcnBoaSIsMV1d
		\[\begin{tikzcd}
			& B \\
			& {\hat A} \\
			{A/\mf p^n} && {A/\mf p^{n+1}}
			\arrow[two heads, from=3-3, to=3-1]
			\arrow["{\varphi_n}", from=2-2, to=3-1]
			\arrow["{\varphi_{n+1}}"', from=2-2, to=3-3]
			\arrow["{\psi_n}"', curve={height=12pt}, from=1-2, to=3-1]
			\arrow["{\psi_{n+1}}", curve={height=-12pt}, from=1-2, to=3-3]
			\arrow["\varphi"{description}, from=1-2, to=2-2]
		\end{tikzcd}\]
		We need to induce $\varphi$ uniquely. Well, for $b\in B,$ we choose $a_n\in A$ to be any lift for $\psi_n(b)\in A/\mf p^n$ to make some $(a_0,a_1,\ldots)\in A^\NN.$ We can see that this is a Cauchy sequence because
		\[a_{n+1}\equiv a_n\pmod{\mf p^n}\]
		always, so $a_n-a_m\in\mf p^{\min\{n,m\}},$ implying that $n,m\to\infty$ sends the absolute value of the difference to zero. We also note that if chose another lift $(a_0',a_1',\ldots)\in A_0,$ then we would have $a_k-a_k'\in\mf p^k$ for each $k,$ so $|a_k-a_k'|\to0,$ implying that the output of $f_0$ is unique up to coset of $\mf q.$ Thus, we have described a well-defined map
		\[\psi:B\to\hat A.\]
		By construction, we can also check that $\varphi_n(\alpha)=\psi_n(b)$ for each $n,$ which we will not show explicitly here; this also shows that $\psi$ taking $b\mapsto\alpha$ is a ring homomorphism for free, and we will leave the uniqueness of $\psi$ as an exercise. This completes the proof of (a).
		\qedhere
	\end{enumerate}
\end{proof}
We'll get to (b) next class.