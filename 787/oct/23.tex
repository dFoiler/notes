% !TEX root = ../notes.tex

\documentclass[../notes.tex]{subfiles}

\begin{document}

\section{October 23}
Here we go.

\subsection{The Kolyvagin System Property}
The term ``Euler'' arises because these classes bare a relation resembling Euler factors. Let's explain this.
\begin{notation}[transverse subgroup]
	Here is another way to define the transverse subgroup. Not that the extension $K[\ell]$ from $K_\ell$ can be split into unramified part $K_\ell^{\mathrm{ur}}$ and totally ramified part $K_\ell^{\mathrm{ram}}$, so we can choose some totally ramified place $\lambda'$ so that we can split the cohomology
	\[\mathrm H^1(K_\ell;E[p])=\mathrm H^1(K_\ell^{\mathrm{un}}/K_\ell;E[p])\oplus\mathrm H^1(K[\ell]_{\lambda'}/K_\ell;E[p]),\]
	and the latter group is $\mathrm H^1_{\mathrm{tr}}$ by definition.
\end{notation}
% \begin{remark}
% 	By choosing a generator $\sigma_\ell$ of $\op{Gal}(K[\ell]/K)$, one can identify $\mathrm H^1_{\mathrm{tr}}(K_\ell;E[p])$.
% \end{remark}
% Admissibility implies the Galois action of $\op{Gal}(\ov K_\ell/K_\ell)$ acts transitively on $E[p]$, so
% \[\mathrm H^1(K_\ell;E[p])=\op{Hom}_{\mathrm{cts}}(\op{Gal}(\ov K_\ell/K),E[p]),\]
% and the unramified cohomology corresponds to homomorphisms from $\op{Gal}(K_\ell^{\mathrm{ur}}/K_\ell)$. Accordingly, we define the ``transverse'' subgroup $\mathrm H^1_{\mathrm{tr}}$ to mean homomorphisms $\op{Gal}(K[\ell]_\ell/K_\ell)\to E[p]$. On the other hand, class field theory explains that such characters have the same data as a character $K_\ell^\times\to E[p]$, which can in turn by decomposed (non-canonically!) into a character of $\ell^\ZZ$ and a character of $\OO_{K_\ell}^\times$. Characters on $\ell^\ZZ$ are unramified while characters on $\OO_{K_\ell}^\times$ are unramified, and they correspond to characters on
% \[\op{Gal}(K[\ell]_\ell/K_\ell)\cong\FF_{\ell^2}^\times/\FF_\ell^\times,\]
% which explains where the ``transverse'' notion comes from.
\begin{theorem} \label{thm:kolyvagin-system-prop}
	Define the polynomial $H_\ell(T)\coloneqq T^2-a_\ell T+\ell$ to be the Euler factor at $\ell$. Then there is a $\varphi_\ell\coloneqq-\frac1p\cdot\mathrm{Frob}_\ell\cdot H_\ell(\mathrm{Frob}_\ell)$ which induces an isomorphism
	\[\varphi_\ell\colon\mathrm H^1_{\mathrm{ur}}(K_\ell;E[p])\to\mathrm H^1_{\mathrm{tr}}(K_\ell;E[p])\]
	satisfying the following conditions.
	\begin{listalph}
		\item We have $\op{loc}_vc(n)\in\mc L_{E,v}$ for all $v\nmid n$.
		\item For $\ell\mid n$, we have $\op{loc}_\ell c(n)=\varphi_\ell(\op{loc}_\ell c(n/\ell))$.
	\end{listalph}
\end{theorem}
% \begin{remark}
% 	In the last equality in (b), we see that $\varphi_\ell$ is sending $\mathrm H^1_{\mathrm{ur}}$ to $\mathrm H^1_{\mathrm{tr}}$.
% \end{remark}
% \begin{remark}
% 	Note that $c(n)$ depends on a ``choice'' of uniformizer $\ell$ because we used it in the definition of the derivative. Similarly, $\varphi_\ell$ depended on the choice of uniformizer.
% \end{remark}
We describe now describe an isomorphism $\mathrm H^1_{\mathrm{ur}}(K_\ell;E[p])\to\mathrm H^1_{\mathrm{tr}}(K_\ell;E[p])$. Well, note that we have a composite
\[E(\FF_{\ell^2})\onto\frac{E(\FF_{\ell^2})}{pE(\FF_{\ell^2})}=\frac{E(K_\ell)}{pE(K_\ell)}\cong\mathrm H^1_{\mathrm{ur}}(K_\ell;E[p]),\]
so it will be more or less enough to exhibit a map $E(\FF_{\ell^2})\to E(\FF_{\ell^2})$. For example, we could try the element $(\ell+1)-a_\ell\mathrm{Frob}_\ell$, but of course this vanishes by the Cayley--Hamilton theorem and the fact that $\mathrm{Frob}_\ell^2$ acts by the identity. So instead we choose the element
\[\varphi_\ell\coloneqq\mathrm{Frob}_\ell\cdot\frac{(\ell+1)-a_\ell\mathrm{Frob}_\ell}p,\]
which we now see will land $E(\FF_{\ell^2})[p]$. (The Frobenius here is some extra twist which will help us later.) This mapping is an isomorphism to $E(\FF_{\ell^2})[p]$ because the admissibility of $\ell$ implies that both $E(\FF_\ell)[p^\infty]$ and $E(\FF_{\ell^2})^-[p^\infty]$ are isomorphic to $\ZZ_p/(\ell+1-a_\ell)\ZZ_p$. This latter group is then identified with $\mathrm H^1_{\mathrm{tr}}(K_\ell;E[p])$ because the Galois group $\op{Gal}(K[\ell]_{\lambda'}/K_\ell)$ is cyclic, so we can use the cohomology of cyclic groups.

We are now ready to prove \Cref{thm:kolyvagin-system-prop}.
\begin{proof}[Proof of \Cref{thm:kolyvagin-system-prop}]
	Let's start by showing that $c(n)$ is in the local condition at $v$ for all $v\nmid n$. We will give two arguments.
	\begin{itemize}
		\item We work with large primes $p$. By the Kummer exact sequence
		\[0\to E(K)/pE(K)\to\mathrm H^1(K;E[p])\to\mathrm H^1(K;E)[p]\to0,\]
		it is enough to show that $c(n)$ vanishes in $\mathrm H^1(K;E)[p]$. Now, let $\mc E$ be a N\'eron model of $E$ over $\OO_v$, and it turns out that $E(K_v^{\mathrm{ur}})^\circ\subseteq E(K_v^{\mathrm{ur}})$ is a finite-index subgroup (which is equality when $E$ has good reduction), and it fits in a short exact sequence
		\[0\to E(K_v^{\mathrm{ur}})^\circ\to E(K_v^{\mathrm{ur}})\to\pi_0(\mc E_{\ov\FF_v})\to0.\]
		Now, we claim that $\mathrm H^1(K_v^{\mathrm{ur}}/K_v,E(K_v^{\mathrm{ur}})^\circ)=0$. Let's explain how to conclude, so there is an embedding $\mathrm H^1(K_v^{\mathrm{ur}}/K_v;A)\into\mathrm H^1(\FF_v;\pi_0)$, where $\pi_0$ is the (finite) component group. Thus, for large primes $p$, we see that $\mathrm H^1(K_v^{\mathrm{ur}}/K_v;E)[p]=0$ already!

		It remains to explain why $\mathrm H^1(K_v^{\mathrm{ur}}/K_v,E(K_v^{\mathrm{ur}})^\circ)=0$. In other words, we need to show that every torsor $T$ of $E(K_v^{\mathrm{ur}})$ is trivial. By Hensel's lemma, it is enough to check for a point on $T$ over finite fields, but $\mathrm H^1(\FF_v;G)=0$ already for any smooth connected group scheme $G$.

		\item We work with general $p$. Up to adding torsion, it turns out that $y_n$ is in $E(K[n])^\circ$. Roughly speaking, this is true because $\infty$ and $x_n$ reduce to the same component of $X_0(N)_{\FF_v}$. Thus, $c(n)$ lands in $\mathrm H^1(K_v^{\mathrm{ur}}/K_v;E^\circ)$, which we mentioned above will vanish.
	\end{itemize}
	Next, we show that $c(n)$ lives in $\mathrm H^1_{\mathrm{tr}}(K_\ell;E[p])$ for each $\ell\mid n$. In other words, we need to show that $c(n)$ is inflated from $\mathrm H^1_{\mathrm{tr}}(K[\ell]_{\lambda'}/K_\ell;E[p])$. We will do this by giving an explicit description of the cocycle $c(n)$. For a given point $x\in E$, we let $x/p$ denote some point over the algebraic closure for which $p\cdot(x/p)=x$. We claim that $c(n)$ can be represented by the cocycle
	\[\sigma\mapsto(\sigma-1)\frac{\mc P_n}p-\frac{(\sigma-1)\mc P_n}p.\]
	Observe that $(\sigma-1)(\mc P_n/p)$ is only defined up to some $p$-torsion, but this only adjusts the total by a $1$-coboundary; similarly, $((\sigma-1)\mc P_n)/p$ turns out to be uniquely determined as an element in $E(K[n])$ because $E(K[n])$ has no $p$-torsion of $E$. One can check that this is actually a $1$-cocycle (landing in $E[p]$!), and when restricted to $K[n]$, it turns out to be $\delta_{\mc P_n}$ becomes the second term vanishes. Having the correct restriction to $K[n]$ is enough to characterize $c(n)$, so we have proven the claim.

	We can now calculate with this cocycle to show that $\op{loc}_vc(n)\in\mathrm H^1_{\mathrm{tr}}(K_\ell;E[p])$. By Inflation--restriction, it is enough to check that the restriction of $\op{loc}_vc(n)$ vanishes when restricted to $K[\ell]_{\lambda'}$. We will show that each of the individual terms in the expansion of $c(n)$ above vanishes.
	\begin{itemize}
		\item The term $(\sigma_\ell-1)\cdot(\mc P_n/p)$ vanishes with no work.
		\item To check that the term $(\sigma-1)\mc P_n/p$ vanishes, we should show that $\mc P_n\in pE(K[\ell]_{\lambda'})$. Well, reduction shows $E(K_\lambda)/pE(K_\lambda)$ is isomorphic to $E(\FF_{\ell^2})/pE(\FF_{\ell^2})$ because $E(K_\lambda)$ is a pro-$\ell$ group, so it remains to check that $\mc P_{n/\ell}$ lands in $pE(\FF_{\ell^2})$, but this holds because $\mc P_{n/\ell}$ is in the image of the derivative operator $\mc D_\ell$, and the derivative operator has $\sigma_\ell$ acting by identity$\pmod{\lambda}$.
	\end{itemize}
	It remains to show (ii). We will work in the case where $n=\ell$ for psychological reasons. We compute each side separately, moving around the following diagram.
	% https://q.uiver.app/#q=WzAsNixbMCwwLCJcXG1hdGhybSBIXjFfe1xcbWF0aHJte3VyfX0oS19cXGVsbDtFW3BdKSJdLFsxLDAsIlxcbWF0aHJtIEheMV97XFxtYXRocm17dHJ9fShLX1xcZWxsO0VbcF0pIl0sWzEsMSwiRVtwXShLX1xcZWxsKSJdLFswLDEsIkUoS19cXGVsbCkvcEUoS19cXGVsbCkiXSxbMCwyLCJFKFxcRkZfe1xcZWxsXjJ9KS9wRShcXEZGX3tcXGVsbF4yfSkiXSxbMSwyLCJFW3BdKFxcRkZfe1xcZWxsXjJ9KSJdLFs0LDUsIlxcZnJhYzFwXFxvcHtGcm9ifV9cXGVsbCBIX1xcZWxsKFxcbWF0aHJte0Zyb2J9X3ApIl0sWzMsNF0sWzIsNV0sWzMsMiwiIiwyLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn19fV0sWzMsMCwiXFxkZWx0YSJdLFsxLDIsIlxcc2lnbWFfXFxlbGwiXSxbMCwxLCJcXHZhcnBoaV9cXGVsbCIsMCx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dXQ==&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}[cramped]
		{\mathrm H^1_{\mathrm{ur}}(K_\ell;E[p])} & {\mathrm H^1_{\mathrm{tr}}(K_\ell;E[p])} \\
		{E(K_\ell)/pE(K_\ell)} & {E[p](K_\ell)} \\
		{E(\FF_{\ell^2})/pE(\FF_{\ell^2})} & {E[p](\FF_{\ell^2})}
		\arrow["{\varphi_\ell}", dashed, from=1-1, to=1-2]
		\arrow["{\sigma_\ell}", from=1-2, to=2-2]
		\arrow["\delta", from=2-1, to=1-1]
		\arrow[dashed, from=2-1, to=2-2]
		\arrow[from=2-1, to=3-1]
		\arrow[from=2-2, to=3-2]
		\arrow["{\frac1p\op{Frob}_\ell H_\ell(\mathrm{Frob}_p)}", from=3-1, to=3-2]
	\end{tikzcd}\]
	Here, recall that $\mathrm H^1_{\mathrm{tr}}(K_\ell;E[p])$, which is the inflation from $\mathrm H^1(K[\ell]_\lambda/K_\ell;E[p])$ is identified with $E[p](K_\ell)$ by evaluating cocycles at $\sigma_\ell$. As such, we calculate
	\[c(\ell)(\sigma_\ell)=(\sigma_\ell-1)\cdot\frac{\mc P_\ell}p-\frac{(\sigma_\ell-1)\mc P_\ell}p.\]
	It turns out that the left term vanishes$\pmod\ell$ because $\sigma_\ell$ doesn't do anything (note that we already know that $\mc P_\ell/p$ already lives in $E(\FF_{\ell^2})$). The right term is
	\[-\frac{(\ell+1)y_\ell-a_\ell y_1}p.\]
	Thus, by using \Cref{prop:euler-system-prop}, we are left with
	\[-\frac{(\ell+1)\mathrm{Frob}(y_1)-a_\ell(y_1)}p\pmod\ell\]
	living in $E[p](\FF_{\ell^2})$. We now see that this gives rise to $c(1)$.
	% Well, when $v\mid\ell$, we want to show that the restriction to $K[\ell]_{\lambda'}$ is trivial (because the transverse subgroup is the inflation from $K[\ell]$), so we need to check that the cocycle vanishes on $\sigma_\ell$: the term $(\sigma_\ell-1)\cdot(\mc P_n/p)$ vanishes, and $((\sigma_\ell-1)\mc P_\ell)/p$ is $(\ell+1)\mathrm{Frob}_\ell y_1-a_\ell y_1$, which can also be seen to vanish.
\end{proof}
\begin{remark}
	In fact, $\mathrm H^1(K_v^{\mathrm{ur}}/K_v,G(K_v^{\mathrm{ur}}))=0$ for any smooth connected group scheme $G$. As such, we see that large primes $p$ imply $\mathrm H^1(K_v^{\mathrm{ur}}/K_v;A)[p]=0$ for all $v$.
\end{remark}

\end{document}