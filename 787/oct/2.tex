% !TEX root = ../notes.tex

\documentclass[../notes.tex]{subfiles}

\begin{document}

\section{October 2}
There is no class next Tuesday. We began class by proving \Cref{prop:selmer-as-markov}; I have moved the proof there.

\subsection{Twisting for Selmer Rank}
As usual, fix some elliptic curve $E$ which is the projective closure $y^2=(x-a_1)(x-a_2)(x-a_3)$. For any local condition $\mc L\subseteq\mathrm H^1(\AA_K;E[2])$, we may form a Selmer group $\op{Sel}_{\mc L}(E[2])$, which may or may not actually come globally from an elliptic curve.

We now note there is a distinguished element among the Lagrangian subspaces of $\mathrm H^1(\AA_K;E[2])$, given by the unramified cohomology.
\begin{definition}[transverse]
	A Lagrangian subspace $\mc L_v\subseteq\mathrm H^1(K_v;E[2])$ is \textit{transverse} if and only if
	\[\mc L_v\cap\mathrm H^1(K_v;E[2])=0.\]
\end{definition}
Following our calculation from the congruent number elliptic curves, we see that the image of $E[2](K_v)\to\mathrm H^1(K_v;E[2])$ is spanned by
\[\{(a_3-a_1,a_3-a_2,(a_3-a_1)(a_3-a_2)),(a_2-a_1,(a_2-a_1)(a_2-a_3),a_2-a_3)\}.\]
On the other hand, if we twist this by some uniformizer $\varpi_v$ of $K_v$, then the image of $E^{\varpi_v}[2]\to\mathrm H^1(K_v;E[2])$ is spanned by
\[\{(\varpi_v(a_3-a_1),\varpi_v(a_3-a_2),(a_3-a_1)(a_3-a_2)),(\varpi_v(a_2-a_1),(a_2-a_1)(a_2-a_3),\varpi_v(a_2-a_3))\}.\]
For example, if $v(a_i-a_j)=0$, we can immediately see that these vectors are nonzero and linearly independent, so we already have a Lagrangian subspace!
\begin{notation}
	We let $\mc L_{\varpi_v}$ denote the above Lagrangian subspace.
\end{notation}
We are thus able to complete our descent via some property akin to a ``Markov chain.''
\begin{theorem} \label{prop:selmer-as-markov}
	Fix some Lagrangian local condition $\mc L\subseteq\mathrm H^1(\AA_K;E[2])$. Suppose we are given $v_0$ for which $\mc L_{v_0}=\mathrm H^1_{\mathrm{ur}}(K_{v_0};E[2])$, so we set
	\[\mc L'\coloneqq\prod_{v\ne v_0}\mc L_v\cdot\mc L_{\varpi_{v_0}}.\]
	Then set $r\coloneqq\dim_{\FF_2}\op{Sel}_{\mc L}(E[2])$ and $r'\coloneqq\dim_{\FF_2}\op{Sel}_{\mc L'}(E[2])$. Then $r\equiv r'\pmod2$, and
	\[r'-r=\begin{cases}
		-2 & \text{if }\op{loc}_{v_0}(\op{Sel}_{\mc L}(E[2]))=\mc L_{v_0}, \\
		+2 & \text{if }\op{loc}_{v_0}(\op{Sel}_{\mc L'}(E[2]))=\mc L'_{v_0}, \\
		+0 & \text{otherwise}.
	\end{cases}\]
\end{theorem}
\begin{remark}
	One input here is the following piece of linear algebra: given an even-dimensional quad\-ratic space $V$, then there are two families of Lagrangian subspaces $\mc F_1$ and $\mc F_2$, and two Lagrangians $\mc L$ and $\mc L'$ are in the same family if and only if $\codim(\mc L\cap\mc L',\mc L)$ is even-dimensional.
\end{remark}
\begin{example}
	The subspace $\op{loc}_{v_0}(\op{Sel}_{\mc L^{v_0}}(E[2]))$ is $2$-dimensional by a global duality result, and in fact this space can be seen to be isotropic because they vanish outside a given place because the global inner product is the sum of local inner products.
\end{example}
% \begin{remark}
% 	Set $\mc M$ to be $\mc L^{v_0}$ to be the relaxed local condition. Then the parity $r\equiv r'\pmod2$ boils down to calculating
% 	\[\dim\mc M\cap\mathrm H^1_{\mathrm{ur}}-\dim\mc M\cap\mc L_{\varpi_{v_0}},\]
% 	which is even because $\mathrm H^1_{\mathrm{ur}}\cap\mc L_{\varpi_{v_0}}=0$.
% \end{remark}
\begin{remark}
	The condition $\op{loc}_{v_0}(\op{Sel}_{\mc L'}(E[2]))=\mc L'_{v_0}$ implies that $\op{loc}_{v_0}(\op{Sel}_{\mc L})=0$ because our subspaces are transverse.
\end{remark}
\begin{proof}
	Write $\op{Sel}_{\mc L}(E[2])=\mc L\cap G$, where $G\coloneqq\mathrm H^1(K;E[2])$ and the intersection takes place in $\mathrm H^1(\AA_K;E[2])$. One now has a pullback square
	% https://q.uiver.app/#q=WzAsNCxbMCwwLCJcXG9we1NlbH1fe1xcbWMgTFxcY2FwXFxtYyBMJ30oRVsyXSkiXSxbMSwwLCJcXG9we1NlbH1fe1xcbWMgTH0oRVsyXSkiXSxbMCwxLCJcXG9we1NlbH1fe1xcbWMgTCd9KEVbMl0pIl0sWzEsMSwiXFxvcHtTZWx9X3tcXG1jIEwrXFxtYyBMJ30oRVsyXSkiXSxbMCwyXSxbMiwzXSxbMCwxXSxbMSwzXSxbMCwzLCIiLDEseyJzdHlsZSI6eyJuYW1lIjoiY29ybmVyIn19XV0=&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}[cramped]
		{\op{Sel}_{\mc L\cap\mc L'}(E[2])} & {\op{Sel}_{\mc L}(E[2])} \\
		{\op{Sel}_{\mc L'}(E[2])} & {\op{Sel}_{\mc L+\mc L'}(E[2])}
		\arrow[from=1-1, to=1-2]
		\arrow[from=1-1, to=2-1]
		\arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-1, to=2-2]
		\arrow[from=1-2, to=2-2]
		\arrow[from=2-1, to=2-2]
	\end{tikzcd}\]
	because the top-left is the intersection. Upon taking $\op{loc}_{v_0}$, we let the bottom-right image be $\mc M$, and we receive a pullback diagram
	% https://q.uiver.app/#q=WzAsNCxbMCwwLCJcXG1jIE0iXSxbMSwwLCJcXG1jIE1cXGNhcFxcbWMgTF97dl8wfSJdLFsxLDEsIlxcbWMgTSJdLFswLDEsIlxcbWMgTVxcY2FwXFxtYyBMX3t2XzB9JyJdLFswLDNdLFszLDJdLFswLDFdLFsxLDJdLFswLDIsIiIsMSx7InN0eWxlIjp7Im5hbWUiOiJjb3JuZXIifX1dXQ==&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}[cramped]
		{0} & {\mc M\cap\mc L_{v_0}} \\
		{\mc M\cap\mc L_{v_0}'} & {\mc M}
		\arrow[from=1-1, to=1-2]
		\arrow[from=1-1, to=2-1]
		\arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-1, to=2-2]
		\arrow[from=1-2, to=2-2]
		\arrow[from=2-1, to=2-2]
	\end{tikzcd}\]
	again because we are just taking intersections. Here, $\mc M\subseteq\mathrm H^1(K_{v_0};E[2])$ is just some Lagrangian subspace. Because $\mc M\cap\mc L_{v_0}$ and $\mc M\cap\mc L_{v_0}'$ are disjoint subspaces of a $2$-dimensional space, we conclude that the difference in ranks is in $\{-2,+0,+2\}$.%, and one can track through everything to prove \Cref{thm:selmer-as-markov}.
\end{proof}

\subsection{The Proof in a Special Case}
We will prove our main theorem in a special case.
\begin{theorem}
	Fix an elliptic curve $E$ with $E[2](K)=(\ZZ/2\ZZ)^2$. Suppose that $\op{Sel}_2(E/K)$ is six-dimen\-sional with basis $\{c_1,\ldots,c_6\}$. Further, suppose that $K$ admits six real archimedean places $\{\tau_1,\ldots,\tau_6\}$ with some prescribed local behavior. %satisfying the following: with $c_i=(\alpha_i,\beta_i,\gamma_i)$
	Then we can find $t$ for which
	\[\op{rank}\op{Sel}_2(E^t/K)=0\qquad\text{and}\qquad\op{rank}E^{-t}(K)>0.\]
\end{theorem}
One can make some local twists described by \Cref{prop:selmer-as-markov} to achieve this situation. Roughly speaking, we are hoping to twist in the end by some
\[t=\prod_{i=1}^3(a_id-c)\cdot d.\]
Let $q_i=a_id-c$ for $i\in\{1,2,3\}$ and $q_d=4\coloneqq d$. We would like for all of these factors to be prime (which we will achieve with additive combinatorics), and we would like some control over how these things are adjusted by \Cref{prop:selmer-as-markov}. In order to get some local control later, we fix some large set $T$ of places (including archimedean places, bad places, $2$, and $3$, and maybe more), and we choose a large $N$ to be supported on these places and with large enough power (e.g., the class number will be good enough for our purposes).

Let's explain the additive combinatorics which will let us assume that the factors in $t$ are prime. We are going to state a Green--Tao
\begin{definition}[admissible]
	Fix a number field $K$. A \textit{linear form} is a map $\varphi\colon\OO_K^m\to\OO_K$ of the form $\varphi_i(x)=a\cdot x+b$ where $a\in\OO_K^{m}$ and $b\in\OO_K$. We will then define the \textit{homogeneous part} $\varphi^\circ$ as $\varphi^\circ(x)\coloneqq a\cdot x$.
\end{definition}
\begin{definition}[admissible]
	Fix a number field $K$. A collection $\{\varphi_i\}_{i=1}^n$ of linear forms is \textit{admissible} at a finite place $v$ if and only if
	\[\prod_{i=1}^n\varphi_i(x)\not\equiv0\pmod{\varpi_v}\]
	admits a solution $x$.
\end{definition}
\begin{example}
	The triple $\{y,x+y,x+2y\}$ is not admissible at $2$ because the sum is even.
\end{example}
\begin{definition}[local density]
	Fix a number field $K$ and choose linear forms $\{\varphi_i\}_{i=1}^n$. For a finite place $v$, we define the \textit{local density} as
	\[\beta_v\coloneqq\frac{\#\left\{x\in\FF_v^m:\prod_i\varphi_i(x)\not\equiv0\pmod{\varpi_v}\right\}}{\#\FF_v^m}.\]
	% For an archimedean place $v$, we define the \textit{local density} at a convex domain $\Omega\subseteq(K\otimes\RR)^m$ as\todo{}
	% \[\op{vol}\{\]
\end{definition}
\begin{definition}[von Mangoldt]
	Fix a number field $K$. Then we define the \textit{von Mangoldt function} $\Lambda_K$ as
	\[\Lambda_K(x)\coloneqq\begin{cases}
		\log\op N\mf p & \text{if }(x)=\mf p^i\text{ for a prime ideal }\mf p, \\
		0 & \text{otherwise}.
	\end{cases}\]
\end{definition}
\begin{theorem}[Kai]
	Fix a number field $K$ and some $d$-dimensional linear forms $\{\varphi_i\}_{i=1}^n$ for which the homogeneous parts $\varphi_i^\circ$ are pairwise linearly independent. Further, choose a convex set $\Omega$ with volume growing as
	\[\op{vol}\left(\Omega\cap[-N,N]^d\right)=cN^d+o\left(N^d\right)\]
	for some fixed $c>0$. Then
	\[\sum_{x\in\Omega\cap[-N,N]^d\cap\ZZ^d}\prod_i\Lambda_K(\varphi_i(x))=\frac{cN^d}{\op{Res}_{s=1}\zeta_K(s)^n}\prod_p\beta_p+o\left(N^d\right).\]
\end{theorem}
For our application, we take
\[\varphi_i(x,y)=N^2x+a_iN^2\cdot N^2Hy+1\]
for $i\in\{1,2,3\}$ and further define $\varphi_4(x,y)=N^2y+1$. This is admissible at every nonarchimedean place, and one can check a volume result at the archimedean places to prescribe some $\Omega$.

We are now able to prove our result. Simply define $\mc L_i$ inductively by $\mc L_0$ to be the local condition of $E$, and we define $\mc L_i$ for $i>0$ to be the modification of $\mc L_{i-1}$ by $q_i$. We can use \Cref{prop:selmer-as-markov} to control the rank of the Selmer groups (using the unnamed local conditions on the $\tau_\bullet$s via Hilbert reciprocity), and we conclude by choosing $t$ generically.

\end{document}