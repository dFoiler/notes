% !TEX root = ../notes.tex

\documentclass[../notes.tex]{subfiles}

\begin{document}

\section{September 23}

Today we place some finiteness conditions on morphisms.
% V 8.1--8.3
% 8.3 has definitions

\subsection{Quasicompact and Quasiseparated}
For today, we will denote a morphism of schemes $\pi\colon X\to Y$.
\begin{definition}[Quasicompact]
	A scheme morphism $\pi\colon X\to Y$ is \textit{quasicompact} if and only if all affine open subschemes $U\subseteq Y$ make $\pi^{-1}(U)\subseteq X$ a quasicompact topological space.
\end{definition}
\begin{example}
	Fix a morphism $\pi\colon X\to Y$, where $X$ is a Noetherian scheme and hence a Noetherian space. Then $\pi$ is quasicompact because any (affine) open subset $U\subseteq Y$ makes $\pi^{-1}U\subseteq X$ an open and hence quasicompact set, where we are using \autoref{lem:opensarecompact}.
\end{example}
\begin{example}
	Any closed embedding $\pi\colon X\to Y$ is quasicompact. Indeed, given an affine open subset $U\subseteq Y$, we note that $\pi^{-1}(U)$ is homeomorphic through $\pi$ to $\pi(X)\cap U$. However, $U$ is quasicompact (it's affine), so the closed subset $\pi(X)\cap U$ is a closed subset in a quasicompact space and therefore quasicompact.
\end{example}
To define quasiseparated, we will need to have the adjective on topological spaces.
\begin{definition}[Quasiseperated]
	A topological space $X$ is \textit{quasiseparated} if and only if the intersection of two quasicompact open subsets is still quasicompact.
\end{definition}
\begin{example}
	Any Noetherian space is quasiseparated because any open subset is quasicompact by \autoref{lem:opensarecompact}.
\end{example}
And here is our definition.
\begin{defi}[Quasiseparated]
	A scheme morphism $\pi\colon X\to Y$ is \textit{quasiseparated} if and only if all affine open subschemes $U\subseteq Y$ makes $\pi^{-1}(U)$ a quasiseparated topological space.
\end{defi}
\begin{remark}
	Equivalently, $\pi\colon X\to Y$ is quasiseparated if and only if given any affine open subset $U\subseteq Y$ and more affine open subsets $V_1,V_2\subseteq\pi^{-1}(U)$, we can give $V_1\cap V_2$ a finite affine open cover.
	\begin{itemize}
		\item If $\pi$ is quasiseparated, then $\pi^{-1}(U)$ is quasiseparated, so $V_1\cap V_2$ is quasicompact and thus has a finite affine open cover (from any affine open cover).
		\item If $\pi$ satisfies the condition, suppose we have quasicompact subsets $V_1,V_2\subseteq\pi^{-1}(U)$. Then we can give $V_1$ and $V_2$ finite affine open covers $\mc V_1$ and $\mc V_2$, and we see
		\[V_1\cap V_2=\Bigg(\bigcup_{W_1\in\mc V_1}W_1\Bigg)\cap\Bigg(\bigcup_{W_2\in\mc V_2}W_2\Bigg)=\bigcup_{W_1\in\mc V_1,W_2\in\mc V_2}(W_1\cap W_2),\]
		where $W_1\cap W_2$ is quasicompact and thus has a finite affine open cover. Synthesizing our finite cover by finite affine open covers, we see that we in total have given $V_1\cap V_2$ a finite affine open cover.
	\end{itemize}
\end{remark}
It turns out that a scheme $(X,\OO_X)$ is quasicompact/quasiseparated if and only if its morphism $(X,\OO_X)\to(\Spec\ZZ,\OO_{\Spec\ZZ})$ is quasicompact/quasiseparated; we will show this later.
\begin{remark}
	A scheme being quasiseparated is a very reasonable smallness condition, weaker than being locally Noetherian. We will later define what it means for a morphism/scheme to be ``separated,'' which will be stronger than this and approximately mean Hausdorff.
\end{remark}

\subsection{Quasicompactness is Reasonable}
Here are some equivalent definitions for being quasicompact.
\begin{lemma} \label{lem:non-affine-qc}
	A morphism $\pi\colon X\to Y$ is quasicompact if and only if every quasicompact subset $U\subseteq Y$ has $\pi^{-1}U$ also quasicompact.
\end{lemma}
\begin{proof}
	If the conclusion is true, then $\pi$ is certainly quasicompact because affine open subsets are necessarily quasicompact.

	On the other hand, suppose $\pi$ is quasicompact, and pick up a quasicompact subset $U\subseteq Y$. Now, $U$ as an open subscheme can be given an affine open cover $\mc V$, but because $U$ is quasicompact, we may assume that $\mc V$ is finite. But then
	\[\pi^{-1}(U)=\bigcup_{V\in\mc V}\pi^{-1}(V)\]
	is the finite union of quasicompact sets, where the $\pi^{-1}(V)$ is quasicompact because the $V$ are affine. Thus, $\pi^{-1}(U)$ is quasicompact.
\end{proof}
\begin{lemma} \label{lem:mainqclemma}
	Fix a morphism $\pi\colon X\to Y$ of schemes. Then $\pi$ is quasicompact if and only if there is an affine open cover $\mc U$ of $Y$ such that each $\pi^{-1}(U)$ is quasicompact for each $U\in\mc U$.
\end{lemma}
\begin{proof}
	In one direction, if $\pi$ is quasicompact, then any affine open cover $\mc U$ has each $U\in\mc U$ affine, so we see $\pi^{-1}(U)\subseteq X$ is quasicompact by hypothesis on $\pi$.

	The other direction is harder. Fix an affine open cover $\{U_\alpha\}_{\alpha\in\lambda}$ of $Y$ with $\varphi_\alpha\colon\Spec A_\alpha\cong U_\alpha$, and we are given that $\pi^{-1}(U_\alpha)$ is quasicompact for each $\alpha$. Now, for any quasicompact open subset $U\subseteq Y$, we need to show that $\pi^{-1}(U)$ is quasicompact.

	Well, using the distinguished base of each $U_\alpha\cong\Spec A_\alpha$, we can write
	\[U\cap U_\alpha=\bigcup_{\beta\in\lambda_\alpha}\varphi(D(f_{\alpha,\beta}))\]
	for some elements $\alpha,\beta\in\lambda$ (\autoref{rem:distinguishedbase}). It follows that
	\[U=\bigcup_{\alpha\in\lambda}(U\cap U_\alpha)=\bigcup_{\alpha\in\lambda}\bigcup_{\beta\in\lambda_\alpha}\varphi(D(f_{\alpha,\beta})).\]
	This provides an open cover of $U$, so the quasicompactness of $U$ forces us to have a finite subcover; let $\lambda'$ denote the finite set of $(\alpha,\beta)$ such that $\varphi(D(f_{\alpha,\beta}))$ cover $U$.

	It follows that
	\[\pi^{-1}(U)=\bigcup_{(\alpha,\beta)\in\lambda'}\pi^{-1}(\varphi(D(f_{\alpha,\beta}))).\]
	However, each $\varphi(D(f_{\alpha,\beta}))$ is affine, so their preimages under $\pi$ are quasicompact, so $\pi^{-1}(U)$ is the finite union of quasicompact sets and hence quasicompact. This finishes.
\end{proof}
So here are some quick results.
\begin{cor} \label{cor:qc-from-qc-morphisms}
	Fix a morphism $\pi\colon X\to Y$ of schemes. If $Y$ is affine, then $\pi$ is quasicompact if and only if $X$ is quasicompact.
\end{cor}
\begin{proof}
	We apply \autoref{lem:mainqclemma}. If $\pi$ is quasicompact, then the affine open subset $Y\subseteq Y$ must have $X=\pi^{-1}Y$ quasicompact by definition. Conversely, if $X$ is quasicompact, then we use the affine open cover $\{Y\}$ on $Y$ to note that $\pi$ is quasicompact because $\pi^{-1}(Y)=X$ is, by \autoref{lem:mainqclemma}.
\end{proof}
\begin{example}
	We see from \autoref{cor:qc-from-qc-morphisms} that a scheme $X$ is quasicompact if and only if its unique morphism $X\to\Spec\ZZ$ is quasicompact. (Recall this morphism is unique by \autoref{cor:spec-z-final}.)
\end{example}
The above results are important enough that we will want to give it a name.
\begin{definition}[Affine-local on the target]
	Let $P$ be a class of morphisms. We say that $P$ is \textit{affine-local on the target} if and only if a morphism $\pi\colon X\to Y$ is in $P$ if and only if there is an affine open cover $\{Y_\alpha\}_{\alpha\in\lambda}$ such that all the restricted maps $\pi|_{\pi^{-1}Y_\alpha}\colon\pi^{-1}Y_\alpha\to Y_\alpha$ are also in $P$.
\end{definition}
\begin{example}
	Quasicompact morphisms are affine-local on the target, from \autoref{lem:mainqclemma}. Certainly if $\pi$ is quasicompact, then for any affine open subset $U\subseteq Y$, we see $\pi^{-1}U$ is quasicompact, so the restriction $\pi|_{\pi^{-1}U}\colon\pi^{-1}U\to U$ is quasicompact by \autoref{cor:qc-from-qc-morphisms}. Conversely, if all the restrictions to $\pi|_{\pi^{-1}Y_\alpha}$ are quasicompact, then because $Y_\alpha\subseteq Y$ is quasicompact, $\pi^{-1}(Y_\alpha)$ is quasicompact for each $\alpha$, so $\pi$ is quasicompact by \autoref{lem:mainqclemma}.
\end{example}
\begin{remark} \label{rem:qc-local-target}
	In fact, quasicompact morphisms are ``local on the target.'' Namely, suppose $\pi\colon X\to Y$ is a morphism such that $Y$ has an open cover $\mc U$ with $\pi|_{\pi^{-1}U}\colon\pi^{-1}U\to U$ quasicompact for each $U\in\mc U$. Giving each $U\in\mc U$ an affine open cover (legal because these are open subschemes of $Y$), we get a huge open cover $\mc V$ of $Y$ such that each $V\in\mc V$ has some $U\in\mc U$ with $\pi^{-1}V$ is quasicompact because the morphism $\pi|_{\pi^{-1}U}\colon\pi^{-1}U\to U$ is quasicompact. This finishes by \autoref{lem:mainqclemma}.
\end{remark}
Here are a few niceness checks.
\begin{corollary} \label{cor:qc-is-comp-preserve}
	Fix quasicompact scheme morphisms $\varphi\colon X\to Y$ and $\psi\colon Y\to Z$. Then $\psi\circ\varphi$ is quasicompact.
\end{corollary}
\begin{proof}
	We use \autoref{lem:non-affine-qc}. Pick up any quasicompact subset $W\subseteq Z$. Then $\psi^{-1}(W)\subseteq Y$ is quasicompact by \autoref{lem:non-affine-qc}, so $(\psi\circ\varphi)^{-1}(W)=\varphi^{-1}(\psi^{-1}(W))$ is quasicompact again by \autoref{lem:non-affine-qc}.
\end{proof}
Once more, it will be useful to have language to describe the above.
\begin{definition}[Preserved by composition]
	Let $P$ be a class of morphisms. We say that $P$ is \textit{preserved by composition} if and only if, for any pair of morphisms $\varphi\colon X\to Y$ and $\psi\colon Y\to Z$ in $P$, we have $\psi\circ\varphi$ also in $P$.
\end{definition}
\begin{example}
	By \autoref{cor:qc-is-comp-preserve}, quasicompact morphisms are preserved by composition.
\end{example}
\begin{corollary}
	Suppose we have a pullback square
	% https://q.uiver.app/?q=WzAsNCxbMCwwLCJYXFx0aW1lc19ZWSciXSxbMSwwLCJZJyJdLFswLDEsIlgiXSxbMSwxLCJZIl0sWzIsMywiXFxwaSJdLFswLDEsIlxccGknIl0sWzAsMl0sWzEsM11d&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}
		{X\times_YY'} & {Y'} \\
		X & Y
		\arrow["\pi", from=2-1, to=2-2]
		\arrow["{\pi'}", from=1-1, to=1-2]
		\arrow[from=1-1, to=2-1]
		\arrow[from=1-2, to=2-2]
	\end{tikzcd}\]
	of schemes. If $\pi$ is quasicompact, then $\pi'$ is quasicompact.
\end{corollary}
\begin{proof}
	Reduce to the affine case.
\end{proof}
% \begin{corollary}
% 	A morphism being quasicompact is affine local on the target: given an affine open cover $\mc U$ of $Y$, the restrictions $\pi|_{\pi^{-1}U}$ for $U\in\mc U$ are all quasicompact if and only if $\pi$ is quasicompact.
% \end{corollary}
% \begin{proof}
% 	Apply \autoref{lem:mainqclemma}.
% \end{proof}
\begin{remark}
	Being preserved under composition and base-change shows that the product of two quasicompact morphisms is quasicompact. Namely, $\varphi\colon X\to Y$ and $\varphi'\colon X'\to Y'$ makes us build the product morphism $\varphi\times\varphi'\colon X\times_{\Spec\ZZ}X'\to Y\times_{\Spec\ZZ}Y'$ by applying base-change twice.
\end{remark}
Here are some examples of our morphisms.
\begin{example}
	Closed embeddings are always quasicompact.
\end{example}
\begin{nex}
	An open embedding need not be quasicompact. For example, an affine scheme can have open subschemes which are not quasicompact.
\end{nex}

\subsection{Quasiseparated Speedrun}
We begin with the same central lemma from being quasicompact.
\begin{lemma} \label{lem:mainqslemma}
	Fix a morphism $(\pi,\pi^\sharp)\colon(X,\OO_X)\to(Y,\OO_Y)$ of schemes.
	\begin{listalph}
		\item $\pi$ is quasiseparated.
		\item All quasicompact open subsets $U\subseteq Y$ have $\pi^{-1}(U)\subseteq X$ quasiseparated.
		\item There is an affine open cover $\mc U$ of $Y$ such that each $\pi^{-1}(U)$ is quasiseparated for each $U\in\mc U$.
	\end{listalph}
\end{lemma}
\begin{proof}
	Similar to \autoref{lem:mainqclemma}.
\end{proof}
However, there is a more important test to be quasiseparated.
\begin{lemma} \label{lem:qs-by-diag}
	Fix a morphism $(\pi,\pi^\sharp)\colon(X,\OO_X)\to(Y,\OO_Y)$ of schemes. Then $(\pi,\pi^\sharp)$ is quasiseparated if and only if the diagonal map $\Delta\colon X\to X\times_YX$ (induced by using $\id_X\colon X\to X$) is quasicompact.
\end{lemma}
\begin{proof}
	To show $\Delta$ is quasicompact, one can just reduce to an affine open cover.
	
	In the other direction, suppose that the diagonal map $\Delta$ is quasicompact, and we show that $\pi$ is quasiseparated. Well, fix some affine open subset $U\subseteq Y$ with affine open subsets $V_1,V_2\subseteq\pi^{-1}(U)$, and we want to show that $V_1\cap V_2$ is quasicompact. For this, we draw the diagram
	% https://q.uiver.app/?q=WzAsNCxbMCwwLCJWXzFcXHRpbWVzX1hWXzIiXSxbMSwwLCJWXzFcXHRpbWVzX1lWXzIiXSxbMSwxLCJYXFx0aW1lc19ZWCJdLFswLDEsIlgiXSxbMywyXSxbMSwyXSxbMCwxXSxbMCwzXV0=&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}
		{V_1\times_XV_2} & {V_1\times_YV_2} \\
		X & {X\times_YX}
		\arrow[from=2-1, to=2-2]
		\arrow[from=1-2, to=2-2]
		\arrow[from=1-1, to=1-2]
		\arrow[from=1-1, to=2-1]
	\end{tikzcd}\]
	which commutes purely formally by properties of the fiber product. Notably, $V_1,V_2\subseteq\pi^{-1}(U)$ promises that $V_1\times_YV_2=V_1\times_UV_2$. However, the main point is that $V_1\cap V_2=V_1\times_XV_2$ and $\pi^{-1}(V_1\times_UV_2)=V_1\cap V_2$ again. Thus, we note that $V_1\times_YV_2$ being quasicompact tells us that $V_1\cap V_2$ is quasicompact by taking the pre-image using the compactness of $\Delta$.
\end{proof}
\begin{remark}
	Being quasiseparated is preserved under composition, base change and is affine local on the target. Indeed, this can be reduced to statements about quasicompactness by \autoref{lem:qs-by-diag}.
\end{remark}
\begin{remark}
	If the codomain of a scheme morphism is locally Noetherian, then the morphism is quasiseparated.
\end{remark}

\subsection{Affine Morphisms}
Here is our definition.
\begin{definition}[Affine]
	A scheme morphism $\pi\colon X\to Y$ if and only if every affine open subset $U\subseteq Y$ has $\pi^{-1}(U)$ affine.
\end{definition}
\begin{example}
	Let $\varphi\colon\Spec B\to\Spec A$ be a morphism of affine schemes; we show $\varphi$ is affine. Well, for any affine open subscheme $\Spec A'\cong U\subseteq\Spec A$, \autoref{lem:open-fp} tells us that
	% https://q.uiver.app/?q=WzAsNCxbMSwxLCJcXFNwZWMgQSJdLFsxLDAsIlxcU3BlYyBCIl0sWzAsMSwiVSJdLFswLDAsIlxcdmFycGhpXnstMX0oVSkiXSxbMSwwLCJcXHZhcnBoaSJdLFsyLDAsIiIsMix7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoidG9wIn19fV0sWzMsMSwiIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiaG9vayIsInNpZGUiOiJ0b3AifX19XSxbMywyLCJcXHZhcnBoaXxfe1xcdmFycGhpXnstMX0oVSl9Il1d&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}
		{\varphi^{-1}(U)} & {\Spec B} \\
		U & {\Spec A}
		\arrow["\varphi", from=1-2, to=2-2]
		\arrow[hook, from=2-1, to=2-2]
		\arrow[hook, from=1-1, to=1-2]
		\arrow["{\varphi|_{\varphi^{-1}(U)}}", from=1-1, to=2-1]
	\end{tikzcd}\]
	is a pullback square, so $\varphi^{-1}(U)\cong\Spec B\times_{\Spec A}U\cong\Spec B\times_{\Spec A}\Spec A'$, which is just $\Spec B\otimes_AA'$ by \autoref{lem:affine-fp}. In particular, $\varphi^{-1}(U)$ is affine.
\end{example}
Here are the usual sanity checks.
\begin{lemma}
	Affine morphisms are preserved by composition.
\end{lemma}
\begin{proof}
	Let $\varphi\colon X\to Y$ and $\psi\colon Y\to Z$ be affine morphisms, and we want to show $\psi\circ\varphi$ is affine. Well, if $W\subseteq Z$ is an affine open subset, then $\psi^{-1}W\subseteq Y$ is affine, so $(\psi\circ\varphi)^{-1}(W)=\varphi^{-1}\psi^{-1}W\subseteq X$ is also affine. This finishes.
\end{proof}
\begin{remark}
	We can easily see that being affine implies being quasicompact and quasiseparated.
\end{remark}
If we want the analogue of \autoref{lem:mainqclemma} for affine morphisms, we must do some extra work.
\begin{lemma}
	A morphism $\pi\colon X\to Y$ is affine if and only if we can provide $Y$ with an affine open cover $\mc U$ such that $\pi^{-1}(U)$ is affine for each $U\in\mc U$.
\end{lemma}
\begin{proof}
	To begin, note that a morphism $\pi\colon\Spec B\to\Spec A$ of affine schemes will pull back distinguished open sets to distinguished open sets.

	Now, call our affine open cover $\{U_\alpha\}_{\alpha\in\lambda}$ of $Y$ satisfying the conclusion. Then for some affine open subset $U=\Spec A$ of $X$, we can intersect $U$ with each $U_\alpha$ to give an affine open cover of $U$ by various distinguished open subsets. Then the pre-image of each of these under $\pi$ is affine by our previous remark, and we can glue these affine schemes to another affine scheme by Exercise~2.17(b) in \cite{hartshorne}, which was on the homework. Notably, the fact we have an affine open cover is what tells us that the chosen elements from our distinguished open subsets will generate the unit ideal of $A$.
\end{proof}
\begin{remark}
	As usual, affine morphisms are preserved by composition, base-change, and it is local on the target.
\end{remark}
Next time we move on to talk about finite morphisms, integral morphisms, and morphisms of finite type.

\end{document}