% !TEX root = ../notes.tex

\documentclass[../notes.tex]{subfiles}

\begin{document}

\section{September 7}
Today we define schemes.

\subsection{Locally Ringed Spaces}
Schemes will be a special kind of locally ringed space, so we take a moment to define these.
\begin{definition}[Locally ringed space]
	A \textit{locally ringed space} is an ordered pair $(X,\OO_X)$ of a topological space $X$ and sheaf of rings $\mc O_X$ such that all stalks are local rings.
\end{definition}
\begin{example}
	Affine schemes are locally ringed spaces by \autoref{lem:affinestalk}.
\end{example}
\begin{example}
	Fix a locally ringed space $(X,\OO_X)$. For any open subset $U\subseteq X$, we see that $(U,\OO_X|_U)$ is a locally ringed space as well. Namely, $\OO_X|_U$ is certainly a sheaf of rings on $U$, and by \autoref{lem:invimagestalk} tells us that any $x\in U$ makes
	\[(\OO_X|_U)_x=\OO_{X,x}\]
	a local ring, so all stalks are indeed local rings.
\end{example}
Having been introduced to a new algebraic object, one should ask how to define a morphism. This is somewhat subtle. We begin by just giving the definition.
\begin{definition}[Morphism of locally ringed spaces] \label{def:ringspacemorphism}
	Given locally ringed spaces $(X,\mc O_X)$ and $(Y,\mc O_Y)$ locally ringed spaces, a \textit{morphism} is a pair $(\varphi,\varphi^\sharp)$ of a continuous map $\varphi\colon X\to Y$ and a sheaf morphism $\varphi^\sharp\colon\OO_Y\to f_*\OO_X$. Further, we require that, at each $x\in X$, the induced map
	\[\arraycolsep=1.4pt\begin{array}{cccccc}
		\OO_{Y,\varphi(x)} &\stackrel{\varphi^\sharp_{\varphi(x)}}\to& (\varphi_*\OO_X)_{\varphi(x)} &\to& \OO_{X,x} \\
		{[(V,s)]} &\mapsto& \left[(V,\varphi^\sharp_V(s))\right] &\mapsto& \varphi^\sharp_V(s)|_x
	\end{array}\]
	is a morphism of local rings; i.e., the image of $\mf m_{Y,\varphi(x)}$ is contained in $\mf m_{X,x}$, or equivalently the pre-image of $\mf m_{X,x}$ is $\mf m_{Y,\varphi(x)}$.
\end{definition}
\begin{example} \label{ex:open-embed-morphism}
	Given an open subset $U\subseteq X$, the embedding $\iota\colon U\to X$ combined with the sheaf map $\iota^\sharp\colon\OO_X\to\iota_*(\OO_X|_U)$ by $\iota^\sharp(s)\coloneqq s|_{U\cap V}$ assembles into a morphism of locally ringed spaces $(\iota,\iota^\sharp)$.
	\begin{itemize}
		\item To see that $\iota^\sharp$ is a sheaf morphism, we see that any open $V'\subseteq V\subseteq X$ and $s\in\OO_X(V)$ has $\iota^\sharp_V(s)|_{V'}=s|_{U\cap V}|_{U\cap V'}=s|_{U\cap V'}=s|_{V'}|_{U\cap V'}=\iota^\sharp_{V'}(s|_{V'})$.
		\item To see that we have a morphism of locally ringed spaces, we fix $p\in U$ and compute that
		\[\arraycolsep=1.4pt\begin{array}{cccccc}
			\OO_{X,p} &\stackrel{\iota^\sharp_{p}}\to& (\iota_*\OO_X)_{p} &\to& \OO_{X,p} \\
			{[(V,s)]} &\mapsto& \left[(V,\iota^\sharp_V(s))\right] &\mapsto& [V\cap U,s|_{U\cap V}]
		\end{array}\]
		which we can check directly is a map of local rings: if $[(V,s)]=0$, then there is some open neighborhood $V'$ containing $p$ where $s$ vanishes; but then $[V\cap U,s|_{U\cap V}]$ will also vanish upon restricting to $V'\cap U$.
	\end{itemize}
\end{example}
Notably, the last map $(f_*\OO_X)_{f(x)}\to\OO_{X,x}$ above is the canonical map of \autoref{lem:directimagestalk}.
\begin{remark}
	Using the inverse image sheaf instead of the direct image sheaf, we can use \autoref{prop:invdiradjunction} to think about $f^\sharp$ as
	\[f^\flat\colon f^{-1}\mc O_Y\to\mc O_X.\]
	One might want to do this because the stalks of $f^{-1}\mc O_Y$ are nicely behaved by \autoref{lem:invimagestalk}.
\end{remark}
We take a moment to provide two ways to motivate \autoref{def:ringspacemorphism}.
\begin{enumerate}
	\item On the algebraic side, it will turn out that this definition makes the only morphisms of affine schemes (which are locally ringed spaces) come from ring homomorphisms, so we can ``check'' that this definition is the correct one.

	To help see why \autoref{def:ringspacemorphism} looks the way that it does a ring homomorphism $f\colon A\to B$ gives rise to a continuous map $\varphi\colon\Spec B\to\Spec A$, but the function data still goes to $A\to B$. This explains why $\varphi^\sharp$ should go $\OO_Y\to\varphi_*\OO_X$.

	Lastly, we can view the local ring condition as checking that we cohere with the ``local'' part of a locally ringed space.

	\item On the geometric side, we should imagine that a morphism of locally ringed spaces is like a map $\varphi\colon X\to Y$ of manifolds, where $\OO_X$ and $\OO_Y$ are the sheaf of holomorphic functions on each. Then the sheaf morphism
	\[\OO_Y\to\varphi_*\OO_X\]
	is saying that a holomorphic function $f\colon V\to\CC$ (for some open $V\subseteq Y$) should pull back through $\varphi$ to a differential function
	\begin{equation}
		\varphi^{-1}(V)\stackrel\varphi\to V\stackrel f\to\CC \label{eq:pullbackholofuncs}
	\end{equation}
	which is simply true. Importantly, there isn't really a way to take a holomorphic function $X\to\CC$ and ``push it'' through $\varphi$ to a holomorphic function $Y\to\CC$.

	Lastly, the local ring condition is saying that a germ $f\in\OO_{Y,\varphi(x)}$ will vanish at $\varphi(x)$ will pull back via \autoref{eq:pullbackholofuncs} to a germ in $\OO_{X,x}$ which vanishes at $x$. Again, this is simply true.
\end{enumerate}
Here are some quick checks on locally ringed spaces.
\begin{lemma}
	All locally ringed spaces equipped with the defined morphisms makes a category.
\end{lemma}
\begin{proof}
	Here is the extra data we need to define.
	\begin{itemize}
		\item Identity: given a locally ringed space $(X,\OO_X)$, we define $\id_{(X,\OO_X)}$ as given by the continuous map ${\id_X}\colon X\to X$ and sheaf morphism ${\id_{\OO_X}}\colon\OO_X\to\OO_X$. (Notably, ${(\id_X)_*\OO_X}$ is the same as $\OO_X$ by \autoref{lem:directimagefunctor}.) Checking stalks, we see that any $x\in X$ has
		\[\arraycolsep=1.4pt\begin{array}{ccccc}
			\OO_{X,x} &\stackrel{\id_{\OO_X,x}}\to& ((\id_{\OO_X})_*\OO_X)_x &\to& \OO_{X,x} \\
			{[(U,s)]} &\mapsto& [(U,s)] &\mapsto& [(U,s)] 
		\end{array}\]
		is the identity and hence a map of local rings.
		\item Composition: given two morphisms $(\varphi,\varphi^\sharp)\colon(X,\OO_X)\to(Y,\OO_Y)$ and $(\psi,\psi^\sharp)\colon(Y,\OO_Y)\to(Z,\OO_Z)$, we define the composition as having the continuous map $\psi\circ\varphi\colon X\to Y$ and sheaf morphism
		\[\OO_Z\stackrel{\psi^\sharp}\to\psi_*\OO_Y\stackrel{\psi_*\varphi^\sharp}\to\psi_*\varphi_*\OO_X.\]
		Notably, $\psi_*\varphi_*\OO_X=(\psi\circ\varphi)_*\OO_X$ by \autoref{rem:directimagefunctor}, so at least all of our data look correct.

		Checking stalks, fix $x\in X$ and $[(U,s)]\in\mf m_{Z,\psi(\varphi(z))}$. Because $(\varphi,\varphi^\sharp)$ and $(\psi,\psi^\sharp)$ are morphisms of locally ringed spaces, we see that $[(\psi^{-1}U,\psi^\sharp_Uz)]\in\mf m_{Y,\varphi(z)}$, so
		\[\left[((\psi\circ\varphi)^{-1}U,(\psi_*\varphi^\sharp\circ\psi^\sharp)_Us)\right]=\left[(\varphi^{-1}\psi^{-1}U,\varphi^\sharp_{\psi^{-1}U}\psi^\sharp_Us)\right]\in\mf m_{X,x},\]
		which finishes the check.
	\end{itemize}
	We have the following coherence checks.
	\begin{itemize}
		\item Identity: given a morphism $(\varphi,\varphi^\sharp)\colon(X,\OO_X)\to(Y,\OO_Y)$, we compute
		\[(\varphi,\varphi^\sharp)\circ\id_{(X,\OO_X)}=\left(\varphi\circ{\id_X},\varphi_*{\id_{\OO_X}}\circ\varphi^\sharp\right)=\left(\varphi\circ{\id_X},{\id_{\varphi_*\OO_X}}\circ\varphi^\sharp\right)=(\varphi,\varphi^\sharp),\]
		and
		\[{\id_{Y,\OO_Y}}\circ(\varphi,\varphi^\sharp)=\left({\id_Y}\circ\varphi,({\id_Y})_*\varphi^\sharp\circ{\id_{\OO_Y}}\right)=\left({\id_Y}\circ\varphi,\varphi^\sharp\circ{\id_{\OO_Y}}\right)=(\varphi,\varphi^\sharp).\]
		\item Associativity: given morphisms $(\alpha,\alpha^\sharp)\colon(A,\OO_A)\to(B,\OO_B)$ and $(\beta,\beta^\sharp)\colon(B,\OO_B)\to(C,\OO_C)$ and $(\gamma,\gamma^\sharp)\colon(C,\OO_C)\to(D,\OO_D)$, we compute
		\begin{align*}
			(\gamma,\gamma^\sharp)\circ\big((\beta,\beta^\sharp)\circ(\alpha,\alpha^\sharp)\big) &= (\gamma,\gamma^\sharp)\circ(\beta\circ\alpha,\beta_*\alpha^\sharp\circ\beta^\sharp) \\
			&= (\gamma\circ\beta\circ\alpha,\gamma_*\beta_*\alpha^\sharp\circ\gamma_*\beta^\sharp\circ\gamma^\sharp) \\
			&= (\gamma\circ\beta,\gamma_*\beta^\sharp\circ\gamma^\sharp)\circ(\alpha,\alpha^\sharp) \\
			&= \big((\gamma,\gamma^\sharp)\circ(\beta,\beta^\sharp)\big)\circ(\alpha,\alpha^\sharp),
		\end{align*}
		finishing.
		\qedhere
	\end{itemize}
\end{proof}
Thus, an isomorphism of locally ringed spaces is, of course, an isomorphism in the category. This carries a lot of data, so it will be helpful to have a shorter version of the data to carry around.
\begin{lemma} \label{lem:betterlocaliso}
	A morphism of ringed spaces $(\varphi,\varphi^\sharp)\colon(X,\OO_X)\to(Y,\OO_Y)$ is an isomorphism if and only if $\varphi$ is a homeomorphism and $\varphi^\sharp$ is an isomorphism of sheaves.
\end{lemma}
\begin{proof}
	Note that $(\varphi,\varphi^\sharp)$ is a morphism of locally ringed spaces already because any $x\in X$ has
	\[\OO_{Y,\varphi(x)}\stackrel{\varphi^\sharp_{\varphi(x)}}\to(\varphi_*\OO_{X})_{\varphi(x)}\to\OO_{X,x}\]
	is a string of isomorphisms: the former is an isomorphism because $\varphi^\sharp$ is, and the last is an isomorphism by \autoref{rem:naturalmapisiso}. Thus, this is a map of local rings for free.

	We now construct the inverse for $(\varphi,\varphi^\sharp)$. Let $\psi\colon Y\to X$ be the inverse continuous map for $\varphi$. Also, for each $V\subseteq\OO_Y$, define the morphism $\psi^\sharp_V\colon\OO_Y(V)\to\psi_*\OO_X(V)$ as the inverse of the morphism
	\[\varphi^\sharp_{\varphi(V)}\colon\OO_X(\varphi(V))\to\varphi_*\OO_Y(\varphi(V))\]
	which makes sense because $\psi^{-1}(V)=\varphi(V)$ and $\varphi^{-1}(\varphi(V))=V$. To check that $\psi^\sharp$ assembles into a sheaf morphism, we note that open subsets $V'\subseteq V\subseteq Y$ make the left diagram below
	% https://q.uiver.app/?q=WzAsOCxbMCwwLCJcXE9PX1koVikiXSxbMSwwLCJcXHBzaV8qXFxPT19YKFYpIl0sWzAsMSwiXFxPT19ZKFYnKSJdLFsxLDEsIlxccHNpXypcXE9PX1goVicpIl0sWzMsMCwiXFx2YXJwaGlfKlxcT09fWShcXHZhcnBoaShWKSkiXSxbNCwwLCJcXE9PX1goXFx2YXJwaGkoVikpIl0sWzMsMSwiXFx2YXJwaGlfKlxcT09fWShcXHZhcnBoaShWJykpIl0sWzQsMSwiXFxPT19YKFxcdmFycGhpKFYnKSkiXSxbMCwxLCJcXHBzaV5cXHNoYXJwX1YiXSxbMiwzLCJcXHBzaV5cXHNoYXJwX3tWJ30iXSxbMCwyLCJcXG9we3Jlc31fe1YsVid9IiwyXSxbMSwzLCJcXG9we3Jlc31fe1YsVid9Il0sWzUsNCwiXFx2YXJwaGleXFxzaGFycF97XFx2YXJwaGkoVil9IiwyXSxbNyw2LCJcXHZhcnBoaV5cXHNoYXJwX3tcXHZhcnBoaShWJyl9IiwyXSxbNCw2LCJcXG9we3Jlc31fe1xcdmFycGhpKFYpLFxcdmFycGhpKFYnKX0iLDJdLFs1LDcsIlxcb3B7cmVzfV97XFx2YXJwaGkoViksXFx2YXJwaGkoVicpfSJdXQ==&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}
		{\OO_Y(V)} & {\psi_*\OO_X(V)} && {\varphi_*\OO_Y(\varphi(V))} & {\OO_X(\varphi(V))} \\
		{\OO_Y(V')} & {\psi_*\OO_X(V')} && {\varphi_*\OO_Y(\varphi(V'))} & {\OO_X(\varphi(V'))}
		\arrow["{\psi^\sharp_V}", from=1-1, to=1-2]
		\arrow["{\psi^\sharp_{V'}}", from=2-1, to=2-2]
		\arrow["{\op{res}_{V,V'}}"', from=1-1, to=2-1]
		\arrow["{\op{res}_{V,V'}}", from=1-2, to=2-2]
		\arrow["{\varphi^\sharp_{\varphi(V)}}"', from=1-5, to=1-4]
		\arrow["{\varphi^\sharp_{\varphi(V')}}"', from=2-5, to=2-4]
		\arrow["{\op{res}_{\varphi(V),\varphi(V')}}"', from=1-4, to=2-4]
		\arrow["{\op{res}_{\varphi(V),\varphi(V')}}", from=1-5, to=2-5]
	\end{tikzcd}\]
	commute because it is the same as the one on the right. Additionally, we can quickly check that we have a morphism of locally ringed spaces; by \autoref{rem:naturalmapisiso}, we are actually given that any $x\in X$ has
	\[\OO_{Y,\varphi(x)}\to(\varphi_*\OO_X)_{\varphi(x)}\simeq\OO_{X,x}\]
	is a map of local rings. Inverting this map, we see that any $y\in Y$ has
	\[\OO_{X,\psi(y)}\to(\psi_*\OO_Y)_{\psi(y)}\simeq\OO_{Y,y}\]
	is also a map of local rings.

	It remains to see that $(\psi,\psi^\sharp)$ is actually the inverse of $(\varphi,\varphi^\sharp)$. On one side, we see that
	\[(\varphi,\varphi^\sharp)\circ(\psi,\psi^\sharp)=(\varphi\circ\psi,\varphi_*\psi^\sharp\circ\varphi^\sharp).\]
	Now, $\varphi\circ\psi=\id_Y$ by definition of $\psi$, and for any $U\subseteq X$, we note $\psi^\sharp_{\varphi^{-1}(U)}=(\varphi^\sharp_U)^{-1}$ by definition of $\psi^\sharp$. So the above is indeed $\id_{(Y,\OO_Y)}$. The other side inverse check is entirely symmetric.
\end{proof}
For schemes, we will be very interested in special (open) subsets of the underlying topological space. The following lemma will be of use.
\begin{lemma} \label{lem:restrictmorphism}
	Fix a morphism $(\varphi,\varphi^\sharp)\colon(X,\OO_X)\to(Y,\OO_Y)$ of locally ringed spaces. Then, for any open subset $U\subseteq Y$, $\varphi$ will restrict to a morphism of locally ringed spaces
	\[(\varphi,\varphi^\sharp)|_U\colon\left(\varphi^{-1}(U),\OO_X|_{\varphi^{-1}U}\right)\to(U,\OO_Y|_U).\]
	In particular, if $(\varphi,\varphi^\sharp)$ is an isomorphism, then $(\varphi,\varphi^\sharp)|_U$ is an isomorphism.
\end{lemma}
\begin{proof}
	We will define $(\varphi,\varphi^\sharp)_U$ by hand. We set $\psi\colon\varphi^{-1}(U)\to U$ to just be $\varphi|_{\varphi^{-1}(U)}$, which is continuous by restriction. Additionally, for any open subset $V\subseteq U$, we define
	\[\psi^\sharp_V\colon\underbrace{\OO_Y|_U(V)}_{\OO_Y(V)}\to\underbrace{\psi_*(\OO_X|_{\varphi^{-1}U})(V)}_{\OO_X(\psi^{-1}(V))}\]
	as just $\varphi^\sharp_V$, which makes sense because $\OO_X(\psi^{-1}(V))=\OO_X(\varphi^{-1}(V))=\varphi_*\OO_X(V)$. To see that $\psi^\sharp$ assembles into a morphism of sheaves, we see that any $V'\subseteq V\subseteq U$ makes the left diagram of
	% https://q.uiver.app/?q=WzAsOCxbMCwwLCJcXE9PX1l8X1UoVikiXSxbMSwwLCJcXHBzaV8qKFxcT09fWHxfe1xcdmFycGhpXnstMX1VfSkoVikiXSxbMCwxLCJcXE9PX1l8X1UoVicpIl0sWzEsMSwiXFxwc2lfKihcXE9PX1h8X3tcXHZhcnBoaV57LTF9VX0pKFYpIl0sWzMsMCwiXFxPT19ZKFYpIl0sWzMsMSwiXFxPT19ZKFYnKSJdLFs0LDAsIlxcdmFycGhpXypcXE9PX1goVikiXSxbNCwxLCJcXHZhcnBoaV8qXFxPT19YKFYnKSJdLFswLDIsIlxcb3B7cmVzfV97VixWJ30iLDJdLFsxLDMsIlxcb3B7cmVzfV97VixWJ30iXSxbMCwxLCJcXHBzaV5cXHNoYXJwX1YiXSxbMiwzLCJcXHBzaV5cXHNoYXJwX3tWJ30iXSxbNCw2LCJcXHZhcnBoaV5cXHNoYXJwX1YiXSxbNSw3LCJcXHZhcnBoaV5cXHNoYXJwX3tWJ30iXSxbNCw1LCJcXG9we3Jlc31fe1YsVid9IiwyXSxbNiw3LCJcXG9we3Jlc31fe1YsVid9Il1d&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}
		{\OO_Y|_U(V)} & {\psi_*(\OO_X|_{\varphi^{-1}U})(V)} && {\OO_Y(V)} & {\varphi_*\OO_X(V)} \\
		{\OO_Y|_U(V')} & {\psi_*(\OO_X|_{\varphi^{-1}U})(V)} && {\OO_Y(V')} & {\varphi_*\OO_X(V')}
		\arrow["{\op{res}_{V,V'}}"', from=1-1, to=2-1]
		\arrow["{\op{res}_{V,V'}}", from=1-2, to=2-2]
		\arrow["{\psi^\sharp_V}", from=1-1, to=1-2]
		\arrow["{\psi^\sharp_{V'}}", from=2-1, to=2-2]
		\arrow["{\varphi^\sharp_V}", from=1-4, to=1-5]
		\arrow["{\varphi^\sharp_{V'}}", from=2-4, to=2-5]
		\arrow["{\op{res}_{V,V'}}"', from=1-4, to=2-4]
		\arrow["{\op{res}_{V,V'}}", from=1-5, to=2-5]
	\end{tikzcd}\]
	commutes because it is the same as the right diagram. Continuing, $(\psi,\psi^\sharp)$ is a morphism of locally ringed spaces because any $x\in\varphi^{-1}(U)$ makes the diagram
	% https://q.uiver.app/?q=WzAsMTAsWzAsMCwiKFxcT09fWXxfVSlfe1xccHNpKHgpfSJdLFswLDEsIlxcT09fe1ksXFx2YXJwaGkoeCl9Il0sWzEsMCwiXFxsZWZ0KFxccHNpXyooXFxPT19YfF97XFx2YXJwaGleey0xfShVKX0pXFxyaWdodClfe1xccHNpKHgpfSJdLFsyLDAsIihcXE9PX1h8X3tcXHZhcnBoaV57LTF9KFUpfSlfeCJdLFsyLDEsIlxcT09fe1gseH0iXSxbMSwxLCIoXFx2YXJwaGlfKlxcT09fWClfe1xcdmFycGhpKHgpfSJdLFszLDAsIlsoVixzKV0iXSxbNCwwLCJcXHBzaV5cXHNoYXJwX1Yocyl8X3giXSxbMywxLCJbKFYscyldIl0sWzQsMSwiXFx2YXJwaGleXFxzaGFycF9WKHMpfF94Il0sWzAsMV0sWzAsMiwiXFxwc2leXFxzaGFycF97XFxwc2koeCl9Il0sWzEsNSwiXFx2YXJwaGleXFxzaGFycF97XFx2YXJwaGkoeCl9Il0sWzIsM10sWzUsNF0sWzMsNF0sWzYsOCwiIiwxLHsibGV2ZWwiOjIsInN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbNyw5LCIiLDEseyJsZXZlbCI6Miwic3R5bGUiOnsiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFs2LDcsIiIsMSx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XSxbOCw5LCIiLDEseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtYXBzIHRvIn19fV1d&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}
		{(\OO_Y|_U)_{\psi(x)}} & {\left(\psi_*(\OO_X|_{\varphi^{-1}(U)})\right)_{\psi(x)}} & {(\OO_X|_{\varphi^{-1}(U)})_x} & {[(V,s)]} & {\psi^\sharp_V(s)|_x} \\
		{\OO_{Y,\varphi(x)}} & {(\varphi_*\OO_X)_{\varphi(x)}} & {\OO_{X,x}} & {[(V,s)]} & {\varphi^\sharp_V(s)|_x}
		\arrow[from=1-1, to=2-1]
		\arrow["{\psi^\sharp_{\psi(x)}}", from=1-1, to=1-2]
		\arrow["{\varphi^\sharp_{\varphi(x)}}", from=2-1, to=2-2]
		\arrow[from=1-2, to=1-3]
		\arrow[from=2-2, to=2-3]
		\arrow[from=1-3, to=2-3]
		\arrow[Rightarrow, no head, from=1-4, to=2-4]
		\arrow[Rightarrow, no head, from=1-5, to=2-5]
		\arrow[maps to, from=1-4, to=1-5]
		\arrow[maps to, from=2-4, to=2-5]
	\end{tikzcd}\]
	commute, where the vertical morphisms are the isomorphisms of \autoref{lem:invimagestalk}. In particular, the top composite is a map of local rings because the bottom one is.

	It remains to show that $(\varphi,\varphi^\sharp)$ being an isomorphism forces $(\psi,\psi^\sharp)$ is an isomorphism. Well, to see that $\psi\colon\varphi^{-1}(U)\to U$ is a homeomorphism, note that $\psi$ is an injective, continuous, open map as inherited from $\varphi$, and $\psi$ is surjective onto $U$ by construction. Additionally, $\psi^\sharp$ is an isomorphism because its components morphisms come from $\varphi^\sharp$, which are all isomorphisms. Thus, we are done by \autoref{lem:betterlocaliso}.
\end{proof}
\begin{remark} \label{rem:open-embed-commutes}
	We can see that the diagram
	% https://q.uiver.app/?q=WzAsNCxbMCwwLCIoXFx2YXJwaGleey0xfVUsXFxPT19YfF97XFx2YXJwaGleey0xfVV9KSJdLFsxLDAsIihYLFxcT09fWCkiXSxbMSwxLCIoWSxcXE9PX1kpIl0sWzAsMSwiKFUsXFxPT19ZfF9VKSJdLFsxLDIsIihcXHZhcnBoaSxcXHZhcnBoaV5cXHNoYXJwKSJdLFswLDMsIihcXHZhcnBoaSxcXHZhcnBoaV5cXHNoYXJwKXxfVSIsMl0sWzAsMSwiKFxcaW90YSxcXGlvdGFeXFxzaGFycCkiLDAseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6InRvcCJ9fX1dLFszLDIsIihcXGptYXRoLFxcam1hdGheXFxzaGFycCkiLDAseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6InRvcCJ9fX1dXQ==&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}
		{(\varphi^{-1}U,\OO_X|_{\varphi^{-1}U})} & {(X,\OO_X)} \\
		{(U,\OO_Y|_U)} & {(Y,\OO_Y)}
		\arrow["{(\varphi,\varphi^\sharp)}", from=1-2, to=2-2]
		\arrow["{(\varphi,\varphi^\sharp)|_U}"', from=1-1, to=2-1]
		\arrow["{(\iota,\iota^\sharp)}", hook, from=1-1, to=1-2]
		\arrow["{(\jmath,\jmath^\sharp)}", hook, from=2-1, to=2-2]
	\end{tikzcd}\]
	commutes, where the horizontal embeddings are from \autoref{ex:open-embed-morphism}. On topological spaces, this is clear because the left map is just the restriction of $\varphi$ to $\varphi^{-1}U$. On sheaves, pick up some open $V\subseteq Y$, and we see that the following diagram commutes.
	% https://q.uiver.app/?q=WzAsOCxbMCwwLCJcXE9PX1koVikiXSxbMSwwLCJcXHZhcnBoaV8qXFxPT19YKFYpIl0sWzAsMSwiXFxqbWF0aF8qKFxcT09fWXxfVSkiXSxbMSwxLCJcXHZhcnBoaV8qXFxpb3RhXyooXFxPT19YfF97XFx2YXJwaGleey0xfVV9KSJdLFsyLDAsInMiXSxbMywwLCJcXHZhcnBoaV5cXHNoYXJwX1YocykiXSxbMiwxLCJzfF97VVxcY2FwIFZ9Il0sWzMsMSwiXFx2YXJwaGleXFxzaGFycF97VVxcY2FwIFZ9KHN8X3tVXFxjYXAgVn0pIl0sWzAsMSwiXFx2YXJwaGleXFxzaGFycF9WIl0sWzAsMiwiXFxqbWF0aF5cXHNoYXJwX1YiLDJdLFsxLDMsIihcXHZhcnBoaV8qXFxpb3RhXlxcc2hhcnApX1YiXSxbMiwzLCIoXFx2YXJwaGleXFxzaGFycHxfVSlfViJdLFs0LDUsIiIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XSxbNSw3LCIiLDAseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtYXBzIHRvIn19fV0sWzYsNywiIiwyLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dLFs0LDYsIiIsMix7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XV0=&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}
		{\OO_Y(V)} & {\varphi_*\OO_X(V)} & s & {\varphi^\sharp_V(s)} \\
		{\jmath_*(\OO_Y|_U)} & {\varphi_*\iota_*(\OO_X|_{\varphi^{-1}U})} & {s|_{U\cap V}} & {\varphi^\sharp_{U\cap V}(s|_{U\cap V})}
		\arrow["{\varphi^\sharp_V}", from=1-1, to=1-2]
		\arrow["{\jmath^\sharp_V}"', from=1-1, to=2-1]
		\arrow["{(\varphi_*\iota^\sharp)_V}", from=1-2, to=2-2]
		\arrow["{(\varphi^\sharp|_U)_V}", from=2-1, to=2-2]
		\arrow[maps to, from=1-3, to=1-4]
		\arrow[maps to, from=1-4, to=2-4]
		\arrow[maps to, from=2-3, to=2-4]
		\arrow[maps to, from=1-3, to=2-3]
	\end{tikzcd}\]
\end{remark}
\begin{remark} \label{rem:factor-through-open}
	As an example of when this might be useful, suppose a morphism $(\varphi,\varphi^\sharp)\colon(X,\OO_X)\to(Y,\OO_Y)$ actually outputs topologically into an open subset $V\subseteq Y$. Then $\varphi^{-1}V=X$, so our restriction will just end up being
	\[(\varphi,\varphi^\sharp)|_V\colon(X,\OO_X)\to(V,\OO_Y|_V),\]
	which by \autoref{rem:open-embed-commutes} becomes $(\varphi,\varphi^\sharp)$ after embedding $(V,\OO_Y|_V)\into(Y,\OO_Y)$ again.
\end{remark}

\subsection{\texorpdfstring{$K$}{ K}-points}
The morphism of a locally ringed space contains a lot of data, so it will be helpful to see all this data go to use. Here's an example.
\begin{definition}[Residue field]
	Fix a locally ringed space $(X,\OO_X)$. Given a point $x\in X$, define $\mf m_x\subseteq\OO_{X,x}$ to be the unique maximal ideal of $\OO_{X,x}$. Then the \textit{residue field} of $x$ is $k(x)\coloneqq\OO_{X,x}/\mf m_x$.
\end{definition}
\begin{exe}
	Fix a locally ringed space $(X,\OO_X)$ and a field $K$. Then the data of a morphism of locally ringed spaces $(\varphi,\varphi^\sharp)\colon(\Spec K,\OO_{\Spec K})\to(X,\OO_X)$ can be equivalently presented as a point $p\in X$ equipped with an inclusion $\iota\colon k(p)\to K$.
\end{exe}
Intuitively, we are saying that morphisms from the affine scheme over $K$ correspond to ``$K$-points of $X$,'' for a suitable definition of $K$-points.
\begin{proof}
	Let $M$ be the set of morphisms $(\varphi,\varphi^\sharp)\colon(\Spec K,\OO_{\Spec K})\to(X,\OO)$, and let $P$ be the set of ordered pairs $(p,\iota)$ where $p\in X$ is a point and $\iota\colon k(p)\into K$ is an embedding. We exhibit a bijection between $M$ and $P$. Here are the maps.
	\begin{itemize}
		\item We exhibit a map $\alpha\colon M\to P$. Well, given a morphism $(\varphi,\varphi^\sharp)\colon(\Spec K,\OO_{\Spec K})\to(X,\OO)$, we have an underlying continuous map $\varphi\colon\Spec K\to X$ and sheaf morphism $\varphi^\sharp\colon\OO\to\varphi_*\OO_{\Spec K}$.
		
		Now, $(0)\in\Spec K$, so we {set $p\coloneqq\varphi((0))$}. Then {$\varphi^\sharp$ will provide a map}
		\[\OO_p\stackrel{\varphi^\sharp_p}\to(\varphi_*\OO_{\Spec K})_{p}\to\OO_{\Spec K,(0)}\cong K_{(0)}=K.\]
		This is supposed to be a map of local rings, so the pre-image of the maximal ideal $(0)\subseteq K$ is supposed to equal $\mf m_p$, so we actually induce an embedding $\iota\colon\OO_p/\mf m_p\into K$. Thus, we set $\alpha((\varphi,\varphi^\sharp))=(p,\iota)$.

		\item We exhibit a map $\beta\colon P\to M$. We are provided with a point $p\in X$ and an inclusion $\OO_p/\mf m_p\to K$. Here is the defining data.
		\begin{itemize}
			\item Define $\varphi\colon\Spec K\to X$ by {$\varphi((0))\coloneqq p$}. To see that this continuous, note any open subset $U\subseteq X$ containing $p$ have $\varphi^{-1}(U)=\{(0)\}=\Spec K$, which is open. Otherwise, the open subset $U\subseteq X$ does not contain $p$, so $\varphi^{-1}(U)=\emp$, which is still open.
			\item Given an open subset $U\subseteq X$, we define $\varphi^\sharp_U\colon\OO(U)\to\varphi_*\OO_{\Spec K}(U)$. If $U$ does not contain $p$, then
			\[\varphi_*\OO_{\Spec K}(U)=\OO_{\Spec K}\left(\varphi^{-1}(U)\right)=\OO_{\Spec K}(\emp)=0,\]
			so we set $\varphi^\sharp_U$ to be the zero map. Otherwise, when $U$ contains $p$, we see
			\[\varphi_*\OO_{\Spec K}(U)=\OO_{\Spec K}\left(\varphi^{-1}(U)\right)=\OO_{\Spec K}(\Spec K)=K,\]
			so we need to exhibit a map $\varphi^\sharp_U\colon\OO(U)\to K$. For this, we use the composite map
			\[\arraycolsep=1.4pt\begin{array}{ccccccc}
				\OO(U) &\to& \OO_p &\to& \OO_p/\mf m_p &\stackrel\iota\to& K \\
				s &\mapsto& s|_p &\mapsto& (s|_p+\mf m_p) &\mapsto& \iota(s|_p+\mf m_p)
			\end{array}\]
			as our $\varphi^\sharp_U$.
		\end{itemize}
		We quickly check that $\varphi^\sharp$ assembles into a map of sheaves. Fix open sets $U'\subseteq U$, and we want the diagram
		% https://q.uiver.app/?q=WzAsNCxbMCwwLCJcXE9PKFUpIl0sWzAsMSwiXFxPTyhVJykiXSxbMSwwLCJcXHZhcnBoaV8qXFxPT197XFxTcGVjIEt9KFUpIl0sWzEsMSwiXFx2YXJwaGlfKlxcT09fe1xcU3BlYyBLfShVJykiXSxbMCwyLCJcXHZhcnBoaV5cXHNoYXJwX1UiXSxbMCwxLCJcXG9we3Jlc31fe1UsVSd9IiwyXSxbMSwzLCJcXHZhcnBoaV5cXHNoYXJwX3tVJ30iXSxbMiwzLCJcXG9we3Jlc31fe1UsVSd9Il1d&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
		\begin{equation}
			\begin{tikzcd}
				{\OO(U)} & {\varphi_*\OO_{\Spec K}(U)} \\
				{\OO(U')} & {\varphi_*\OO_{\Spec K}(U')}
				\arrow["{\varphi^\sharp_U}", from=1-1, to=1-2]
				\arrow["{\op{res}_{U,U'}}"', from=1-1, to=2-1]
				\arrow["{\varphi^\sharp_{U'}}", from=2-1, to=2-2]
				\arrow["{\op{res}_{U,U'}}", from=1-2, to=2-2]
			\end{tikzcd} \label{eq:definingbetadiagram}
		\end{equation}
		to commute. We have two cases.
		\begin{itemize}
			\item If $p\notin U'$, then $\varphi_*\OO_{\Spec K}(U')=0$, so \autoref{eq:definingbetadiagram} commutes for free.
			\item If $p\in U'$, then $p\in U$ as well, so \autoref{eq:definingbetadiagram} becomes the diagram
			% https://q.uiver.app/?q=WzAsOCxbMCwwLCJcXE9PKFUpIl0sWzAsMSwiXFxPTyhVJykiXSxbMSwwLCJLIl0sWzEsMSwiSyJdLFszLDAsInMiXSxbNCwwLCJcXGlvdGEoc3xfcCtcXG1mIG1fcCkiXSxbMywxLCJzfF97VSd9Il0sWzQsMSwiXFxpb3RhKHN8X3ArXFxtZiBtX3ApIl0sWzAsMiwiXFx2YXJwaGleXFxzaGFycF9VIl0sWzAsMSwiXFxvcHtyZXN9X3tVLFUnfSIsMl0sWzEsMywiXFx2YXJwaGleXFxzaGFycF97VSd9Il0sWzIsMywiXFxvcHtyZXN9X3tVLFUnfSJdLFs0LDYsIiIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XSxbNCw1LCIiLDIseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtYXBzIHRvIn19fV0sWzUsNywiIiwyLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dLFs2LDcsIiIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XV0=&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
			\[\begin{tikzcd}
				{\OO(U)} & K && s & {\iota(s|_p+\mf m_p)} \\
				{\OO(U')} & K && {s|_{U'}} & {\iota(s|_p+\mf m_p)}
				\arrow["{\varphi^\sharp_U}", from=1-1, to=1-2]
				\arrow["{\op{res}_{U,U'}}"', from=1-1, to=2-1]
				\arrow["{\varphi^\sharp_{U'}}", from=2-1, to=2-2]
				\arrow["{\op{res}_{U,U'}}", from=1-2, to=2-2]
				\arrow[maps to, from=1-4, to=2-4]
				\arrow[maps to, from=1-4, to=1-5]
				\arrow[maps to, from=1-5, to=2-5]
				\arrow[maps to, from=2-4, to=2-5]
			\end{tikzcd}\]
			which does indeed commute.
		\end{itemize}
		Next we check that $(\varphi,\varphi^\sharp)$ assembles into a morphism of locally ringed spaces. For this we have to check that, for any $\mf p\in\Spec K$, the composite
		\[\OO_{\varphi(\mf p)} \stackrel{\varphi^\sharp_p}\to (\varphi_*\OO_{\Spec K})_{\varphi(\mf p)} \to (\OO_{\Spec K})_\mf p\]
		is a map of local rings. Notably, the only point we have to check this is on $\mf p=(0)$ because $\Spec K=\{(0)\}$, and $\varphi((0))=p$, so we are checking that
		\[\arraycolsep=1.4pt\begin{array}{cccccccccc}
			\OO_{p} &\stackrel{\varphi^\sharp_p}\to& (\varphi_*\OO_{\Spec K})_{p} &\to& (\OO_{\Spec K})_0 \\
			{[(U,s)]} &\mapsto& \big[(U,\iota(s|_p+\mf m_p))\big] &\mapsto& \big[(\varphi^{-1}(U),\iota(s|_p+\mf m_p))\big]
		\end{array}\]
		is a map of local rings. Notably, $\varphi^{-1}(U)=\{(0)\}=\Spec K=D(1)$, so we can chain the above composite with the isomorphism $(\OO_{\Spec K})_0\cong K_{(0)}=K$, which will send $[(D(1),\overline s)]$ to $\overline s$. So we are showing that
		\[\arraycolsep=1.4pt\begin{array}{ccc}
			\OO_{p} &\to& K \\
			{[(U,s)]} &\mapsto& \iota(s|_p+\mf m_p)
		\end{array}\]
		is a map of local rings. (Namely, isomorphisms are maps of local rings, so we can ``unchain'' the above map with the previous isomorphisms to recover the needed map of local rings.) Well, the pre-image of the maximal ideal $(0)\subseteq K$ consists of sections $s_p\in\OO_p$ such that $\iota(s_p+\mf m_p)=0$; because $\iota$ is injective, we see that this is equivalent to $s_p\in\mf m_p$.
		
		So indeed, the pre-image of the maximal ideal $(0)$ is $\mf m_p$, verifying that we have a map of local rings. As such, we may define $\beta((p,\iota))\coloneqq(\varphi,\varphi^\sharp)$.
	\end{itemize}
	We now have to show that $\alpha$ and $\beta$ are inverses.
	\begin{itemize}
		\item Fix some $(p,\iota)\in P$. We show that $(\alpha\circ\beta)((p,\iota))=(p,\iota)$. Set $(\varphi,\varphi^\sharp)\coloneqq\beta((p,\iota))$, and we need to compute $\alpha((\varphi,\varphi^\sharp))$. To start, by construction, we see
		\[\varphi((0))=p,\]
		as it should be. To solve for $\iota$, we note that above we tracked through the map
		\[\arraycolsep=1.4pt\begin{array}{cccccccccc}
			\OO_{p} &\stackrel{\varphi^\sharp_p}\to& (\varphi_*\OO_{\Spec K})_{p} &\to& (\OO_{\Spec K})_0 &\cong& K_{(0)} &=& K \\
			{[(U,s)]} &\mapsto& \big[(U,\iota(s|_p+\mf m_p))\big] &\mapsto& \big[(\varphi^{-1}(U),\iota(s|_p+\mf m_p))\big] &\mapsto&  & & \iota(s|_p+\mf m_p)
		\end{array}\]
		as having kernel $\mf m_p$, so the induced map $\OO_p/\mf m_p\to K$ is just $(s_p+\mf m_p)\mapsto\iota(s_p+\mf m_p)$. Thus, this map induced by $\alpha((\varphi,\varphi^\sharp))$ is exactly $\iota$, as needed.
		\item Fix some $(\varphi,\varphi^\sharp)\in M$. We show that $(\beta\circ\alpha)((\varphi,\varphi^\sharp))=(\varphi,\varphi^\sharp)$. Set $(p,\iota)\coloneqq\alpha((\varphi,\varphi^\sharp))$ and $(\psi,\psi^\sharp)\coloneqq\beta((p,\iota))$, and we will show $(\psi,\psi^\sharp)=(\varphi,\varphi^\sharp)$. By construction, we see $\psi((0))=p$, so we get $\psi=\varphi$ immediately.

		To show $\psi^\sharp=\varphi^\sharp$, we need to show that $\psi^\sharp_U=\varphi^\sharp_U$ as functions $\OO(U)\to\varphi_*\OO_{\Spec K}(U)$ for each open $U\subseteq X$. We have two cases.
		\begin{itemize}
			\item If $p\notin U$, then $\varphi_*\OO_{\Spec K}(U)=\OO_{\Spec K}\left(\varphi^{-1}(U)\right)=\OO_{\Spec K}(\emp)=0$, so $\psi^\sharp_U$ and $\varphi^\sharp_U$ must both be the zero map because $0$ is terminal.
			\item Otherwise, we have $p\in U$; note that $\varphi^\sharp_U,\psi^\sharp_U\colon\OO(U)\to K$ now. By definition, $\psi^\sharp_U$ sends a section $s\in\OO(U)$ to $\iota(s|_p+\mf m_p)$; by definition, $\iota$ sends some $s|_p+\mf m_p$ down the composite
			\[\arraycolsep=1.4pt\begin{array}{ccccccccc}
				\OO_p &\stackrel{\varphi^\sharp_p}\to& (\varphi_*\OO_{\Spec K})_{p} &\to& \OO_{\Spec K,(0)} &\cong& K_{(0)} &=& K \\
				{[(U,s)]} &\mapsto& \big[(U,\varphi^\sharp_U(s))\big] &\mapsto& \big[(\varphi^{-1}(U),\varphi^\sharp_U(s))\big] &\mapsto& & & \varphi^\sharp_U(s)
			\end{array}\]
			which verifies that $\psi^\sharp_U$ is sending $s\in\OO(U)$ all the way to $\varphi^\sharp_U(s)$.
		\end{itemize}
		From the above, it follows that $\psi^\sharp_U=\varphi^\sharp_U$, which finishes this last check.
		\qedhere
	\end{itemize}
\end{proof}
\begin{remark}
	There is a similar story one can tell for $K[\varepsilon]/(\varepsilon^2)$, where we can see that we will also want to keep track of some differential information from the $\varepsilon$.
\end{remark}

\subsection{Schemes}
We finally arrive at the definition of a scheme.
\begin{definition}[Scheme] \nirindex{Affine open subscheme}
	A \textit{scheme} is a ringed space $(X,\mc O_X)$ such that, for each $x\in X$, there is an open set $U\subseteq X$ containing $x$ such that the restriction
	\[(U,\mc O_X|_U)\]
	is isomorphic (as a locally ringed space) to an affine scheme $(\Spec A,\OO_{\Spec A})$. We call the $(U,\mc O_X|_U)$ an \textit{affine open subscheme} of $(X,\OO_X)$.
\end{definition}
Here are some quick facts about this definition.
\begin{lemma} \label{lem:openbasescheme}
	Fix a ring $A$ and a distinguished open set $D(f)\subseteq\Spec A$. Then
	\[(A_f,\OO_{\Spec A_f})\cong(D(f),\OO_{\Spec A}|_{D(f)}).\]
\end{lemma}
\begin{proof}
	The underlying homeomorphism is provided by \autoref{exe:distinguishedisaffine}; namely, set $\psi\coloneqq D(f)\to\Spec A_f$ by $\psi\colon\mf p\mapsto\mf pA_f$, which we showed is a homeomorphism. By \autoref{lem:betterlocaliso}, it suffices to exhibit a sheaf isomorphism
	\[\psi^\sharp\colon\OO_{\Spec A_f}\to\psi_*\OO_{\Spec A}|_{D(f)}.\]
	By \autoref{lem:sheafonabasefunctor}, it suffices provide a sheaf isomorphism on the distinguished base. Well, given a distinguished basis set $D(a/f^m)\subseteq\Spec A_f$, we showed in \autoref{exe:distinguishedisaffine} that $\psi^{-1}(D(a/f^m))=D(a)\subseteq D(f)$, so we define
	\[\psi^\sharp_{D(a/f^m)}\colon\OO_{\Spec A_f}\left(D(a/f^m)\right)\to\OO_{\Spec A}\left(\psi^{-1}(D(a))\right)\]
	as the string of isomorphisms
	\[\OO_{\Spec A_f}\left(D(a/f^m)\right)=\OO_{\Spec A_f}\left(D(a)\right)\simeq A_{f,a}\simeq A_a\simeq\OO_{\Spec A}(D(a)),\]
	where $A_{f,a}\simeq A_a$ because $D(a)\subseteq D(f)$. In particular, this assembles into a morphism of sheaves on a base because, for $D(a/f^m)\subseteq D(b/f^n)$, the diagram
	% https://q.uiver.app/?q=WzAsMTAsWzAsMCwiXFxPT197XFxTcGVjIEFfZn1cXGxlZnQoRChhL2ZebSlcXHJpZ2h0KSJdLFswLDEsIlxcT09fe1xcU3BlYyBBX2Z9XFxsZWZ0KEQoYi9mXm4pXFxyaWdodCkiXSxbMSwwLCJcXE9PX3tcXFNwZWMgQV9mfVxcbGVmdChEKGEpXFxyaWdodCkiXSxbMSwxLCJcXE9PX3tcXFNwZWMgQV9mfVxcbGVmdChEKGIpXFxyaWdodCkiXSxbMiwwLCJBX3tmLGF9Il0sWzIsMSwiQV97ZixifSJdLFszLDAsIkFfYSJdLFszLDEsIkFfYiJdLFs0LDAsIlxcT09fe1xcU3BlYyBBfShEKGEpKSJdLFs0LDEsIlxcT09fe1xcU3BlYyBBfShEKGIpKSJdLFswLDIsIiIsMCx7ImxldmVsIjoyLCJzdHlsZSI6eyJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzEsMywiIiwwLHsibGV2ZWwiOjIsInN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMCwxLCJcXG9we3Jlc30iLDJdLFsyLDMsIlxcb3B7cmVzfSIsMl0sWzIsNCwiXFxzaW1lcSIsMyx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6Im5vbmUifSwiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFszLDUsIlxcc2ltZXEiLDMseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJub25lIn0sImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbNCw2LCJcXHNpbWVxIiwzLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoibm9uZSJ9LCJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzUsNywiXFxzaW1lcSIsMyx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6Im5vbmUifSwiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFs2LDgsIlxcc2ltZXEiLDMseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJub25lIn0sImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbNyw5LCJcXHNpbWVxIiwzLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoibm9uZSJ9LCJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzgsOSwiXFxvcHtyZXN9IiwyXV0=&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}[column sep=tiny]
		{\OO_{\Spec A_f}\left(D(a/f^m)\right)} & {\OO_{\Spec A_f}\left(D(a)\right)} & {A_{f,a}} & {A_a} & {\OO_{\Spec A}(D(a))} \\
		{\OO_{\Spec A_f}\left(D(b/f^n)\right)} & {\OO_{\Spec A_f}\left(D(b)\right)} & {A_{f,b}} & {A_b} & {\OO_{\Spec A}(D(b))}
		\arrow[Rightarrow, no head, from=1-1, to=1-2]
		\arrow[Rightarrow, no head, from=2-1, to=2-2]
		\arrow["{\op{res}}"', from=1-1, to=2-1]
		\arrow["{\op{res}}"', from=1-2, to=2-2]
		\arrow["\simeq"{marking}, draw=none, from=1-2, to=1-3]
		\arrow["\simeq"{marking}, draw=none, from=2-2, to=2-3]
		\arrow["\simeq"{marking}, draw=none, from=1-3, to=1-4]
		\arrow["\simeq"{marking}, draw=none, from=2-3, to=2-4]
		\arrow["\simeq"{marking}, draw=none, from=1-4, to=1-5]
		\arrow["\simeq"{marking}, draw=none, from=2-4, to=2-5]
		\arrow["{\op{res}}"', from=1-5, to=2-5]
	\end{tikzcd}\]
	because all the maps are just localization maps in various orders. In particular, all elements in the top row can be written in the form $s/a^m$ for some $s\in A$ and $m\in\NN$, which makes all maps on the top the identity. Then transporting this element to the bottom row, all elements become exactly $s/a^m$, so the diagram is indeed commuting.
\end{proof}
\begin{cor} \label{cor:getopensubscheme}
	Fix a scheme $(X,\OO_X)$. Then any open subset $U\subseteq X$ induces an ``open subscheme'' $(U,\OO_X|_U)$.
\end{cor}
\begin{proof}
	The affine case follows from \autoref{lem:openbasescheme}. The general case follows by reducing to an affine open cover.

	To see this explicitly, fix some $p\in U$. We need to find an open subset $U_p\subseteq U$ such that $(U_p,\OO_X|_U|_{U_p})$ is an affine open subscheme of $X$; quickly, note we will have $\OO_X|_U|_{U_p}=\OO_X|_{U_p}$, which is clear on the level of open sets, and the restriction maps are just induced.

	Because $X$ is a scheme, we can find some affine open subset $V_p\subseteq X$ containing $p$, so find our isomorphism
	\[(\varphi,\varphi^\sharp)\colon(V_p,\OO_X|_{V_p})\cong(\Spec B_p,\OO_{\Spec B_p}).\]
	Now, $U\cap V_p\subseteq V_p$ is an open subset, so $\varphi(U)\subseteq\Spec B_p$ is still an open subset. Thus, we can find an element $D(f)\subseteq\varphi(U)$ of the distinguished base containing $\varphi(p)$. Setting $U_p\coloneqq\varphi^{-1}(D(f))$ (which is still open), we have the chain of isomorphisms
	\[(U_p,\OO_X|_{U_p})\stackrel{(\varphi,\varphi^\sharp)|_{D(f)}}\cong(D(f),\OO_{\Spec B_p}|_{D(f)})\cong(\Spec(B_p)_f,\OO_{\Spec(B_p)_f}).\]
	Namely, the first isomorphism is from \autoref{lem:restrictmorphism}, and the second isomorphism is from \autoref{lem:openbasescheme}.
\end{proof}

\subsection{Geometry Is Opposite Algebra}
We are going to build towards the following result.
\begin{restatable}{theorem}{geoisalgopp} \label{thm:geoisoppalg}
	The functors
	\[\arraycolsep=1.4pt\begin{array}{ccc}
		\mathrm{Rings}\opp &\simeq& \mathrm{AffSch} \\
		A &\mapsto& (\Spec A,\OO_{\Spec A}) \\
		\OO_X(X) &\mapsfrom& (X,\OO_X)
	\end{array}\]
	define an equivalence of categories.
\end{restatable}
\noindent It turns out that we can extend \autoref{thm:geoisoppalg} to work with general locally ringed spaces. We will state this as an adjunction of two functors. Here are our two functors.
\begin{lemma}
	The mapping $(X,\OO_X)\mapsto\OO_X(X)$ defines the action of a functor
	\[\Gamma\colon\mathrm{LocRingSpace}\to\mathrm{Ring}\opp\]
	on objects.
\end{lemma}
\begin{proof}
	Given a morphism $(\varphi,\varphi^\sharp)\colon(X,\OO_X)\to(Y,\OO_Y)$, we induce a morphism
	\[\OO_Y(Y)\stackrel{\varphi^\sharp_Y}\to\varphi_*\OO_X(Y)=\OO_X(X),\]
	so we define $\Gamma((\varphi,\varphi^\sharp))\coloneqq\varphi^\sharp_Y$. Here are our functoriality checks.
	\begin{itemize}
		\item Identity: note that ${\id_{(X,\OO_X)}}=({\id_X},{\id_{\OO_X}})$, so this will induce the morphism $\Gamma({\id_{(X,\OO_X)}})=({\id_{\OO_X}})_X=\id_{\OO_X(X)}$.
		\item Functoriality: given morphisms $(\varphi,\varphi^\sharp)\colon(X,\OO_X)\to(Y,\OO_Y)$ and $(\psi,\psi^\sharp)\colon(Y,\OO_Y)\to(Z,\OO_Z)$, we note the composite $(\psi,\psi^\sharp)\circ(\varphi,\varphi^\sharp)$ taken through $\Gamma$ acts as
		\[\OO_Z(Z)\stackrel{\psi^\sharp_Z}\to\psi_*\OO_Y(Z)\stackrel{(\psi_*\varphi^\sharp)_{Z}}\to\psi_*\varphi_*\OO_X(Z)=\OO_X(X)\]
		on global sections. Now, we can see that this composite is $\varphi^\sharp_Y\circ\psi^\sharp_Z=\Gamma((\varphi,\varphi^\sharp))\circ \Gamma((\psi,\psi^\sharp))$ on global sections.
		\qedhere
	\end{itemize}
\end{proof}
\begin{lemma} \label{lem:spec}
	The mapping $A\mapsto(\Spec A,\OO_{\Spec A})$ defines the action of a functor
	\[\Spec\colon\mathrm{Ring}\opp\to\mathrm{LocRingSpace}\]
	on objects.
\end{lemma}
\begin{proof}
	Given a ring homomorphism $f\colon A\to B$, we need to induce a morphism $(\varphi,\varphi^\sharp)\colon(\Spec B,\OO_{\Spec B})\to(\Spec A,\OO_{\Spec A})$. For brevity, given a ring $R$, we will define $\OO_R\coloneqq\OO_{\Spec R}$.
	\begin{itemize}
		\item On topological spaces, we define $\varphi\coloneqq f^{-1}$ to be our continuous map $\Spec B\to\Spec A$. This is continuous by \autoref{lem:specmorphism} and functorial by \autoref{lem:specmorphism}.
		\item On sheaves, it suffices to induce the morphism $\varphi^\sharp\colon\OO_A\to\varphi_*\OO_B$ on the distinguished base $\{D(a)\}_{a\in A}$ by \autoref{lem:specmorphism}. Well, given $a\in A$, we can compute
		\[\varphi^{-1}(D(a))=\{\mf q\in\Spec B:a\notin f^{-1}\mf q\}=\left\{\mf p\in\Spec A:f(a)\notin\mf q\right\}=D(f(a)),\]
		so $\varphi^\sharp_{D(a)}$ is a map $A_a\to B_{f(a)}$. However, this is induced directly from the localization map $A\to B\to B_{f(a)}$ upon noting that $a\in A$ goes to a unit $f(a)\in B_{f(a)}$.

		To finish, we do need to check that this is a morphism of sheaves on a base. Suppose $D(a')\subseteq D(a)$, which means that there is a canonical localization map $A_a\simeq A_{S(D(a))}\to A_{S(D(a'))}\simeq A_{a'}$. (Namely, $a\in A_{a'}^\times$.) Then we see that the left diagram of
		% https://q.uiver.app/?q=WzAsMTIsWzAsMCwiXFxPT19BKEQoYSkpIl0sWzAsMSwiXFxPT19BKEQoYScpKSJdLFsxLDAsIlxcdmFycGhpXypcXE9PX0IoRChhKSkiXSxbMSwxLCJcXHZhcnBoaV8qXFxPT19CKEQoYScpKSJdLFszLDAsIkFfYSJdLFszLDEsIkFfe2EnfSJdLFs0LDAsIkJfe2YoYSl9Il0sWzQsMSwiQl97ZihhJyl9Il0sWzUsMCwiYS8xIl0sWzUsMSwiYS8xIl0sWzYsMCwiZihhKS8xIl0sWzYsMSwiZihhKS8xIl0sWzAsMiwiXFx2YXJwaGleXFxzaGFycF97RChhKX0iXSxbMSwzLCJcXHZhcnBoaV5cXHNoYXJwX3tEKGEnKX0iXSxbMCwxLCJcXG9we3Jlc31fe0QoYSksRChhJyl9IiwyXSxbMiwzLCJcXG9we3Jlc31fe0QoYSksRChhJyl9Il0sWzQsNiwiZiJdLFs0LDVdLFs1LDcsImYiXSxbNiw3XSxbOCwxMCwiIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dLFsxMCwxMSwiIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dLFs4LDksIiIsMix7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XSxbOSwxMSwiIiwyLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dXQ==&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
		\[\begin{tikzcd}
			{\OO_A(D(a))} & {\varphi_*\OO_B(D(a))} && {A_a} & {B_{f(a)}} & {x} & {f(x)} \\
			{\OO_A(D(a'))} & {\varphi_*\OO_B(D(a'))} && {A_{a'}} & {B_{f(a')}} & {x/1} & {f(x)/1}
			\arrow["{\varphi^\sharp_{D(a)}}", from=1-1, to=1-2]
			\arrow["{\varphi^\sharp_{D(a')}}", from=2-1, to=2-2]
			\arrow["{\op{res}_{D(a),D(a')}}"', from=1-1, to=2-1]
			\arrow["{\op{res}_{D(a),D(a')}}", from=1-2, to=2-2]
			\arrow["f", from=1-4, to=1-5]
			\arrow[from=1-4, to=2-4]
			\arrow["f", from=2-4, to=2-5]
			\arrow[from=1-5, to=2-5]
			\arrow[maps to, from=1-6, to=1-7]
			\arrow[maps to, from=1-7, to=2-7]
			\arrow[maps to, from=1-6, to=2-6]
			\arrow[maps to, from=2-6, to=2-7]
		\end{tikzcd}\]
		commutes because it is the same as the middle diagram.
	\end{itemize}
	To finish our construction, we need to know that $(\varphi,\varphi^\sharp)\colon(\Spec B,\OO_B)\to(\Spec A,\OO_A)$ assembles into a map of locally ringed spaces. Namely, we need to verify that, for each $\mf q\in\Spec B$, the map
	\[\arraycolsep=1.4pt\begin{array}{cccccccc}
		\OO_{A,\varphi(\mf q)} &\stackrel{\varphi^\sharp_\mf q}\to& (\varphi_*\OO_B)_\mf q &\to& \OO_{B,\mf q} \\
		\left[(D(a),s/a^m)\right] &\mapsto& \left[(D(a),f(s)/f(a)^m)\right] &\mapsto& \left[(D(f(a)),f(s)/f(a)^m)\right]
	\end{array}\]
	is a map of local rings; notably, we are using \autoref{lem:stalkbybase} to define the stalk on the distinguished base. Well, given $\left[(D(a),s/a^m)\right]\in\mf m_{\varphi(\mf q)}$ implies that $s\in\varphi(\mf q)=f^{-1}(\mf q)$, so $f(s)\in\mf q$, so $\left[(D(f(a)),f(s)/f(a)^m)\right]\in\mf m_\mf q$.

	Thus, we define $\Spec f\coloneqq(\varphi,\varphi^\sharp)$. It remains to run our functoriality checks.
	\begin{itemize}
		\item Identity: note that $f=\id_A$ makes $\varphi\colon\Spec A\to\Spec A$ the identity \autoref{lem:specmorphism}, and each $a\in A$ induces the localization map $A_a\to A_{f(a)}$, which we can see visually is just the identity map. Thus, $\varphi^\sharp_{D(a)}$ is the identity for each distinguished base element $D(a)$, so $\varphi^\sharp\colon\OO_A\to\varphi_*\OO_A$ is just the identity by \autoref{lem:morphismonbase}.

		Thus, $(\varphi,\varphi^\sharp)$ is the identity morphism on the locally ringed space $(\Spec A,\OO_A)$.
		
		\item Functoriality: fix ring morphisms $f\colon A\to B$ and $g\colon B\to C$ yielding morphisms of locally ringed spaces $(\varphi,\varphi^\sharp)\colon(\Spec B,\OO_B)\to(\Spec A,\OO_A)$ and $(\psi,\psi^\sharp)\colon(\Spec C,\OO_C)\to(\Spec B,\OO_B)$. For brevity, we will also define $(\gamma,\gamma^\sharp)=\Spec(g\circ f)$ to be the morphism induced by the composite. We need to show $(\gamma,\gamma^\sharp)=(\varphi,\varphi^\sharp)\circ(\psi,\psi^\sharp)$.

		We already know we are functorial on the level of topological spaces (i.e., $\gamma=\varphi\circ\psi$) by \autoref{lem:specmorphism}. Then on sheaves, we need to check that $\gamma^\sharp=\varphi_*\psi^\sharp\circ\varphi^\sharp$. Well, for some distinguished open set $D(a)\subseteq\Spec A$, our composite is
		\[(\varphi_*\psi^\sharp\circ\varphi^\sharp)_{D(a)}=\psi^\sharp_{\varphi^{-1}(D(a))}\circ\varphi^\sharp_{D(a)}=\psi^\sharp_{D(f(a))}\circ\varphi^\sharp_{D(a)}\]
		using computations above. Unwrapping our construction, we see that this composite is the composite of the localized maps
		\[A_a\stackrel f\to B_{f(a)}\stackrel g\to C_{g(f(a))},\]
		which of course is just the single map $A_a\to C_{g(f(a))}$ induced by localizing $g\circ f$. So we do indeed match with $\gamma^\sharp$ on the base, so we have an equality of sheaves on the base by \autoref{lem:morphismonbase}.
		\qedhere
	\end{itemize}
\end{proof}
We now exhibit the first of our natural maps.
\begin{lemma} \label{lem:gammaspec}
	We exhibit a map $\eta_\bullet\colon\id_{\mathrm{Ring}}\Rightarrow\Gamma\Spec$.
\end{lemma}
\begin{proof}
	Fix an object $A$. To begin, we compute
	\[\Gamma((\Spec A,\OO_{\Spec A}))=\OO_{\Spec A}(\Spec A)=A,\]
	so we set $\eta_A\coloneqq\id_A$.
	% The naturality check picks some ring morphism $f\colon A\to B$ and notes that the diagram
	% % https://q.uiver.app/?q=WzAsNCxbMSwwLCJcXEdhbW1hKChcXFNwZWMgQSxcXE9PX3tcXFNwZWMgQX0pKSJdLFsxLDEsIlxcR2FtbWEoKFxcU3BlYyBCLFxcT09fe1xcU3BlYyBCfSkpIl0sWzAsMCwiQSJdLFswLDEsIkIiXSxbMCwxLCJcXEdhbW1hKFxcU3BlYyBmKSJdLFsyLDMsImYiLDJdLFsyLDAsIiIsMCx7ImxldmVsIjoyLCJzdHlsZSI6eyJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzMsMSwiIiwyLHsibGV2ZWwiOjIsInN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XV0=&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	% \[\begin{tikzcd}
	% 	A & {\Gamma((\Spec A,\OO_{\Spec A}))} \\
	% 	B & {\Gamma((\Spec B,\OO_{\Spec B}))}
	% 	\arrow["{\Gamma(\Spec f)}", from=1-2, to=2-2]
	% 	\arrow["f"', from=1-1, to=2-1]
	% 	\arrow[Rightarrow, no head, from=1-1, to=1-2]
	% 	\arrow[Rightarrow, no head, from=2-1, to=2-2]
	% \end{tikzcd}\]
	% commutes because setting $(\varphi,\varphi^\sharp)=\Spec f$ has $\Gamma(\Spec f)=\varphi^\sharp_{\Spec A}=\varphi^\sharp_{D(1)}=\id_A$.
\end{proof}
Going in the other direction is a little more subtle because we need to construct a morphism of locally ringed spaces from a morphism of just the global sections. For example, we will need to construct a continuous map, so we will need access to some open sets. Here are the ones we will need.
\begin{lemma} \label{lem:someopensupp}
	Fix a locally ringed space $(X,\OO_X)$. Then, for some $f\in\OO_X(X)$, the subset
	\[X_f\coloneqq\left\{p\in X:f|_p\in\OO_{X,p}^\times\right\}\]
	is open in $X$.
\end{lemma}
\begin{proof}
	For each $p\in X_f$, we need to provide an open neighborhood $U_p\subseteq X_f$ containing $p$. Well, we are given $f|_p\in\OO_{X,p}^\times$, so there is some germ $g_p$ such that
	\[g_p\cdot f|_p=1.\]
	In particular, giving $g_p$ a sufficiently restricted representative, we can find an open subset $U_p$ containing $p$ and some $g\in\OO_X(U_p)$ such that
	\[g\cdot f|_{U_p}=1.\]
	In particular, any $q\in U_p$ will thus have $g|_q\cdot f|_q=1$, so $f|_q\in\OO_{X,q}^\times$, so $q\in X_f$. Thus, $U_p\subseteq X_f$ does the trick.
\end{proof}
Here is another quick fact we will want.
\begin{lemma} \label{lem:finvertsinxf}
	Fix a locally ringed space $(X,\OO_X)$. For some $f\in\OO_X(X)$, consider the open set $X_f$ of \autoref{lem:someopensupp}. Then $f\in\OO_X(X_f)^\times$.
\end{lemma}
\begin{proof}
	For each $p\in X_f$, we know that $f|_p\in\OO_{X,p}$ is a unit, so find $g_p\in\OO_{X,p}$ with $f|_p\cdot g_p=1$. We claim that $(g_p)_{p\in X_f}$ is a compatible system of germs. Well, for each $p\in U$, the equation
	\[f|_p\cdot g_p=1\]
	promises an open set $U_p\subseteq X_f$ containing $p$ and a lift $\widetilde g_p\in\OO_X(U_p)$ such that $f|_{U_p}\cdot\widetilde g_p=1$. Thus, for any $q\in U_p$, we see
	\[f|_q\cdot\widetilde g_p|_q=1,\]
	so uniqueness of multiplicative inverses forces $\widetilde g_p|_q=g_q$. This finishes the compatibility check.

	Thus, we are granted $g\in\OO_X(X_f)$ such that $(fg)|_p=f|_p\cdot g|_p=1$ for each $p\in X_f$. It follows that $fg=1$ by \autoref{prop:stalkinjection}, so we have witnessed $f\in\OO_X(X_f)^\times$.
\end{proof}
\begin{remark} \label{rem:pre-image-xfs}
	As an aside, this construction behaves through morphisms. Fix some open subscheme $U\subseteq Y$ and a morphism $\pi\colon X\to Y$. Then, for some $f\in\OO_Y(U)$, we compute
	\[\pi^{-1}(U_f)=\{x\in X:\pi(x)\in U_f\}=\{x\in X:f\notin\mf m_{Y,\pi(x)}\}.\]
	Now, recall that the composite $\OO_{Y,\pi(x)}\stackrel{\pi^\sharp_{\pi(x)}}\to(\pi_*\OO_{X})_{\pi(x)}\to\OO_{X,x}$ is a map of local rings, so $f\notin\mf m_{Y,\pi(x)}$ is equivalent to $\pi^\sharp_U(f)\notin\mf m_{X,x}$, so we see $\pi^{-1}(U_f)=\pi^{-1}(U)_{\pi^\sharp_U(f)}.$
\end{remark}
And here is the result.
\begin{lemma} \label{lem:specgamma}
	We exhibit a natural transformation $\varepsilon_\bullet\colon\id_{\mathrm{LocRingSpace}}\Rightarrow\Spec\Gamma$.
\end{lemma}
\begin{proof}
	Fix a locally ringed space $(X,\OO_X)$ so that we need to exhibit a map
	\[\varepsilon_X\colon(X,\OO_X)\to(\Spec\OO_X(X),\OO_{\Spec\OO_X(X)}).\]
	We define this map in pieces.
	\begin{itemize}
		\item We need a continuous map $\varphi\colon X\to\Spec\OO_X(X)$. Well, given $p\in X$, we define $\varphi(p)\in\Spec\OO_X(X)$ as the kernel of the composite
		\[\OO_X(X)\to\OO_{X,p}\onto\OO_{X,p}/\mf m_{X,p}.\]
		This kernel makes a prime ideal because modding out by it induces a subring of $\OO_{X,p}/\mf m_{X,p}$, which must be an integral domain.

		To see that $\varphi$ is continuous, it suffices to check on the distinguished open base. Well, for some $f\in\OO_X(X)$, we see that
		\[\varphi^{-1}(D(f))=\{p\in X:\varphi(p)\in D(f)\}=\{p\in X:f\notin\varphi(p)\}=\{p\in X:f|_p\notin\mf m_{X,p}\}.\]
		However, this last condition is equivalent to $f|_p\in\OO_{X,p}^\times$, so our pre-image is the open set $X_f$ by \autoref{lem:someopensupp}.

		\item Next we need a sheaf morphism $\varphi^\sharp\colon\OO_{\Spec\OO_X(X)}\to\varphi_*\OO_X$. By \autoref{lem:morphismonbase}, it suffices to exhibit $\varphi^\sharp$ on the distinguished base of $\OO_{\Spec\OO_X(X)}$. Well, for some $f\in\OO_X(X)$, we need a map
		\[\OO_X(X)_f\simeq\OO_{\Spec\OO_X(X)}(D(f))\to\OO_X\left(\varphi^{-1}(D(f))\right)=\OO_X(X_f).\]
		Now, there is the obvious restriction map $\OO_X(X)\to\OO_X(X_f)$, and $f\in\OO_X(X_f)^\times$ by \autoref{lem:finvertsinxf} will exhibit the required map $\varphi^\sharp_{D(f)}\colon\OO_X(X)_f\to\OO_X(X_f)$.

		We now check that we have built a morphism of sheaves on the distinguished base. Well, given that $D(f')\subseteq D(f)$ for $f,f'\in\OO_X(X)$, we see that the diagram
		% https://q.uiver.app/?q=WzAsMTAsWzAsMCwiXFxPT197XFxTcGVjXFxPT19YKFgpfShEKGYpKSJdLFswLDEsIlxcT09fe1xcU3BlY1xcT09fWChYKX0oRChmJykpIl0sWzEsMCwiXFxPT19YKFgpX2YiXSxbMSwxLCJcXE9PX1goWClfe2YnfSJdLFsyLDAsIlxcT09fWChYX2YpIl0sWzIsMSwiXFxPT19YKFhfe2YnfSkiXSxbNCwwLCJhXFxjZG90IGZeey1ufSJdLFs0LDEsImFcXGNkb3QgZl57LW59Il0sWzUsMCwiYXxfe1hfZn1cXGNkb3QoZnxfe1hfZn0pXnstbn0iXSxbNSwxLCJhfF97WF97Zid9fVxcY2RvdChmfF97WF97Zid9fSleey1ufSJdLFswLDEsIlxcb3B7cmVzfV97RChmKSxEKGYnKX0iLDJdLFswLDIsIlxcc2ltZXEiLDMseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJub25lIn0sImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMSwzLCJcXHNpbWVxIiwzLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoibm9uZSJ9LCJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzQsNSwiXFxvcHtyZXN9X3tYX2YsWF97Zid9fSIsMl0sWzIsNF0sWzMsNV0sWzYsOCwiIiwyLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dLFs2LDcsIiIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XSxbNyw5LCIiLDAseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtYXBzIHRvIn19fV0sWzgsOSwiIiwyLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dXQ==&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
		\[\begin{tikzcd}
			{\OO_{\Spec\OO_X(X)}(D(f))} & {\OO_X(X)_f} & {\OO_X(X_f)} && {a\cdot f^{-n}} & {a|_{X_f}\cdot(f|_{X_f})^{-n}} \\
			{\OO_{\Spec\OO_X(X)}(D(f'))} & {\OO_X(X)_{f'}} & {\OO_X(X_{f'})} && {a\cdot f^{-n}} & {a|_{X_{f'}}\cdot(f|_{X_{f'}})^{-n}}
			\arrow["{\op{res}_{X_f,X_{f'}}}"', from=1-1, to=2-1]
			\arrow["\simeq"{marking}, draw=none, from=1-1, to=1-2]
			\arrow["\simeq"{marking}, draw=none, from=2-1, to=2-2]
			\arrow["{\op{res}_{X_f,X_{f'}}}"', from=1-3, to=2-3]
			\arrow[from=1-2, to=1-3]
			\arrow[from=2-2, to=2-3]
			\arrow[maps to, from=1-5, to=1-6]
			\arrow[maps to, from=1-5, to=2-5]
			\arrow[maps to, from=2-5, to=2-6]
			\arrow[maps to, from=1-6, to=2-6]
		\end{tikzcd}\]
		commutes, so we have uniquely induced $\varphi^\sharp$ by \autoref{lem:morphismonbase}.
	\end{itemize}
	We should also verify that $(\varphi,\varphi^\sharp)$ assembles into a morphism of locally ringed spaces. Fixing a point $p\in X$, we need to show
	\[\arraycolsep=1.4pt\begin{array}{cccccccc}
		(\OO_{\Spec\OO_X(X)})_{\varphi(p)} &\stackrel{\varphi^\sharp_{\varphi(p)}}\to& (\varphi_*\OO_X)_{\varphi(p)} &\to& \OO_{X,p} \\
		{[(D(f),s/f^n)]} &\mapsto& \left[(D(f),s|_{X_f}\cdot(f|_{X_f})^{-n})\right] &\mapsto& \left[(X_f,s|_{X_f}\cdot(f|_{X_f})^{-n})\right]
	\end{array}\]
	is a map of local rings; notably, we are using \autoref{lem:stalkbybase} to define the stalk on the distinguished base. Well, $[(D(f),s/f^n)]\in\mf m_{\varphi(p)}$ implies $s\in\varphi(p)$, so $s|_p\in\mf m_p$, so $\left[(X_f,s|_{X_f}\cdot(f|_{X_f})^{-n})\right]\in\mf m_p$. Thus, we have indeed defined a morphism $\varepsilon_{X,\OO_X}\coloneqq(\varphi,\varphi^\sharp)$.

	It remains to check naturality. Fix a morphism $(\pi,\pi^\sharp)\colon(X,\OO_X)\to(Y,\OO_Y)$, and we need the diagram
	% https://q.uiver.app/?q=WzAsNCxbMCwwLCIoWCxcXE9PX1gpIl0sWzEsMCwiKFxcU3BlY1xcT09fWChYKSxcXE9PX3tcXFNwZWNcXE9PX1goWCl9KSJdLFsxLDEsIihcXFNwZWNcXE9PX1koWSksXFxPT197XFxTcGVjXFxPT19ZKFkpfSkiXSxbMCwxLCIoWSxcXE9PX1kpIl0sWzAsMywiKFxccGksXFxwaV5cXHNoYXJwKSIsMl0sWzEsMiwiXFxTcGVjXFxHYW1tYShcXHBpLFxccGleXFxzaGFycCkiXSxbMCwxLCJcXGV0YV97KFgsXFxPT19YKX0iXSxbMywyLCJcXGV0YV97KFksXFxPT19ZKX0iXV0=&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}
		{(X,\OO_X)} & {(\Spec\OO_X(X),\OO_{\Spec\OO_X(X)})} \\
		{(Y,\OO_Y)} & {(\Spec\OO_Y(Y),\OO_{\Spec\OO_Y(Y)})}
		\arrow["{(\pi,\pi^\sharp)}"', from=1-1, to=2-1]
		\arrow["{\Spec\Gamma(\pi,\pi^\sharp)}", from=1-2, to=2-2]
		\arrow["{\eta_{(X,\OO_X)}}", from=1-1, to=1-2]
		\arrow["{\eta_{(Y,\OO_Y)}}", from=2-1, to=2-2]
	\end{tikzcd}\]
	to commute. For brevity, let $f\colon\OO_Y(Y)\to\OO_X(X)$ be $\Gamma(\pi,\pi^\sharp)=\pi^\sharp_Y$ and $(\varpi,\varpi^\sharp)\coloneqq\Spec f$. We also set $(\alpha,\alpha^\sharp)\coloneqq\eta_{(X,\OO_X)}$ and $(\beta,\beta^\sharp)\coloneqq\eta_{(Y,\OO_Y)}$.
	There are now two checks.
	\begin{itemize}
		\item On topological spaces, we want the diagram
		% https://q.uiver.app/?q=WzAsOCxbMCwwLCJYIl0sWzEsMCwiXFxTcGVjXFxPT19YIl0sWzAsMSwiWSJdLFsxLDEsIlxcU3BlY1xcT09fWSJdLFsyLDAsInAiXSxbMywwLCJcXHtmOmZ8X3BcXGluXFxtZiBtX3BcXH0iXSxbMiwxLCJcXHBpKHApIl0sWzMsMSwiXFx7ZzpnfF97XFxwaShwKX1cXGluXFxtZiBtX3tcXHBpKHApfVxcfSJdLFswLDEsIlxcYWxwaGEiXSxbMCwyLCJcXHBpIiwyXSxbMiwzLCJcXGJldGEiXSxbMSwzLCJcXHZhcnBpIl0sWzQsNSwiIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dLFs0LDYsIiIsMix7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XSxbNiw3LCIiLDIseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtYXBzIHRvIn19fV1d&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
		\[\begin{tikzcd}
			X & {\Spec\OO_X} & p & {\ker(\OO_X(X)\to\mf m_p)} \\
			Y & {\Spec\OO_Y} & {\pi(p)} & {\ker(\OO_Y(Y)\to\mf m_{\pi(p)})}
			\arrow["\alpha", from=1-1, to=1-2]
			\arrow["\pi"', from=1-1, to=2-1]
			\arrow["\beta", from=2-1, to=2-2]
			\arrow["\varpi", from=1-2, to=2-2]
			\arrow[maps to, from=1-3, to=1-4]
			\arrow[maps to, from=1-3, to=2-3]
			\arrow[maps to, from=2-3, to=2-4]
		\end{tikzcd}\]
		to commute. Now, we need to compute $\varpi(\{r:r|_p\in\mf m_p\})$, which is $f^{-1}(\{r:r|_p\in\mf m_p\})$, which is
		\[\varpi(\{r:r|_p\in\mf m_p\})=f^{-1}(\{r:r|_p\in\mf m_p\})=\left\{s:\pi^\sharp_Y(s)|_p\in\mf m_p\right\}.\]
		However, because $\pi^\sharp$ assembles into a morphism of locally ringed spaces, $\pi^\sharp_Y(s)|_p\in\mf m_p$ is equivalent to $s|_{\pi(p)}\in\mf m_{\pi(p)}$. This finishes our check.
		\item On sheaves, we want the diagram
		% https://q.uiver.app/?q=WzAsNCxbMCwwLCJcXE9PX3tcXFNwZWNcXE9PX1koWSl9Il0sWzEsMCwiXFxiZXRhXypcXE9PX1kiXSxbMCwxLCJcXHZhcnBpXypcXE9PX3tcXFNwZWNcXE9PX1goWCl9Il0sWzEsMSwiXFx2YXJwaV8qXFxhbHBoYV8qXFxPT19YIl0sWzAsMiwiXFx2YXJwaV5cXHNoYXJwIiwyXSxbMSwzLCJcXGJldGFfKlxccGleXFxzaGFycCJdLFswLDEsIlxcYmV0YV5cXHNoYXJwIl0sWzIsMywiXFx2YXJwaV8qXFxhbHBoYV5cXHNoYXJwIl1d&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
		\[\begin{tikzcd}
			{\OO_{\Spec\OO_Y(Y)}} & {\beta_*\OO_Y} \\
			{\varpi_*\OO_{\Spec\OO_X(X)}} & {\varpi_*\alpha_*\OO_X}
			\arrow["{\varpi^\sharp}"', from=1-1, to=2-1]
			\arrow["{\beta_*\pi^\sharp}", from=1-2, to=2-2]
			\arrow["{\beta^\sharp}", from=1-1, to=1-2]
			\arrow["{\varpi_*\alpha^\sharp}", from=2-1, to=2-2]
		\end{tikzcd}\]
		to commute. We will show this on the distinguished open base, which is enough by \autoref{lem:morphismonbase}. Fix some $b\in\OO_Y(Y)$. Note $\mf q\in\varpi^{-1}(D(b))$ if and only if $f^{-1}\mf q\in D(b)$ if and only if $b\notin f^{-1}\mf q$ if and only if $f(b)\notin\mf q$ if and only if $\mf q\in D(f(b))$. Thus, tracking the diagram around, we are looking at
		% https://q.uiver.app/?q=WzAsNCxbMCwwLCJcXE9PX3tcXFNwZWNcXE9PX1koWSl9KEQoYikpIl0sWzEsMCwiXFxPT19ZKFlfYikiXSxbMCwxLCJcXE9PX3tcXFNwZWNcXE9PX1goWCl9KEQoZihiKSkpIl0sWzEsMSwiXFxPT19YKFhfe2YoYil9KSJdLFswLDIsIlxcdmFycGleXFxzaGFycF97RChiKX0iLDJdLFsxLDMsIlxccGleXFxzaGFycF97WV9ifSJdLFswLDEsIlxcYmV0YV5cXHNoYXJwX3tEKGIpfSJdLFsyLDMsIlxcYWxwaGFeXFxzaGFycF97RChmKGIpKX0iXV0=&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
		\[\begin{tikzcd}
			{\OO_{\Spec\OO_Y(Y)}(D(b))} & {\OO_Y(Y_b)} \\
			{\OO_{\Spec\OO_X(X)}(D(f(b)))} & {\OO_X(X_{f(b)})}
			\arrow["{\varpi^\sharp_{D(b)}}"', from=1-1, to=2-1]
			\arrow["{\pi^\sharp_{Y_b}}", from=1-2, to=2-2]
			\arrow["{\beta^\sharp_{D(b)}}", from=1-1, to=1-2]
			\arrow["{\alpha^\sharp_{D(f(b))}}", from=2-1, to=2-2]
		\end{tikzcd}\]
		where we have used the computations of $\alpha^\sharp$ and $\beta^\sharp$ in their constructions on the distinguished base. Beginning to unravel our definitions, we note $\varpi^\sharp_{D(b)}$ is the map $\OO_Y(Y)_b\to\OO_X(X)_{f(b)}$ coming from localizing $\pi^\sharp_Y$. So we see that the diagram
		% https://q.uiver.app/?q=WzAsOCxbMCwwLCJcXE9PX1koWSlfYiJdLFsxLDAsIlxcT09fWShZX2IpIl0sWzAsMSwiXFxPT19YKFgpX3tcXHBpXlxcc2hhcnBfWShiKX0iXSxbMSwxLCJcXE9PX1goWF97ZihiKX0pIl0sWzIsMCwici9iXm4iXSxbMywwLCJyfF97RChiKX1cXGNkb3QoYnxfe0QoYil9KV57LW59Il0sWzIsMSwiXFxwaV5cXHNoYXJwX1kocikvXFxwaV5cXHNoYXJwX1koYilebiJdLFszLDEsIlxccGleXFxzaGFycF9ZKHIpfF97RChmKGIpKX1cXGNkb3QoXFxwaV5cXHNoYXJwX1koYil8X3tEKGYoYikpfSleey1ufSJdLFswLDIsIlxcdmFycGleXFxzaGFycF97RChiKX0iLDJdLFsxLDMsIlxccGleXFxzaGFycF97WV9ifSJdLFswLDEsIlxcYmV0YV5cXHNoYXJwX3tEKGIpfSJdLFsyLDMsIlxcYWxwaGFeXFxzaGFycF97RChmKGIpKX0iXSxbNCw1LCIiLDIseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtYXBzIHRvIn19fV0sWzUsNywiIiwyLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dLFs0LDYsIiIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XSxbNiw3LCIiLDAseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtYXBzIHRvIn19fV1d&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
		\[\begin{tikzcd}
			{\OO_Y(Y)_b} & {\OO_Y(Y_b)} & {r/b^n} & {r|_{D(b)}\cdot(b|_{D(b)})^{-n}} \\
			{\OO_X(X)_{\pi^\sharp_Y(b)}} & {\OO_X(X_{f(b)})} & {\pi^\sharp_Y(r)/\pi^\sharp_Y(b)^n} & {\pi^\sharp_Y(r)|_{D(f(b))}\cdot(\pi^\sharp_Y(b)|_{D(f(b))})^{-n}}
			\arrow["{\varpi^\sharp_{D(b)}}"', from=1-1, to=2-1]
			\arrow["{\pi^\sharp_{Y_b}}", from=1-2, to=2-2]
			\arrow["{\beta^\sharp_{D(b)}}", from=1-1, to=1-2]
			\arrow["{\alpha^\sharp_{D(f(b))}}", from=2-1, to=2-2]
			\arrow[maps to, from=1-3, to=1-4]
			\arrow[maps to, from=1-4, to=2-4]
			\arrow[maps to, from=1-3, to=2-3]
			\arrow[maps to, from=2-3, to=2-4]
		\end{tikzcd}\]
		commutes, which finishes this check.
		\qedhere
	\end{itemize}
\end{proof}
We are now ready to show the main result.
\begin{theorem} \label{thm:biggeoisalgopp}
	Given a locally ringed space $(X,\OO_X)$ and a ring $A$, there is a natural bijection
	\[\arraycolsep=1.4pt\begin{array}{ccccc}
		\op{Hom}((X,\OO_X),(\Spec A,\OO_{\Spec A})) &\simeq& \op{Hom}(A,\OO_X(X)) \\
		(\varphi,\varphi^\sharp) &\mapsto& A=\OO_{\Spec A}(A)\to\OO_X(X) \\
		(X,\OO_X)\to(\Spec\OO_X(X),\OO_{\Spec\OO_X(X)})\stackrel{\Spec f}\to(\Spec A,\OO_{\Spec A}) &\mapsfrom& f
	\end{array}\]
	where we are using the natural maps constructed in \autoref{lem:gammaspec} and \autoref{lem:specgamma}.
\end{theorem}
\begin{proof}
	Naturality will follow easily from what we've already done as soon as we show that these are inverses. We have two checks.
	\begin{itemize}
		\item Beginning with a ring homomorphism $f\colon A\to\OO_X(X)$, for brevity set $(\varphi,\varphi^\sharp)\coloneqq\Spec f$ and $\varepsilon_X=(\psi,\psi^\sharp)$. Now, we are studying the composite
		\[(X,\OO_X)\stackrel{(\psi,\psi^\sharp)}\to(\Spec\OO_X(X),\OO_{\Spec\OO_X(X)})\stackrel{(\varphi,\varphi^\sharp)}\to(\Spec A,\OO_{\Spec A}).\]
		We are interested in what this composite looks like on global sections. On sheaves, we are looking at
		\[\OO_{\Spec A}\stackrel{\varphi^\sharp}\to\varphi_*\OO_{\Spec\OO_X(X)}\stackrel{\varphi_*\psi^\sharp}\to\varphi_*\psi_*\OO_X.\]
		However, on global sections, this simplifies to
		\[\underbrace{\OO_{\Spec A}(\Spec A)}_A\stackrel{\varphi^\sharp_{D(1)}}\to\underbrace{\OO_{\Spec\OO_X(X)}(\Spec\OO_X(X))}_{\OO_X(X)}\stackrel{\psi^\sharp_{D(1)}}\to\OO_X(X).\]
		Expanding out our definitions, $\varphi^\sharp_{D(1)}$ is supposed to be $f$ localized at $1$, but this is just $f$; also, $\psi^\sharp_{D(1)}$ is supposed to be some localized restriction map, but it is just the identity. So indeed, our composite is $f$.

		\item Begin with a morphism of locally ringed spaces $(\pi,\pi^\sharp)\colon(X,\OO_X)\to(\Spec A,\OO_{\Spec A})$. Under $\Gamma$, this gives rise to the ring homomorphism $\pi^\sharp_{\Spec A}\colon A\to\OO_X(X)$; set $f\coloneqq\pi^\sharp_{\Spec A}$ and $(\varphi,\varphi^\sharp)=\Spec f$. Going backward, we label our natural map by $\varepsilon_{(X,\OO_X)}$ by $(\alpha,\alpha^\sharp)\colon(X,\OO_X)\to(\Spec\OO_X(X),\OO_{\Spec\OO_X(X)})$, and we want to show that $(\pi,\pi^\sharp)$ agrees with the composite
		\[(X,\OO_X)\stackrel{(\alpha,\alpha^\sharp)}\to(\Spec\OO_X(X),\OO_{\Spec\OO_X(X)})\stackrel{(\varphi,\varphi^\sharp)}\to(\Spec A,\OO_{\Spec A}).\]
		As before, there are two checks.
		\begin{itemize}
			\item On topological spaces, we want the diagram
			% https://q.uiver.app/?q=WzAsNixbMCwwLCJYIl0sWzEsMCwiXFxTcGVjXFxPT19YKFgpIl0sWzEsMSwiXFxTcGVjIEEiXSxbMiwwLCJwIl0sWzMsMCwiXFxrZXIoXFxPT19YKFgpXFx0b1xcbWYgbV9wKSJdLFszLDEsIlxccGkocCkiXSxbMCwyLCJcXHBpIiwyXSxbMSwyLCJcXHZhcnBoaSJdLFswLDEsIlxcYWxwaGEiXSxbMyw0LCIiLDAseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtYXBzIHRvIn19fV0sWzMsNSwiIiwyLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dXQ==&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
			\[\begin{tikzcd}
				X & {\Spec\OO_X(X)} & p & {\ker(\OO_X(X)\to\mf m_p)} \\
				& {\Spec A} && {\pi(p)}
				\arrow["\pi"', from=1-1, to=2-2]
				\arrow["\varphi", from=1-2, to=2-2]
				\arrow["\alpha", from=1-1, to=1-2]
				\arrow[maps to, from=1-3, to=1-4]
				\arrow[maps to, from=1-3, to=2-4]
			\end{tikzcd}\]
			to commute. As such, recalling $\varphi$ is given by $f^{-1}$, we compute
			\begin{align*}
				f^{-1}(\ker(\OO_X(X)\to\mf m_p)) &= f^{-1}(\{r\in\OO_X(X):r|_p\in\mf m_p\}) \\
				&= \{a\in A:f(a)|_p\in\mf m_p\} \\
				&= \{a\in A:\pi^\sharp_{\Spec A}(a)|_p\in\mf m_p\}.
			\end{align*}
			However, $(\pi,\pi^\sharp)$ being a morphism of locally ringed spaces says that $\pi^\sharp_{\Spec A}(a)|_p\in\mf m_p$ is equivalent to $a|_{\pi(p)}\in\mf m_{\pi(p)}$.
			
			Now, for a prime $\mf p\in\Spec A$, we have $a|_{\mf p}\in\mf m_{\mf p}=\mf pA_\mf p$ if and only if $fa\in\mf p$ for some $f\notin\mf p$, which is equivalent to $a\in\mf p$. Thus, we do indeed get out $\pi(p)$ from the above computation, as needed.

			\item On sheaves, we want the diagram
			% https://q.uiver.app/?q=WzAsMyxbMCwwLCJcXE9PX3tcXFNwZWMgQX0iXSxbMSwxLCJcXHBpXypcXE9PX1giXSxbMSwwLCJcXHZhcnBoaV8qXFxPT197XFxTcGVjXFxPT19YKFgpfSJdLFswLDEsIlxccGleXFxzaGFycCIsMl0sWzAsMiwiXFx2YXJwaGleXFxzaGFycCJdLFsyLDEsIlxcYWxwaGFeXFxzaGFycCJdXQ==&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
			\[\begin{tikzcd}
				{\OO_{\Spec A}} & {\varphi_*\OO_{\Spec\OO_X(X)}} \\
				& {\pi_*\OO_X}
				\arrow["{\pi^\sharp}"', from=1-1, to=2-2]
				\arrow["{\varphi^\sharp}", from=1-1, to=1-2]
				\arrow["{\varphi_*\alpha^\sharp}", from=1-2, to=2-2]
			\end{tikzcd}\]
			to commute, which at least see makes sense from the above topological check. By \autoref{lem:morphismonbase}, it suffices to check this on the distinguished base of $\Spec A$, so fix some $a\in A$. Plugging in $D(a)$, we want the diagram
			% https://q.uiver.app/?q=WzAsMyxbMCwwLCJcXE9PX3tcXFNwZWMgQX0oRChhKSkiXSxbMSwxLCJcXHBpXypcXE9PX1goRChhKSkiXSxbMSwwLCJcXHZhcnBoaV8qXFxPT197XFxTcGVjXFxPT19YKFgpfShEKGEpKSJdLFswLDEsIlxccGleXFxzaGFycF97RChhKX0iLDJdLFswLDIsIlxcdmFycGhpXlxcc2hhcnBfe0QoYSl9Il0sWzIsMSwiKFxcdmFycGhpXypcXGFscGhhXlxcc2hhcnApX3tEKGEpfSJdXQ==&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
			\[\begin{tikzcd}
				{\OO_{\Spec A}(D(a))} & {\varphi_*\OO_{\Spec\OO_X(X)}(D(a))} \\
				& {\pi_*\OO_X(D(a))}
				\arrow["{\pi^\sharp_{D(a)}}"', from=1-1, to=2-2]
				\arrow["{\varphi^\sharp_{D(a)}}", from=1-1, to=1-2]
				\arrow["{(\varphi_*\alpha^\sharp)_{D(a)}}", from=1-2, to=2-2]
			\end{tikzcd}\]
			to commute. Recalling the computations from \autoref{lem:spec}, we see that $\varphi^{-1}(D(a))=D(f(a))$, and the map $\varphi^\sharp_{D(a)}\colon A_a\to\OO_X(X)_{f(a)}$ is induced by localizing $f$. Similarly, the definition of $\alpha^\sharp$ says that $(\varphi_*\alpha^\sharp)_{D(a)}=\alpha^\sharp_{D(f(a))}$ is the localization of the restriction map $\OO_X(X)\to\OO_X(X_{f(a)})$. So we are staring at the diagram
			% https://q.uiver.app/?q=WzAsMyxbMCwwLCJBX2EiXSxbMSwxLCJcXE9PX1goWF97ZihhKX0pIl0sWzEsMCwiXFxPT19YKFgpX3tmKGEpfSJdLFswLDEsIlxccGleXFxzaGFycF97RChhKX0iLDJdLFswLDIsImYiXSxbMiwxLCJcXG9we3Jlc31fe1gsWF97ZihhKX19Il1d&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
			\[\begin{tikzcd}
				{A_a} & {\OO_X(X)_{f(a)}} \\
				& {\OO_X(X_{f(a)})}
				\arrow["{\pi^\sharp_{D(a)}}"', from=1-1, to=2-2]
				\arrow["f", from=1-1, to=1-2]
				\arrow["{\op{res}_{X,X_{f(a)}}}", from=1-2, to=2-2]
			\end{tikzcd}\]
			which commutes because $f=\pi^\sharp_{\Spec A}$. Indeed, this triangle is the localization of the diagram
			% https://q.uiver.app/?q=WzAsNCxbMCwwLCJcXE9PX3tcXFNwZWMgQX0oXFxTcGVjIEEpIl0sWzEsMCwiXFxPT19YKFgpIl0sWzAsMSwiXFxPT197XFxTcGVjIEF9KEQoYSkpIl0sWzEsMSwiXFxPT19YKFhfe1xccGleXFxzaGFycF97XFxTcGVjIEF9KGEpfSkiXSxbMCwxLCJcXHBpXlxcc2hhcnBfe1xcU3BlYyBBfSJdLFsxLDMsIlxcb3B7cmVzfV97WCxYX3tcXHBpXlxcc2hhcnBfe1xcU3BlYyBBfShhKX19Il0sWzAsMiwiXFxvcHtyZXN9X3tcXFNwZWMgQSxEKGEpfSIsMl0sWzIsMywiXFxwaV5cXHNoYXJwX3tEKGEpfSJdXQ==&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
			\[\begin{tikzcd}
				{\OO_{\Spec A}(\Spec A)} & {\OO_X(X)} \\
				{\OO_{\Spec A}(D(a))} & {\OO_X(X_{\pi^\sharp_{\Spec A}(a)})}
				\arrow["{\pi^\sharp_{\Spec A}}", from=1-1, to=1-2]
				\arrow["{\op{res}_{X,X_{\pi^\sharp_{\Spec A}(a)}}}", from=1-2, to=2-2]
				\arrow["{\op{res}_{\Spec A,D(a)}}"', from=1-1, to=2-1]
				\arrow["{\pi^\sharp_{D(a)}}", from=2-1, to=2-2]
			\end{tikzcd}\]
			at $a\in A$.
		\end{itemize}
	\end{itemize}
	The above checks show that we have defined inverse morphisms. There are two naturality checks.
	\begin{itemize}
		\item Given a ring homomorphism $h\colon B\to A$, we see that the diagram
		% https://q.uiver.app/?q=WzAsOCxbMCwwLCJcXG9we0hvbX0oKFgsXFxPT19YKSwoXFxTcGVjIEEsXFxPT197XFxTcGVjIEF9KSkiXSxbMSwwLCJcXG9we0hvbX0oQSxcXE9PX1goWCkpIl0sWzEsMSwiXFxvcHtIb219KEIsXFxPT19YKFgpKSJdLFszLDAsImYiXSxbMywxLCJmXFxjaXJjIGgiXSxbMiwwLCJcXFNwZWMgZlxcY2lyY1xcZXRhX3soWCxcXE9PX1gpfSJdLFsyLDEsIlxcU3BlYyAoZlxcY2lyYyBoKVxcY2lyY1xcZXRhX3soWCxcXE9PX1gpfSJdLFswLDEsIlxcb3B7SG9tfSgoWCxcXE9PX1gpLChcXFNwZWMgQixcXE9PX3tcXFNwZWMgQn0pKSJdLFsxLDIsIi1cXGNpcmMgaCJdLFszLDUsIiIsMSx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XSxbMyw0LCIiLDEseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtYXBzIHRvIn19fV0sWzQsNiwiIiwxLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dLFs1LDYsIiIsMSx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XSxbMCw3LCJcXFNwZWMgaFxcY2lyYy0iXSxbMCwxLCJcXHNpbWVxIiwzLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoibm9uZSJ9LCJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzcsMiwiXFxzaW1lcSIsMyx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6Im5vbmUifSwiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dXQ==&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
		\[\begin{tikzcd}[column sep=small]
			{\op{Hom}((X,\OO_X),(\Spec A,\OO_{\Spec A}))} & {\op{Hom}(A,\OO_X(X))} & {\Spec f\circ\varepsilon_{(X,\OO_X)}} & f \\
			{\op{Hom}((X,\OO_X),(\Spec B,\OO_{\Spec B}))} & {\op{Hom}(B,\OO_X(X))} & {\Spec (f\circ h)\circ\varepsilon_{(X,\OO_X)}} & {f\circ h}
			\arrow["{-\circ h}", from=1-2, to=2-2]
			\arrow[maps to, from=1-4, to=1-3]
			\arrow[maps to, from=1-4, to=2-4]
			\arrow[maps to, from=2-4, to=2-3]
			\arrow[maps to, from=1-3, to=2-3]
			\arrow["{\Spec h\circ-}", from=1-1, to=2-1]
			\arrow["\simeq"{marking}, draw=none, from=1-1, to=1-2]
			\arrow["\simeq"{marking}, draw=none, from=2-1, to=2-2]
		\end{tikzcd}\]
		commutes.
		\item Given a scheme morphism $(\pi,\pi^\sharp)\colon(Y,\OO_Y)\to(X,\OO_X)$, we see that the diagram
		% https://q.uiver.app/?q=WzAsOCxbMCwwLCJcXG9we0hvbX0oKFgsXFxPT19YKSwoXFxTcGVjIEEsXFxPT197XFxTcGVjIEF9KSkiXSxbMSwwLCJcXG9we0hvbX0oQSxcXE9PX1goWCkpIl0sWzEsMSwiXFxvcHtIb219KEEsXFxPT19YKFkpKSJdLFszLDAsIlxcR2FtbWEoKFxcdmFycGhpLFxcdmFycGhpXlxcc2hhcnApKSJdLFszLDEsIlxcR2FtbWEoKFxcdmFycGhpLFxcdmFycGhpXlxcc2hhcnApXFxjaXJjKFxccGksXFxwaV5cXHNoYXJwKSkiXSxbMiwwLCIoXFx2YXJwaGksXFx2YXJwaGleXFxzaGFycCkiXSxbMiwxLCIoXFx2YXJwaGksXFx2YXJwaGleXFxzaGFycClcXGNpcmMoXFxwaSxcXHBpXlxcc2hhcnApIl0sWzAsMSwiXFxvcHtIb219KChZLFxcT09fWSksKFxcU3BlYyBBLFxcT09fe1xcU3BlYyBBfSkpIl0sWzEsMiwiXFxHYW1tYSgoXFxwaSxcXHBpXlxcc2hhcnApKVxcY2lyYy0iXSxbNSwzLCIiLDEseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtYXBzIHRvIn19fV0sWzMsNCwiIiwxLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dLFs2LDQsIiIsMSx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XSxbNSw2LCIiLDEseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtYXBzIHRvIn19fV0sWzAsNywiLVxcY2lyYyhcXHBpLFxccGleXFxzaGFycCkiXSxbMCwxLCJcXHNpbWVxIiwzLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoibm9uZSJ9LCJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzcsMiwiXFxzaW1lcSIsMyx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6Im5vbmUifSwiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dXQ==&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
		\[\begin{tikzcd}[column sep=small]
			{\op{Hom}((X,\OO_X),(\Spec A,\OO_{\Spec A}))} & {\op{Hom}(A,\OO_X(X))} & {(\varphi,\varphi^\sharp)} & {\Gamma((\varphi,\varphi^\sharp))} \\
			{\op{Hom}((Y,\OO_Y),(\Spec A,\OO_{\Spec A}))} & {\op{Hom}(A,\OO_X(Y))} & {(\varphi,\varphi^\sharp)\circ(\pi,\pi^\sharp)} & {\Gamma((\varphi,\varphi^\sharp)\circ(\pi,\pi^\sharp))}
			\arrow["{\Gamma((\pi,\pi^\sharp))\circ-}", from=1-2, to=2-2]
			\arrow[maps to, from=1-3, to=1-4]
			\arrow[maps to, from=1-4, to=2-4]
			\arrow[maps to, from=2-3, to=2-4]
			\arrow[maps to, from=1-3, to=2-3]
			\arrow["{-\circ(\pi,\pi^\sharp)}", from=1-1, to=2-1]
			\arrow["\simeq"{marking}, draw=none, from=1-1, to=1-2]
			\arrow["\simeq"{marking}, draw=none, from=2-1, to=2-2]
		\end{tikzcd}\]
		commutes.
	\end{itemize}
	The above checks complete the proof.
\end{proof}
\begin{remark}
	The asymmetry of \autoref{thm:biggeoisalgopp} (namely, we can only map out of general schemes) is intentionally. Indeed, it will turn out that control over maps out of an affine scheme to a particular scheme $(X,\OO_X)$ is enough information to fully recover the scheme $(X,\OO_X)$; one can get a feel from this because maps from $(\Spec,\OO_{\Spec K})$ reads off all $K$-points of $(X,\OO_X)$.
\end{remark}
As a nice consequence, we get a pretty nice check for a scheme to be affine.
\begin{corollary} \label{cor:the-affine-iso}
	If $(X,\OO_X)$ is an affine scheme, then the map $\varepsilon_X\colon(X,\OO_X)\to(\OO_X(X),\OO_{\Spec\OO_X(X)})$ of \autoref{lem:specgamma} is an isomorphism.
\end{corollary}
\begin{proof}
	Because $(X,\OO_X)$ is affine, there is some ring $A$ with an isomorphism $(\varphi,\varphi^\sharp)\colon(\Spec A,\OO_{\Spec A})\cong(X,\OO_X)$. However, on global sections, we see are granted an isomorphism
	\[\Gamma((\varphi,\varphi^\sharp))\colon\OO_X(X)\to A.\]
	Set $f\coloneqq\Gamma((\varphi,\varphi^\sharp))$, so applying $\Spec$ gives us the composite
	\[(X,\OO_X){(\varphi,\varphi^\sharp)^{-1}}\cong(\Spec A,\OO_{\Spec A})\stackrel{\Spec f}\cong(\Spec\OO_X(X),\OO_{\Spec\OO_X(X)}),\]
	which on global sections behaves as
	\[\OO_X(X)\stackrel{(\varphi^\sharp_{\Spec A})^{-1}}\cong\OO_{\Spec A}(A)=A\stackrel f\cong\OO_X(X),\]
	where this composite is just the identity by definition.

	Thus, we have induced an isomorphism $(X,\OO_X)\cong(\Spec\OO_X(X),\OO_{\Spec\OO_X(X)})$ which is the identity on global sections. Applying \autoref{thm:biggeoisalgopp}, we see that $\Spec$ of the identity is still the identity, so this morphism is just given by $\varepsilon_X$.
\end{proof}
It's also fairly easily to see the final object in the category of schemes now.
\begin{corollary} \label{cor:spec-z-final}
	Fix a locally ringed space $(X,\OO_X)$. Then there is a unique scheme map $(X,\OO_X)\to(\Spec\ZZ,\OO_{\Spec\ZZ})$.
\end{corollary}
\begin{proof}
	Using the adjunction, we note that
	\[\op{Hom}((X,\OO_X),(\Spec\ZZ,\OO_{\Spec\ZZ}))\simeq\op{Hom}(\ZZ,\OO_X(X)).\]
	However, $\ZZ$ is initial in the category of rings---there is only one ring map from $\ZZ$ to $\OO_X(X)$ by extending $1\mapsto1$. As such, there is only one scheme map $(X,\OO_X)\to(\Spec\ZZ,\OO_{\Spec\ZZ})$.
\end{proof}
And now here is our last result.
\geoisalgopp*
\begin{proof}
	The leftward functor $\Spec$ is essentially surjective by definition of an affine scheme, so it remains to show that $\Spec$ is fully faithful. Namely, we must show
	\[\op{Mor}_{\mathrm{AffSch}}\left((\Spec B,\OO_{\Spec B}),(\Spec A,\OO_{\Spec A})\right)\cong\op{Hom}_{\mathrm{Ring}}(A,B).\]
	Because $\OO_{\Spec B}(\Spec B)=B$, this follows directly from \autoref{thm:biggeoisalgopp}.
	% We define the left and right maps separately.
	% \begin{itemize}
	% 	\item In one direction, suppose we have a ring homomorphism $f^\sharp\colon A\to B$, and we need to recover a morphism of affine schemes. We already have a continuous map $f\coloneqq\Spec f^\sharp$ going $\Spec B\to\Spec A$.
	% 	Additionally, we can extend $f^\sharp$ to be a sheaf morphism $f^\sharp\colon\OO_A\to f_*\OO_B$. It is enough to define this morphism on a base: pick up some open $D(s)\subseteq\Spec A$ so that $\OO_A(D(s))=A_s$. It follows
	% 	\[f_*\OO_B(D(s))=\OO_B\left(f^{-1}(D(s))\right)=\OO_B(D(f^\sharp s))=B_{f^\sharp(s)},\]
	% 	so there is a natural map $f^\sharp(D(s))\colon A_s\to B_{f^\sharp(s)}$. From here, it's not hard to check that this gives a morphism of sheaves on a base.
	% 	Lastly, we need to check that we actually have a morphism of locally ringed spaces. Well, given $\mf p\in\Spec B$, the stalk map turns out to be
	% 	\[f^\sharp_{f(\mf p)}\colon A_{f(\mf p)}\to B_\mf p,\]
	% 	which we can see to be a local ring homomorphism by passing through the maximal ideal $\mf m_{A,f(\mf p)}$ by hand.
	% 	For notation, we define $\Spec f^\sharp$ to be this morphism of local rings $(f,f^\sharp)$.
	% 	\item In the other direction, suppose we have a morphism of affine schemes $(f,f^\sharp)$. Then $f^\sharp$ as a morphism of locally ringed spaces can take global sections to recover a ring homomorphism.
	% \end{itemize}
	% To finish the proof, we have to show that the composition of our two maps is the identity.
	% \begin{itemize}
	% 	\item Starting with a ring homomorphism, extending it to a morphism of affine schemes, and then restricting it back to a ring homomorphism will overall unsurprisingly do nothing.
	% 	\item Suppose we start with $(f,f^\sharp)\colon(\Spec B,\OO_B)\to(\Spec A,\OO_A)$ as a morphism of affine schemes. Taking global sections gives
	% 	\[f^\sharp_{\Spec A}\colon A\to B.\]
	% 	Define $\varphi\coloneqq f^\sharp_{\Spec A}$. We want to show that $\Spec\varphi=(f,f^\sharp)$. Note we are starting with
	% 	\[\varphi\colon\OO_A(\Spec A)\to\OO_B(\Spec B).\]
	% 	Now, fix $\mf p\in\Spec B$ going to some $f(\mf p)\in\Spec A$. Taking stalks everywhere, we see that the diagram
	% 	% https://q.uiver.app/?q=WzAsNCxbMCwwLCJBIl0sWzAsMSwiQV97ZihcXG1mIHApfSJdLFsxLDEsIkJfXFxtZiBwIl0sWzEsMCwiQiJdLFswLDMsIlxcdmFycGhpIl0sWzEsMiwiZl5cXHNoYXJwX3tmKFxcbWYgcCl9Il0sWzAsMV0sWzMsMl1d&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	% 	\[\begin{tikzcd}
	% 		A & B \\
	% 		{A_{f(\mf p)}} & {B_\mf p}
	% 		\arrow["\varphi", from=1-1, to=1-2]
	% 		\arrow["{f^\sharp_{f(\mf p)}}", from=2-1, to=2-2]
	% 		\arrow[from=1-1, to=2-1]
	% 		\arrow[from=1-2, to=2-2]
	% 	\end{tikzcd}\]
	% 	commutes. In particular, we see that $\varphi^{-1}(\mf p)\subseteq f(\mf p)$ by tracking units through the bottom map. On the other hand, $f^\sharp_{f(\mf p)}$ was assumed to be a local ring homomorphism, so actually $\varphi^{-1}(\mf p)=f(\mf p)$ follows. Thus, $\Spec\varphi\colon\Spec B\to\Spec A$ matches with our continuous map $f$!
	% 	It remains to show that $f^\sharp$ agrees with $\Spec\varphi$ as a morphism of sheaves. Well, it suffices to check that these agree on stalks by \autoref{prop:stalkmorphism}. To begin, we note that $\varphi$ on stalks looks like $\varphi^\sharp_{f(\mf p)}$ making the bottom arrow of the diagram
	% 	% https://q.uiver.app/?q=WzAsNCxbMCwwLCJBIl0sWzEsMCwiQiJdLFswLDEsIkFfe2YoXFxtZiBwKX0iXSxbMSwxLCJCX1xcbWYgcCJdLFswLDJdLFswLDEsIlxcdmFycGhpIl0sWzEsM10sWzIsMywiIiwwLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn19fV1d&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	% 	\[\begin{tikzcd}
	% 		A & B \\
	% 		{A_{f(\mf p)}} & {B_\mf p}
	% 		\arrow[from=1-1, to=2-1]
	% 		\arrow["\varphi", from=1-1, to=1-2]
	% 		\arrow[from=1-2, to=2-2]
	% 		\arrow[dashed, from=2-1, to=2-2]
	% 	\end{tikzcd}\]
	% 	commute. But we can also put $f^\sharp_{f(\mf p)}$ here even though this arrow is unique by the universal property of localization. This finishes this check.
	% 	\qedhere
	% \end{itemize}
\end{proof}
\begin{remark}
	In some sense, \autoref{thm:geoisoppalg} is intended to be fact-checking: at the end of the day, we really just want the categorical equivalence and don't care much for its proof.
\end{remark}
We will quickly provide an example that says that we really do need to pay attention to morphisms of locally ringed spaces.
\begin{nex}
	Consider ring homomorphisms $\ZZ_p\to\QQ_p$. Notably, $\Spec\ZZ_p=\{(0),(p)\}$ while $\Spec\QQ_p=\{(0)\}$. From the natural embedding $\iota\colon\ZZ_p\to\QQ_p$, we get a map sending $(0)\mapsto(0)$, and it will not be possible to get a ring homomorphism to send $(0)$ to $(p)$ because this forces $\QQ_p$ to have torsion. Nonetheless, one can upgrade sending $(0)\mapsto(p)$ to a full morphism of sheaves even though it will not be a morphism of locally ringed spaces.
\end{nex}

\subsection{Scheme Examples}
Schemes have a lot of data. Let's try to make it more concrete; we'll be satisfied with just two examples today. We won't be very rigorous because we haven't defined gluing yet.
\begin{remark}
	Today, we are only gluing two things together at a time because we don't want to worry about the ``cocycle condition'' for gluing.
\end{remark}
Our first example is the projective line. Here is the image of our affine cover.
\begin{center}
	\begin{asy}
		unitsize(1.7cm);
		draw(arc((0,0),1,100,360+80));
		draw(arc((0,0),1.2,-80,260));
	\end{asy}
\end{center}
Here is the rigorization of our affine cover.
\begin{ex}[Projective line]
	Let $R$ be a ring. Then we can glue two copies of $\AA^1_R$ (which is $\Spec R[x]$) as subrings of $\Spec R[x,x^{-1}]$. Then we can identify our copies $\Spec R[x,x^{-1}]$ and $\Spec R[y,y^{-1}]$ by sending $x\mapsto y^{-1}$.
\end{ex}
To be rigorous, one should also define our full sheaf on this topological space; this comes from the homework problem explaining how to glue together sheaves.

Here is the image for our next example.
\begin{center}
	\begin{asy}
		unitsize(1cm);
		draw((0,0)--(2,0));
		fill(circle((1,0),0.1), white);
		dot((1,0.1));
		dot((1,-0.1));
	\end{asy}
\end{center}
Here is the rigorization.
\begin{example}[Doubled origin]
	Let $R$ be a ring. Then we can glue two copies of $\AA^1_R$ (which is $\Spec R[x]$) as subrings of $\Spec R[x,x^{-1}]$. Then we can identify our copies $\Spec R[x,x^{-1}]$ and $\Spec R[y,y^{-1}]$ by sending $x\mapsto y$.
\end{example}
\begin{remark}
	Later on, we will add certain adjectives (namely, ``separated'') which disallow the above scheme.
\end{remark}
For our last example, we return to elliptic curves.
\begin{example}
	We build the elliptic curve carved out by $Y^2Z=X^3-Z^3$. Our two affine patches are
	\[\Spec\frac{k[x,y]}{\left(y^2-x^3+1\right)}\qquad\text{and}\qquad\Spec\frac{k[x,z]}{\left(z-x^3+z^3\right)}.\]
	To glue these together, we identify
	\[\Spec\frac{k[x,y,y^{-1}]}{\left(y^2-x^3+1\right)}\qquad\text{and}\qquad\Spec\frac{k[x,z,z^{-1}]}{\left(z-x^3+z^3\right)}\]
	by sending $x\mapsto x/z$ and $y\mapsto z^{-1}$.
\end{example}

\end{document}