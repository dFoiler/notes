% !TEX root = ../notes.tex

\documentclass[../notes.tex]{subfiles}

\begin{document}

\section{September 26}

The second problem set has been graded. I had a few typos.

\subsection{Finiteness Conditions}
We continue our discussion of finiteness properties. Here is our strongest.
\begin{definition}[Finite]
	A scheme morphism $\pi\colon X\to Y$ is \textit{finite} if and only if an affine open subset $\Spec A\cong U\subseteq Y$ makes $\pi^{-1}(U)\cong\Spec B$ also affine in such a way that the induced ring morphism $A\to B$ on global sections makes $B$ a finitely generated $A$-module.
\end{definition}
In particular, being finite includes being affine.
\begin{example}
	Suppose that the ring map $f\colon A\to B$ makes $B$ a finitely generated $A$-module. We will show later that the associated scheme map $\varphi\colon\Spec B\to\Spec A$ is finite.
\end{example}
Here is the weakest.
\begin{definition}[Locally of finite type]
	A scheme morphism $\pi\colon X\to Y$ is \textit{locally of finite type} if and only if an affine open subset $\Spec B\cong U\subseteq Y$ with affine open subset $\Spec A\into\pi^{-1}(U)$ inducing the ring morphism $A\to B$ on global sections makes $B$ a finitely generated $A$-algebra.
\end{definition}
Note that there is a key difference between being finitely generated as a module and an algebra.
\begin{example}
	The inclusion of fields $K\into L$ has $L$ as a finitely generated $K$-module, so the induced map $\Spec L\to\Spec K$ is a finite morphism.
\end{example}
\begin{example}
	The ring $k[x,y]$ is finitely generated as $k$-algebra but not as a $k$-module. Thus, the induced map $\Spec k[x,y]\to\Spec k$ is (locally) of finite type but is not finite.
\end{example}
Lastly, here is our medium-strength morphism.
\begin{definition}[Finite type]
	A scheme morphism $\pi\colon X\to Y$ is of \textit{finite type} if and only if $\pi$ is locally of finite type and quasicompact.
\end{definition}
\begin{remark}
	Of course, being finite implies being of finite type, and being of finite type implies being locally of finite type.
\end{remark}

\subsection{Locally of Finite Type is Reasonable}
We will now run the usual checks on morphisms which are locally of finite type.
\begin{lemma}
	Fix a scheme morphism $\pi\colon X\to Y$ locally of finite type. Then, for any open subsets $U\subseteq X$ and $V\subseteq Y$ contained in $\pi(U)$, the restricted map $\pi|_U\colon U\to V$ is still locally of finite type.
\end{lemma}
\begin{proof}
	Fix affine open subsets $\Spec A\cong V'\subseteq V\subseteq Y$ and $\Spec B\cong U'\subseteq\pi|_U^{-1}(V')\subseteq X$. Notably, we still see that $V'$ is an affine open subscheme of $Y$, and $U'$ is an affine open subscheme of $X$. Thus, because $\pi$ is locally of finite type, we see that $B$ is a finitely generated $A$-algebra.
\end{proof}
The following lemma will find some utility.
\begin{lemma} \label{lem:locally-ft-local-on-source}
	Fix a scheme morphism $\pi\colon X\to Y$, where $Y$ is an affine scheme. Suppose that $X$ has an affine open cover $\mc U$ such that, for each $U\in\mc U$, we have $\OO_X(U)$ is a finitely generated $\OO_Y(Y)$-algebra by $\pi^\sharp$. Then each affine open subset of $X$ has this property.
\end{lemma}
\begin{proof}
	We use the Affine communication lemma. Say that an affine open subset $U\subseteq X$ is \textit{acceptable} if and only if $\OO_X(U)$ is a finitely generated $A$-algebra by $\pi^\sharp$. Here are our checks; set $A\coloneqq\OO_Y(Y)$.
	\begin{listroman}
		\item Suppose $U$ is acceptable and $f\in\OO_X(U)$; we show $U_f$ is acceptable. Well, by hypothesis, we may find finitely many generators $b_1,\ldots,b_n$ generating $\OO_X(U)$ as an $A$-algebra by $\pi^\sharp$. However, $\OO_X(U_f)\simeq\OO_X(U)_f$ is generated over $\OO_X(U)$ as an $\mathcal O_X(U)$-algebra by the generator $1/f$, so it follows that $\OO_X(U_f)$ is generated by $b_1,\ldots,b_n,1/f$ as an $A$-algebra. This is what we wanted.
		\item Suppose an affine open subset $U\subseteq X$ has elements $w_1,\ldots,w_n\in\OO_X(U)$ such that $(w_1,\ldots,w_n)=\OO_X(U)$, and $U_{f_i}$ is acceptable for each $i$. We show that $U$ is acceptable.

		For brevity, set $C\coloneqq\OO_X(U)$. Translating everything over to commutative algebra, we see that we are given $C_{w_k}$ is a finitely generated $A$-algebra for each $k$, and we want to show that $C$ is a finitely generated $A$-algebra. Well, we can find finitely many elements
		\[\left\{c_{k,1}/w_k^{e_{k,1}},\ldots,c_{k,N_k}/w_k^{e_{k,N_k}}\right\}\]
		of $C_{w_k}$ to generate $C_{w_k}$ as an $A$-algebra. However, we can also generate all the above generators by the elements
		\[\left\{c_{k,1},\ldots,c_{k,N_k},1/w_k\right\},\]
		so we will elect to use these generators instead. By artificially adding in $1$s to the end of each $S_k$ without changing the fact we generate, so we may assume that all the $S_k$ have the same size, so set $N\coloneqq N_k$ to be this uniform length.
	
		We will want a few more elements in our generating set. Note that the $D(w_k)$ cover $C$ by construction, so no prime $\mf p\in\Spec C$ contains all the $w_k$, so $(w_1,\ldots,w_m)=C$, so we can find elements $d_{1,1},\ldots,d_{m,1}\in C$ such that
		\[\sum_{k=1}^mw_kd_{k,1}=1.\]
		Taking this equation to the $mM$th power, each term has a power of $w_k^M$ for some $k$ by the pigeonhole principle, so we see that we can write
		\[\sum_{k=1}^mw_k^Md_{k,M}=1,\]
		where each $d_{k,M}$ is some polynomial in the $w_k$ and the $d_{k,1}$.
	
		We now let our set of generators be $S\coloneqq\bigcup_{k=1}^m\{c_{k,1},\ldots,c_{k,N},w_k,d_{k,1}\}$, which is the finite union of finite sets and therefore finite. We claim that $S$ generates $C$ as an $A$-algebra. Indeed, pick up some $c\in C$, and we know that in $C_{w_k}$ we may write
		\[\frac c1=p_k\left(c_{k,1},\ldots,c_{k,N},1/w_k\right)\]
		for some polynomial $p_k\in A[x_1,\ldots,x_{N+1}]$. Collecting denominators, we can find some $M_k$ such that
		\[\frac c1=\frac{q_k(c_{k,1},\ldots,c_{k,N},w_k)}{w_k^{M_k}},\]
		where $q_k\in A[x_1,\ldots,x_{N+1}]$. Thus, there is some $M_k',M_k''$ such that
		\[w_k^{M'_k}c=w_k^{M''_k}q_k(c_{k,1},\ldots,c_{k,N},w_k).\]
		It follows that $w_k^{M'_k}c$ is generated by $S$. Letting $M$ be the maximum over all the $M'_k$, we see that $w_k^Mc$ is still generated by $S$, so each term of
		\[c=\sum_{k=1}^m\left(w_k^Mc\right)d_{k,M}\]
		is still a polynomial with coefficients in $A$ of the terms in $S$. It follows that $c$ is generated by $S$. This is what we wanted.

		\item We have an open cover of acceptable affine open subschemes by hypothesis.
	\end{listroman}
	The above checks complete the proof by \autoref{lem:affine-comm}.
\end{proof}
We now use \autoref{lem:locally-ft-local-on-source} for fun and profit.
\begin{lemma}
	The class of morphisms locally of finite type is preserved by composition.
\end{lemma}
\begin{proof}
	Suppose that we have morphisms $\varphi\colon X\to Y$ and $\psi\colon Y\to Z$ which are locally of finite type. We want to show that the composite $\beta\circ\alpha$ is also locally of finite type.

	Fix some affine open subset $\Spec\OO_Z(U)\simeq U$ of $Z$; set $A\coloneqq\OO_Z(U)$. Pulling back to $\psi^{-1}(U)$, given $\psi^{-1}(U)$ an affine open cover $\{V_\alpha\}_{\alpha\in\lambda}$, where $V_\alpha\simeq\Spec\OO_Y(V_\alpha)$; set $B_\alpha\coloneqq\OO_Y(V_\alpha)$. We are given that the map $\psi^\sharp_\alpha\colon A\to B_\alpha$ on global sections makes $B_\alpha$ into a finitely-generated $A$-algebra.

	Going further, for any affine open subset $W_{\alpha,\beta}\subseteq\varphi^{-1}(V_\alpha)$ will have $\OO_X(W_{\alpha,\beta})$ finitely generated as a $B_\alpha$-algebra by $\varphi^\sharp$, which is finitely generated as an $A$-algebra by $\psi^\sharp$, so it follows that each $\OO_X(W_{\alpha,\beta})$ is finitely generated as an $A$-algebra by $(\psi\circ\varphi)^\sharp$.

	However, we are now done: because the collection of all affine open subschemes $V_\alpha\subseteq\psi^{-1}(U)$ cover the open subscheme $\psi^{-1}(U)$, the collection of all affine open subschemes $W_{\alpha,\beta}\subseteq\varphi^{-1}(V_\alpha)$ for all $\alpha$ will cover the open subscheme $(\psi\circ\varphi)^{-1}(U)$. But each $W_{\alpha,\beta}$ has $\OO_X(W_{\alpha,\beta})$ finitely generated as an $A$-algebra, so \autoref{lem:locally-ft-local-on-source} kicks in to tell us that all affine open subschemes $W\subseteq(\psi\circ\varphi)^{-1}(U)$ have $\OO_X(W)$ finitely generated as an $A$-algebra by $(\psi\circ\varphi)^\sharp$.
\end{proof}
\begin{lemma} \label{lem:locally-ft-affine-local-target}
	The class of morphisms locally of finite type is affine local on the target.
\end{lemma}
\begin{proof}
	Fix a scheme morphism $\pi\colon X\to Y$ and an affine open cover $\{V_\alpha\}_{\alpha\in\lambda}$ such that $\pi|_{\pi^{-1}V_\alpha}\colon\pi^{-1}V_\alpha\to V_\alpha$ is locally of finite type for each $V_\alpha$. We would like to show that $\pi$ is locally of finite type.

	Well, say that an affine open subscheme $V\subseteq Y$ (with $V\cong\Spec\OO_Y(V)$) is ``smallish'' if and only if any affine open subscheme $U\subseteq\pi^{-1}(V)$ makes $\OO_X(U)$ a finitely generated $\OO_Y(V)$-algebra by $\pi^\sharp$. We would like to show that all affine open subscheme of $Y$ are smallish, for which we use \autoref{lem:affine-comm}. Here are our checks.
	\begin{listroman}
		\item Fix a smallish affine open subscheme $V\subseteq Y$ and some $f\in\OO_Y(V)$. We would like to show that $V_f$ is also smallish. Well, find some affine open subscheme $U\subseteq\pi^{-1}(V_f)$. Then $V_f\subseteq V$ means that $U\subseteq\pi^{-1}(V)$, so because $V$ is smallish, we conclude that $\OO_X(U)$ is a finitely generated $\OO_Y(V)$-algebra by $\pi^\sharp$.

		Namely, we have some set finite set of generators $b_1,\ldots,b_n\in\OO_X(U)$ generating $\OO_X(U)$ as an $\mathcal O_Y(V)$-algebra. But then any $b\in\OO_X(U)$ can be written as a polynomial in the $b_i$ with coefficients in $\OO_Y(V)$, so the same polynomial shows that any $b\in\OO_X(U)$ can be written as a polynomial in the $b_i$ with coefficients in $\OO_Y(V_f)\simeq\OO_Y(V)_f$.
		\item Fix an affine open subscheme $V\subseteq Y$ and some elements $(f_1,\ldots,f_n)\subseteq\OO_Y(V)$ generating $\OO_Y(V)$. Given that each $V_{f_i}$ is smallish, we would like to show that $V$ is smallish. For brevity, set $A\coloneqq\OO_Y(V)$.

		At this point, we remark that we may essentially restrict $\pi$ to $\pi|_{\pi^{-1}V}$, though we will not do this.

		Anyway, arguing as before, for any affine open subset $W_{i,\beta}\subseteq\varphi^{-1}(V_{f_i})$ will have $\OO_X(W_{i,\beta})$ finitely generated as an $A_{f_i}$-algebra by $\pi^\sharp$. However, $A_{f_i}\simeq A[1/f_i]$ is certainly finitely generated as an $A$-algebra, so it follows that each $\OO_X(W_{i,\beta})$ is finitely generated as an $A$-algebra by $\pi^\sharp$ as well.

		However, we are now done: because the collection of all affine open subschemes $V_{f_i}\subseteq V$ cover $V$ (because $(f_1,\ldots,f_n)=1$), the collection of all affine open subschemes $W_{i,\beta}\subseteq\varphi^{-1}(V_i)$ for all $i$ will cover the open subscheme $\pi^{-1}(V)$. But each $W_{i,\beta}$ has $\OO_X(W_{i,\beta})$ finitely generated as an $A$-algebra, so \autoref{lem:locally-ft-local-on-source} kicks in to tell us that all affine open subschemes $W\subseteq\pi^{-1}(U)$ have $\OO_X(W)$ finitely generated as an $A$-algebra by $\pi^\sharp$.
		\item Lastly, we see that $Y$ has an affine open cover by smallish affine open subschemes.
	\end{listroman}
	The above checks complete the proof by \autoref{lem:affine-comm}.
\end{proof}
\begin{lemma}
	The class of morphisms locally of finite type is preserved by base change.
\end{lemma}
\begin{proof}
	Arguing as in \autoref{lem:qc-base-change}, suppose we have a pullback square
	% https://q.uiver.app/?q=WzAsNCxbMCwwLCJYXFx0aW1lc19TWSJdLFsxLDAsIlgiXSxbMCwxLCJZIl0sWzEsMSwiUyJdLFsyLDMsIlxccHNpX1kiXSxbMCwxLCJcXHBpX1giXSxbMCwyLCJcXHBpX1kiXSxbMSwzLCJcXHBzaV9YIl0sWzAsMywiIiwyLHsic3R5bGUiOnsibmFtZSI6ImNvcm5lciJ9fV1d&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}
		{X\times_SY} & X \\
		Y & S
		\arrow["{\psi_Y}", from=2-1, to=2-2]
		\arrow["{\pi_X}", from=1-1, to=1-2]
		\arrow["{\pi_Y}", from=1-1, to=2-1]
		\arrow["{\psi_X}", from=1-2, to=2-2]
		\arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-1, to=2-2]
	\end{tikzcd}\]
	of schemes such that $\psi_Y$ is locally of finite type. We would like to show that $\pi_X$ is locally of finite type.

	Once more, we will try to reduce to the affine case. The reduction steps are exactly the same; we will provide them for completeness. Let $\pi_S\coloneqq\psi_Y\circ\pi_Y=\psi_X\circ\pi_X$, for brevity. Give $S$ an affine open cover $\{S_\alpha\}_{\alpha\in\lambda}$. For each $\alpha\in\lambda$, we give $\psi_X^{-1}(S_\alpha)\subseteq X$ an affine open cover $\{X_{\alpha,\beta}\}_{\alpha\in\lambda,\beta\in\kappa_\alpha}$. Then we build the tower
	% https://q.uiver.app/?q=WzAsNixbMCwxLCJcXHBpX1Neey0xfShTX1xcYWxwaGEpIl0sWzEsMSwiXFxwc2lfWF57LTF9KFNfXFxhbHBoYSkiXSxbMCwyLCJcXHBzaV9ZXnstMX0oU19cXGFscGhhKSJdLFsxLDIsIlNfXFxhbHBoYSJdLFsxLDAsIlhfe1xcYWxwaGEsXFxiZXRhfSJdLFswLDAsIlxccGlfWF57LTF9KFhfe1xcYWxwaGEsXFxiZXRhfSkiXSxbMiwzLCJcXHBzaV9ZfF97XFxwc2lfWV57LTF9KFNfXFxhbHBoYSl9IiwyXSxbMCwxLCJcXHBpX1h8X3tcXHBpX1Neey0xfShTX1xcYWxwaGEpfSJdLFswLDIsIlxccGlfWXxfe1xccGlfU157LTF9KFNfXFxhbHBoYSl9Il0sWzEsMywiXFxwc2lfWCJdLFs0LDEsIiIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoidG9wIn19fV0sWzUsNCwiXFxwaV9YfF97XFxwaV9YXnstMX0oWF97XFxhbHBoYSxcXGJldGF9KX0iXSxbNSwwLCIiLDAseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6InRvcCJ9fX1dXQ==&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}
		{\pi_X^{-1}(X_{\alpha,\beta})} & {X_{\alpha,\beta}} \\
		{\pi_S^{-1}(S_\alpha)} & {\psi_X^{-1}(S_\alpha)} \\
		{\psi_Y^{-1}(S_\alpha)} & {S_\alpha}
		\arrow["{\psi_Y|_{\psi_Y^{-1}(S_\alpha)}}"', from=3-1, to=3-2]
		\arrow["{\pi_X|_{\pi_S^{-1}(S_\alpha)}}", from=2-1, to=2-2]
		\arrow["{\pi_Y|_{\pi_S^{-1}(S_\alpha)}}", from=2-1, to=3-1]
		\arrow["{\psi_X}", from=2-2, to=3-2]
		\arrow[hook, from=1-2, to=2-2]
		\arrow["{\pi_X|_{\pi_X^{-1}(X_{\alpha,\beta})}}", from=1-1, to=1-2]
		\arrow[hook, from=1-1, to=2-1]
	\end{tikzcd}\]
	and note that the bottom square is a pullback square by \autoref{lem:fp-open-cover-base}, the top square is a pullback square by \autoref{lem:open-fp}, so the total rectangle is a pullback square by \autoref{lem:smalls-to-big-pullback}. Now, because being quasicompact is affine-local on the target by \autoref{lem:locally-ft-affine-local-target}, it suffices to show that each restricted map $\pi_X|_{\pi_X^{-1}(X_{\alpha,\beta})}$ is quasicompact. Notably, by \autoref{lem:non-affine-qc}, the restriction $\psi_Y|_{\psi_Y^{-1}(S_\alpha)}$ is quasicompact.

	Thus, we fix some $\alpha$ and $\beta$. We now rename our variables, replacing $S_\alpha$ with $S$, $X_{\alpha,\beta}$ with $X$, and $\psi_Y^{-1}(S_\alpha)$ with $Y$, and we rename our morphisms to fit the pullback square
	% https://q.uiver.app/?q=WzAsNCxbMSwxLCJTIl0sWzEsMCwiWCJdLFswLDEsIlkiXSxbMCwwLCJYXFx0aW1lc19TWSJdLFszLDEsIlxccGlfWCJdLFsxLDAsIlxccHNpX1giXSxbMiwwLCJcXHBzaV9ZIl0sWzMsMiwiXFxwaV9ZIiwyXSxbMywwLCIiLDEseyJzdHlsZSI6eyJuYW1lIjoiY29ybmVyIn19XV0=&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}
		{X\times_SY} & X \\
		Y & S
		\arrow["{\pi_X}", from=1-1, to=1-2]
		\arrow["{\psi_X}", from=1-2, to=2-2]
		\arrow["{\psi_Y}", from=2-1, to=2-2]
		\arrow["{\pi_Y}"', from=1-1, to=2-1]
		\arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-1, to=2-2]
	\end{tikzcd}\]
	though we now have both $X$ and $S$ affine. We know that $\psi_Y$ is locally of finite type, and we would like to show that $\pi_X$ is locally of finite type.

	Well, fix an affine open subscheme $U\subseteq X$, and we would like to show that all affine open subschemes $V\subseteq\pi_X^{-1}(U)$ have $\OO_{X\times_SY}(V)$ finitely generated as an $\mathcal O_X(V)$-algebra by $\pi_X^\sharp$. Using \autoref{lem:locally-ft-local-on-source}, it suffices to just give an open cover of such affine open subschemes $V$. Well, note that we have built the tower
	% https://q.uiver.app/?q=WzAsNixbMSwyLCJTIl0sWzEsMSwiWCJdLFswLDIsIlkiXSxbMCwxLCJYXFx0aW1lc19TWSJdLFsxLDAsIlUiXSxbMCwwLCJcXHBpX1heey0xfVUiXSxbMiwwLCJcXHBzaV9ZIl0sWzEsMCwiXFxwc2lfWCJdLFszLDEsIlxccGlfWCJdLFszLDIsIlxccGlfWSJdLFs0LDEsIiIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoidG9wIn19fV0sWzUsMywiIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiaG9vayIsInNpZGUiOiJ0b3AifX19XSxbNSw0LCJcXHBpX1h8X3tcXHBpX1heey0xfVV9Il1d&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}
		{\pi_X^{-1}U} & U \\
		{X\times_SY} & X \\
		Y & S
		\arrow["{\psi_Y}", from=3-1, to=3-2]
		\arrow["{\psi_X}", from=2-2, to=3-2]
		\arrow["{\pi_X}", from=2-1, to=2-2]
		\arrow["{\pi_Y}", from=2-1, to=3-1]
		\arrow[hook, from=1-2, to=2-2]
		\arrow[hook, from=1-1, to=2-1]
		\arrow["{\pi_X|_{\pi_X^{-1}U}}", from=1-1, to=1-2]
	\end{tikzcd}\]
	where once again the bottom square is a pullback square by \autoref{lem:fp-open-cover-base}, the top square is a pullback square by \autoref{lem:open-fp}, so the total rectangle is a pullback square by \autoref{lem:smalls-to-big-pullback}. Thus, we may think about $\pi^{-1}U$ as canonically isomorphic to $U\times_SY$.

	Now, using \autoref{lem:keyfibercase}, we can give $Y$ an affine open cover $Y_\alpha$ so that the affine open schemes $U\times_SY_\alpha$ will manage to cover $U\times_SY$. As such, \autoref{lem:locally-ft-local-on-source} tells us that we would like for each $U\times_SY_\alpha$ to have global sections finitely generated as an $\mathcal O_U(U)$-algebra.

	But now everything is affine! Set $R\coloneqq\OO_S(S)$ and $A_\alpha\coloneqq\OO_Y(Y_\alpha)$ and $B\coloneqq\OO_U(U)$. Then \autoref{lem:affine-fp} tells us that
	\[U\times_SY_\alpha\simeq\Spec B\otimes_RA_\alpha.\]
	Because $A_\alpha$ is finitely generated as an $R$-algebra (by $\psi_Y^\sharp$), we may write $A_\alpha\simeq R[x_1,\ldots,x_n]/I$ for some $n$ and some ideal $I$. Chasing our maps around, we see
	\[B\otimes_RA_\alpha\simeq B\otimes_R\frac{R[x_1,\ldots,x_n]}I\simeq\frac{B[x_1,\ldots,x_n]}{IB},\]
	where the last isomorphism is by $b\otimes r(x_1,\ldots,x_n)\mapsto b\cdot r(x_1,\ldots,x_n)$. Thus, $B\otimes_RA_\alpha$ is a finitely generated $B$-algebra, so we are done.
\end{proof}
There are the usual equivalent conditions.
\begin{lemma}
	Being finite is affine local on the target: a scheme morphism $\pi\colon X\to Y$ is finite if and only if there is an affine open cover $\{U_\alpha\}_{\alpha\in\lambda}$ with $U_\alpha=\Spec B_\alpha$ and $\pi^{-1}(U_\alpha)=\Spec A_i$ in such a way that $A_\alpha$ is finitely generated as a $B_\alpha$-module.
\end{lemma}
\begin{proof}
	Omitted.
\end{proof}
\begin{lemma}
	Being locally of finite type is affine local on the target: a scheme morphism $\pi\colon X\to Y$ is locally of finite type if and only if there is an affine open cover $\{U_\alpha\}_{\alpha\in\lambda}$ with $U_\alpha=\Spec B_i$ such that any affine open subset $\Spec B_i\subseteq\pi^{-1}(U_\alpha)$ in such a way that $A_\alpha$ is finitely generated as a $B_\alpha$-module.
\end{lemma}
\begin{proof}
	Omitted.
\end{proof}
There is a similar result for being locally of finite type by just requiring that the affine open cover of $\pi^{-1}(U_\alpha)$ be finite.
\begin{remark}
	Closed embeddings are of finite type. Namely, on affine schemes, our closed embeddings all look like $\Spec A/I\to\Spec A$, and $A/I$ is finitely generated as an $A$-module.
\end{remark}
\begin{remark}
	Open embeddings are locally of finite type. In particular, the sufficiently local case looks like $\Spec A_f\to\Spec A$, and $A_f$ is finitely generated as an $A$-algebra.
\end{remark}
Here's an example of our finiteness conditions doing their job.
\begin{lemma}
	Fix a finite scheme morphism $(\pi,\pi^\sharp)\colon (X,\OO_X)\to (Y,\OO_Y)$. For any $y\in Y$, the set $\pi^{-1}(\{y\})$ is finite.
\end{lemma}
\begin{proof}
	There are arguments avoiding the fiber product, but let's just go ahead and use it. Let $X_y\coloneqq X\times_Y\{y\}$ so that the topological space of $X_y$ is $\pi^{-1}(\{y\})$. Here is our diagram.
	% https://q.uiver.app/?q=WzAsNCxbMSwwLCJYIl0sWzEsMSwiWSJdLFswLDEsIlxce3lcXH0iXSxbMCwwLCJYX3kiXSxbMywwXSxbMCwxLCJcXHRleHR7ZmluaXRlfSJdLFsyLDEsIiIsMix7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoidG9wIn19fV0sWzMsMl1d&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}
		{X_y} & X \\
		{\{y\}} & Y
		\arrow[from=1-1, to=1-2]
		\arrow["{\text{finite}}", from=1-2, to=2-2]
		\arrow[hook, from=2-1, to=2-2]
		\arrow[from=1-1, to=2-1]
	\end{tikzcd}\]
	Namely, the canonical projection $X_y\to\{y\}$ is finite. Now, we have reduced to the case where $Y=\Spec k(y)$ is a field. It follows because the map $X_y\to\{y\}$ is finite that $X_y=\Spec A$ where $A$ is finitely generated as a $k(y)$-module. Thus, $\dim A=\dim k(y)$, so $A$ is Artinian, so $\Spec A$ is finite.
\end{proof}

\subsection{Integral Morphisms}
The following proof will motivate a definition.
\begin{lemma}
	Fix a finite scheme morphism $(\pi,\pi^\sharp)\colon (X,\OO_X)\to (Y,\OO_Y)$. Then $\pi$ is a closed map of topological spaces.
\end{lemma}
\begin{proof}
	One may work in neighborhoods to reduce to the affine case. TO finish, we take our scheme morphism $\pi\colon\Spec A\to\Spec B$, and we note that the induced map on global sections $\pi^\sharp\colon B\to A$ is an integral ring map (namely, $A$ is integral over $\pi^\sharp(B)$). From here, we claim that
	\[\pi(Z)\stackrel?=V\left((\pi^\sharp)^{-1}(I)\right).\]
	For this, we pick up the following result from commutative algebra.
	\begin{lemma}[Lying over]
		Fix an integral extension of rings $\iota\colon R\to S$. Then each prime $\mf p\in\Spec R$ has some prime $\mf q\in\Spec S$ such that $\mf q\cap R=\mf p$.
	\end{lemma}
	\begin{proof}
		See \cite[\S4.4]{eisenbud-comm-alg}.
	\end{proof}
	The above lemma essentially does the computation for us, upon realizing that $B/(\pi^\sharp)^{-1}(I)\to A/I$ is an integral extension of rings.
\end{proof}
\begin{remark}
	Later in life we will continue to care about the ring of global sections being an integral ring map because this is a fairly common thing to see. For example, $\QQ\into\overline\QQ$ is an integral ring map.
\end{remark}
Observe that the above proof only needed $\pi^\sharp$ to be an integral ring homomorphism, so we make this our definition.
\begin{definition}
	A scheme morphism $\pi\colon X\to Y$ is \textit{integral} if and only if $\pi$ is affine and all affine open $\Spec B\subseteq Y$ has $\Spec A=\pi^{-1}(U)$ such that the induced map $\pi^\sharp\colon B\to A$ an integral ring map.
\end{definition}
We continue working with this definition.
\begin{prop}
	Fix an integral scheme morphism $\pi\colon X\to Y$. Then each closed $Z\subseteq X$ has $\pi(Z)$ closed and $\dim Z=\dim\pi(Z)$.
\end{prop}
\begin{proof}
	That $\pi(Z)$ is closed follows from our previous proof. As usual, we reduce to the affine case, where we have an integral extension of rings $\pi^\sharp\colon R\to S$ (where $\pi(Z)=\Spec R$ and $S=\Spec Z$), and we would like to show that $\dim R=\dim S$.

	For this, we combine two commutative algebra results.
	\begin{lemma}
		Fix an integral extension of rings $R\subseteq S$. If $\mf q_1\subsetneq\mf q_2\subseteq S$ are prime ideals, then their intersections of $R$ are still distinct.
	\end{lemma}
	The above result tells us that $\dim Z\le\dim\pi(Z)$. For the other inequality, we need to be able to go up.
	\begin{lemma}[Going up]
		Fix an integral extension of rings $R\subseteq S$. If there are primes
		\[\mf p_1\subsetneq\mf p_2\subsetneq\cdots\subsetneq\mf p_n\subseteq R,\]
		with a partial lift of $\mf q_i$ such that $\mf q_i\cap R=\mf p_i$ for $1\le i\le m$, then we can extend the chain all the way up to $n$.
	\end{lemma}
	The above result gives us $\pi(Z)\le\dim Z$.
\end{proof}
The point is that integral morphisms are similar to finite ones.

\subsection{Quasifinite Morphisms}
Here is yet another finiteness condition.
\begin{definition}[Quasifinite]
	A scheme morphism $\pi\colon X\to Y$ is \textit{quasifinite} if and only if $\pi$ is of finite type and each $y\in Y$ has $\pi^{-1}(\{y\})$ a finite set.
\end{definition}
\begin{remark}
	We have seen that being finite implies being quasifinite.
\end{remark}
Let's get some practice with the definition.
\begin{lemma}
	If $\pi\colon X\to Y$ is a finite morphism of schemes and $U\subseteq X$ is quasicompact, then the restriction $\pi|_U\colon U\to Y$ is quasifinite.
\end{lemma}
\begin{remark}
	Being quasifinite is stable under composition, base change, and is affine local on the target.
\end{remark}
\begin{remark}
	A morphism is finite if and only if it is quasifinite and integral. We have seen the forward direction.
\end{remark}

\subsection{Chevalley's Theorem}
We close lecture by stating Chevalley's theorem.
\begin{theorem}[Chevalley]
	Fix a scheme morphism $\pi\colon X\to Y$ of finite type. If $C\subseteq X$ is constructible, then $\pi(C)$ is also constructible.
\end{theorem}
Here is the appropriate definition.
\begin{definition}[Constructible]
	Fix a Noetherian topological space $X$. Then a subset $C\subseteq X$ is constructible if and only if it is the union of subsets of the form $U\subseteq V$ where $U\subseteq X$ is open and $V\subseteq X$ is closed.
\end{definition}
There is a different definition on the homework; in particular, the collection of constructible sets
\begin{remark}
	It is somewhat important for constructible sets to be living in a Noetherian topological space. The definition must change otherwise.
\end{remark}

\end{document}