% !TEX root = ../notes.tex

\documentclass[../notes.tex]{subfiles}

\begin{document}

\section{October 12}

We continue our discussion of quasicoherent sheaves.

\subsection{The Category of Quasicoherent Sheaves}
It turns out that, by breaking down a quasicoherent sheaf to a sheaf on a base, one can fully determine a quasicoherent sheaf based off of the data of what it does on affine open subschemes and the restriction maps coming from distinguished open subschemes. Thus, we have the following.
\begin{lemma} \label{lem:localize-is-good}
	Fix a scheme $X$. An $\mathcal O_X$-module $\mc F$ is quasicoherent if and only if any distinguished open subscheme $U_f$ of an affine open subscheme $U\subseteq X$ has the induced map
	\[\mc F(U)_f\to\mc F(U_f)\]
	coming from restriction an isomorphism.
\end{lemma}
\begin{proof}
	Fix any affine open subscheme $U\subseteq X$. We show that $\mc F|_U\cong\widetilde M$ for $M=\mc F(U)$ if and only if the morphisms
	\[\arraycolsep=1.4pt\begin{array}{cccc}
		\op{res}_f\colon& \mc F(U)_f &\to& \mc F(U_f) \\
		& s/f^n &\mapsto& f|_{U_f}^{-n}\cdot s|_{U_f}
	\end{array}\]
	are isomorphisms for any $f\in\OO_X(U)$. To see that this morphism is a well-defined morphism of $\OO_X(U_f)$-modules (here, $\mc F(U)_f$ has the action of $\OO_X(U_f)$ through the isomorphism $\OO_X(U)_f\simeq\OO_X(U_f)$ by \autoref{cor:the-affine-iso}), we note that this is the morphism
	\[\varepsilon_{U_f}\colon\underbrace{\widetilde{\mc F(U)}(U_f)}_{\simeq\mc F(U)_f}\to\mc F(U_f),\]
	from \autoref{lem:geo-opp-alg-2-map}; here, $\widetilde{\mc F(U)}(U_f)\simeq\mc F(U)_f$ by \autoref{rem:concrete-associated-module}. Indeed, tracking $\varepsilon$ through, we see that it sends $s/g$ to $g^{-1}\cdot s|_{U_f}$, which is precisely $\op{res}_f$.
	
	We now proceed with the proof. We have two directions.
	\begin{itemize}
		\item Suppose that $\mc F|_U\cong\widetilde M$ for some $\OO_X(U)$-module $M$. Then \autoref{cor:the-quasicoherent-iso} promises the canonical morphism $\varepsilon\colon\widetilde{\mc F(U)}\to\mc F|_U$ is an isomorphism because $U$ is an affine scheme.
		
		Thus, by \autoref{prop:isoonstalks} each $\varepsilon_{U_f}$ is an isomorphism of abelian groups, and it is already a morphism of $\OO_(U_f)$-morphisms, so in fact $\varepsilon_{U_f}$ is an isomorphism of $\OO_{U_f}$-modules. This finishes.

		\item Conversely, suppose that each $\varepsilon_{U_f}$ is an isomorphism for each $f\in\OO_X(U)$; we show that $\varepsilon$ is an isomorphism of $\OO_X|_U$-modules. Certainly it is a morphism of $\OO_X|_U$-modules by construction of $\varepsilon$, so it remains to show that $\varepsilon$ is an isomorphism of sheaves by \autoref{lem:better-ox-mod-iso}.

		Well, each $\varepsilon_{U_f}$ is an isomorphism of sheaves for each $f\in\OO_X(U)$, so we assemble into an isomorphism on the distinguished base. Thus, by functoriality of extending a sheaf on the base from \autoref{lem:sheafonabasefunctor}, we conclude that $\varepsilon$ is in total a sheaf isomorphism. This finishes.
		\qedhere
	\end{itemize}
\end{proof}
% Thus, we note the following.
% \begin{lemma} \label{lem:localize-is-good}
% 	Fix a quasicompact and quasiseparated scheme $X$. Then the natural maps $\mc F(X)_f\to\mc F(X_f)$ are isomorphisms.
% \end{lemma}
% \begin{proof}
% 	Similar to the case for schemes.
% \end{proof}
Anyway, let's see an example.
\begin{ex}
	We see that the sheaf of nilpotents $\mc N$ of a scheme $X$ is quasicoherent. Run the above checks.
\end{ex}
More generally, we have the following.
\begin{definition}[Ideal sheaf]
	Fix a scheme $X$. An \textit{ideal sheaf} $\mc I$ is an $\mathcal O_X$-module which is a subsheaf of $\OO_X$.
\end{definition}
\begin{lemma}
	Here are some remarks about the category of quasicoherent sheaves $\mathrm{Qcoh}_X$.
	\begin{listalph}
		\item The category $\mathrm{Qcoh}_X$ is an abelian category.
		\item Given an exact sequence
		\[0\to\mc F'\to\mc F\to\mc F''\to0\]
		then $\mc F'$ and $\mc F''$ being quasicoherent implies that $\mc F$ is quasicoherent.
	\end{listalph}
\end{lemma}
\begin{proof}
	Here we go.
	\begin{listalph}
		\item The point is to check everything on affine open subschemes. Namely, everything is local, so take $X=\Spec A$. To check that we're abelian, given a morphism $\pi\colon\mc F\to\mc G$ of quasicoherent sheaves, which will correspond to a map of modules $\pi^\sharp\colon M\to N$. We define the kernel as $\widetilde{\ker\pi^\sharp}$ and the kernel as $\widetilde{\coker\pi^\sharp}$. Lastly, we define $\mc F\otimes\mc G\coloneqq\widetilde{M\otimes N}$.
	\end{listalph}
	To prove (b), we have the following lemma.
	\begin{lemma} \label{lem:quasicoh-is-acyclic}
		Fix an affine scheme $X$ with $\OO_X$-modules $\mc F_1,\mc F_2,\mc F_3$. Then if $\mc F_1$ is quasicoherent, and
		\[0\to\mc F_1\to\mc F_2\to\mc F_3\to0\]
		is exact, then
		\[0\to\mc F_1(X)\to\mc F_2(X)\to\mc F_3(X)\to0\]
		is exact.
	\end{lemma}
	\begin{proof}
		By \autoref{lem:localize-is-good}, we note that the map $\mc F_1(U)\to\mc F_1(U_f)$ need not be surjective, but it is almost surjective: for any $a\in\mc F_1(U_f)$, there's going to be some $n$ such that $af^n$ does come from $\mc F_1(U)$. Now we can repeat the proof from homework that showed exactness from when $\mc F_1$ is flasque.
	\end{proof}
	Setting $M_i\coloneqq\mc F_i(X)$, note that the lemma will finish by pure category theory because it forces the middle arrow of
	% https://q.uiver.app/?q=WzAsMTAsWzAsMCwiMCJdLFsxLDAsIlxcd2lkZXRpbGRle01fMX0iXSxbMiwwLCJcXHdpZGV0aWxkZSBNXzIiXSxbMywwLCJcXHdpZGV0aWxkZSBNXzMiXSxbNCwwLCIwIl0sWzAsMSwiMCJdLFsxLDEsIlxcbWMgRl8xIl0sWzIsMSwiXFxtYyBGXzIiXSxbMywxLCJcXG1jIEZfMyJdLFs0LDEsIjAiXSxbMCwxXSxbMSwyXSxbMiwzXSxbMyw0XSxbNSw2XSxbNiw3XSxbNyw4XSxbOCw5XSxbMSw2XSxbMyw4XSxbMiw3LCIiLDEseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkYXNoZWQifX19XV0=&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}
		0 & {\widetilde{M_1}} & {\widetilde M_2} & {\widetilde M_3} & 0 \\
		0 & {\mc F_1} & {\mc F_2} & {\mc F_3} & 0
		\arrow[from=1-1, to=1-2]
		\arrow[from=1-2, to=1-3]
		\arrow[from=1-3, to=1-4]
		\arrow[from=1-4, to=1-5]
		\arrow[from=2-1, to=2-2]
		\arrow[from=2-2, to=2-3]
		\arrow[from=2-3, to=2-4]
		\arrow[from=2-4, to=2-5]
		\arrow[from=1-2, to=2-2]
		\arrow[from=1-4, to=2-4]
		\arrow[dashed, from=1-3, to=2-3]
	\end{tikzcd}\]
	is still an isomorphism.
\end{proof}
\begin{remark}
	\autoref{lem:quasicoh-is-acyclic} tells us that quasicoherent sheaves are going to have trivial cohomology, later in life.
\end{remark}
Here are some quick ways to build quasicoherent sheaves.
\begin{proposition}
	Fix a scheme morphism $f\colon X\to Y$.
	\begin{listalph}
		\item If $\mc G$ is a quasicoherent sheaf on $Y$, then $f^*\mc G$ is a quasicoherent sheaf on $X$.
		\item If $f$ is quasicompact and quasiseparated, then any quasicoherent sheaf $\mc F$ on $X$ gives a quasicoherent sheaf $f_*\mc F$ on $Y$.
	\end{listalph}
\end{proposition}
\begin{proof}
	Here we go.
	\begin{listalph}
		\item Reduce to the affine case, as usual. Namely, the result is local on $X$, so we may show this on an affine open cover of $X$. For this, we give $Y$ an affine open cover, pull this back to $X$, and the affine open cover on $X$ we want is going to come from the affine open covers of the pre-images. Now everything is an affine problem.
		\item As usual, the question is local on $Y$, so we may assume that $Y$ is affine. Thus, $f$ being quasicompact and quasiseparated forces $X$ to be quasicompact and quasiseparated. In particular, it follows that we can give $X$ a finite affine open cover $\{U_i\}_{i=1}^n$ where each of the intersections $U_i\cap U_j$ have finite affine open covers $\{U_{ijk}\}_{k=1}^{n_{ij}}$.

		Now, all the maps $f|_{U_i}$ and $f|_{U_{ij}}$ are morphisms of affine schemes, so $(f|_{U_i})_*(\mc F|_{U_i})$ will all be quasicoherent sheaves on $Y$ because morphisms between affine schemes are all affine. Thus, we think that we can build $f_*\mc F$ by hand! Namely, we see that $f_*\mc F=\mc F(f^{-1}V)$ fits into the exact sequence
		\[0\to\prod_i\mc F(f^{-1}V\cap U_i)\to\prod_{i,j,k}\mc F(f^{-1}V\cap V_{ijk})\]
		by using the sheaf condition. Lifting this to the level of sheaves, we see
		\[0\to f_*\mc F\to\prod_i(f|_{U_i})_*(\mc F|_{U_i})\to\prod_{i,j,k}\]
		is exact, so the morphism on the left is a kernel of morphisms of quasicoherent sheaves and is therefore a quasicoherent sheaf.
		\qedhere
	\end{listalph}
\end{proof}

\subsection{Closed Embeddings}
Given a sheaf $\mc F$ on $x$, recall from long ago that we defined $\op{Supp}\mc F\coloneqq\{x\in X:\mc F_x\ne0\}$. Now, here is our result.
\begin{proposition}
	Fix a scheme $X$. Then there is an equivalence of categories between closed subschemes of $X$ and quasicoherent ideal sheaves.
\end{proposition}
\begin{proof}
	Beginning with a closed embedding $\iota\colon Y\to X$, we get a quasicoherent sheaf by taking $\ker\iota^\sharp$. In the other direction, we take a quasicoherent ideal sheaf $\mc I\subseteq\OO_X$, and we set $Y\coloneqq\op{Supp}\OO_X/\mc I$ on the level of topological spaces and $f^{-1}(\OO_X/\mc I)$ on the level of sheaves.

	Here are our checks.
	\begin{itemize}
		\item Recall that closed embeddings are quasicompact and quasiseparated\footnote{The fact that closed embeddings are quasicompact is because closed subsets of affine schemes are quasicompact. The fact that closed embeddings are quasiseparated comes because all monomorphisms are quasiseparated.}, so $f_*\OO_Y$ is quasicoherent, so the kernel of $\iota^\sharp$ will also be quasicoherent.
		\item We check that $Y$ is actually a closed subscheme. Note $\op{Supp}(\OO_X/\mc I)$ is equal to $\{x\in X:\overline1_x\ne0\}$ and is therefore closed; here $\overline1$ refers to the global section coming from $1\in\OO_X(X)$. To check that $Y$ is actually a scheme, we check on the level of affine open subschemes. One can check that this gives a closed embedding by hand.
	\end{itemize}
	We omit the checks that this is actually an equivalence of categories.
\end{proof}
\begin{remark}
	The forward direction of the above proposition shows that all closed subschemes look like $\Spec A/I\into\Spec A$. Namely, one has to show that quasicoherent ideal sheaves $\mc I$ of an affine scheme all look like $\widetilde I$ where $I\subseteq A$ is an ideal, and the above proof has shown that $\op{Supp}(\widetilde A/\widetilde I)=V(I)$ and $f^{-1}(\OO_{\Spec A}/\mc I)$ has the correct structure sheaf.
\end{remark}

\subsection{Scheme Images}
We would like to talk about images of schemes. For example, given a quasicompact and quasiseparated morphism $f\colon X\to Y$, then we see $f_*\OO_X$ is quasicoherent on $Y$, so $I=\ker(\OO_Y\to f_*\OO_X)$ is going to be a quasicoherent sheaf on $Y$, and this will define a closed subscheme of $Y$ as above.

In general, $\ker(\OO_Y\to f_*\OO_X)$ need not be quasicoherent, but we can still set $\mc I$ to be the largest quasicoherent subsheaf, and our image is the largest closed subscheme defined by $\mc I$. Of course, we should probably talk about what the ``largest quasicoherent subsheaf'' is, but we can simply define it as the sum of all the quasicoherent subsheaves $\mc I_Z$ where $Z\into Y$ varies over all the closed embeddings through which $X\to Y$ factors.

We close class with the following definition.
\begin{definition}[Coherent sheaf]
	Fix a locally Noetherian scheme $X$. Then an $\mathcal O_X$-module $\mc F$ is \textit{coherent} if and only if $X$ can be covered by affine open subschemes $U_i\subseteq X$ such that $\mc F|_{U_\alpha}$ is isomorphic to $\widetilde M_\alpha$ where each $M_\alpha$ is a finitely generated $\OO_X(U_\alpha)$-module.
\end{definition}
\begin{remark}
	If we remove the locally Noetherian scheme $X$, then we're going to want our modules $M_i$ to be finitely presented. In the Noetherian case, these are equivalent.
	% 6.4
\end{remark}

\end{document}