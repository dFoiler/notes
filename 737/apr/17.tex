% !TEX root = ../notes.tex

\documentclass[../notes.tex]{subfiles}

\begin{document}

\section{April 17}
Today, we will talk about the Fourier transform.

\subsection{The Fourier Transform}
Note that there is an Artin--Schreier covering $p\colon\AA_k\to\AA_k$ given by $x\mapsto x^q-x$, which is \'etale (we are in positive characteristic) and in fact Galois with Galois group $G\coloneqq\FF_q$. By the Tannakian formalism, we see that we are granted a surjection $\pi_1^{\mathrm{\acute et}}\left(\AA^1_{\ov k},\ov x\right)\onto G$, so any character $\psi\colon\FF_q\to\ov\QQ_\ell^\times$ induces a character
\[\pi_1^{\mathrm{\acute et}}(\AA^1_{\ov k},\ov x)\onto G\stackrel\psi\to\ov\QQ_\ell^\times.\]
Thus, we produce a line bundle, which we name $\mc L_0(\psi)$.

We now fix a nontrivial additive character $\psi\colon\FF_q\to\ov\QQ_\ell^\times$,\footnote{For example, one convenient choice would be composing $\iota$ with the character $\FF_q\to\CC^\times$ given by $x\mapsto\exp(2\pi i\tr_{\FF_q/\FF_p}(x)/p)$.} and we note that a different choice of $x\in\FF_q$ gives rise to another character $\psi_x\colon\FF_q\to\ov\QQ_\ell^\times$ given by $\psi_x(y)\coloneqq\psi(xy)$. The mapping $x\mapsto\psi_x$ then defines an isomorphism from $\FF_q$ to the group of characters: certainly it is a homomorphism of groups of the same order, and it is injective because $\psi_x=1$ implies that $\psi(xy)=1$ for all $y$, so $x=0$ because $\psi$ is nontrivial.

We now have two claims.
\begin{lemma}
	The pushforward $p_*\ov\QQ_\ell$ is a smooth sheaf on $\AA_k$ of rank $q$.
\end{lemma}
\begin{proof}
	This follows because $p$ is \'etale and Galois of degree $q$.
\end{proof}
\begin{lemma}
	The underlying representation of $p_*\ov\QQ_\ell$ is given by the regular representation of $\ov\QQ_\ell[\FF_q]$.
\end{lemma}
\begin{proof}
	Indeed, the point is that $p_*\ov\QQ_\ell$ corresponds to a continuous map
	\[\rho\colon\pi_1^{\mathrm{\acute et}}(\AA^1,\ov x)\to\op{GL}_q(\ov\QQ_\ell),\]
	which on fibers is given by
	\[(p_*\ov\QQ_\ell)_{\ov x}\cong\op{Mor}(G,\ov\QQ_\ell).\]
	In particular, a fiber of a geometric point is calculated to be a $\ov\QQ_\ell$-vector space with action by $G$ given by $(g\varphi)(h)=\varphi(g+h)$ by some computation on the fibers.
\end{proof}
\begin{remark} \label{rem:diagonalize-regular}
	In fact, by diagonalizing the regular representation, we see that
	\[p_*\ov\QQ_\ell=\bigoplus_{x\in\FF_q}\mc L_0(\psi_x).\]
\end{remark}
\begin{remark}
	If we pass to a finite extension $\FF_{q^m}$, then there is a trace map $\tr\colon\FF_{q^m}\to\FF_q$ which produces a nontrivial character $\psi_n\colon\FF_{q^m}\to\FF_q$ satisfying
	\[\psi_x\circ{\tr}=(\psi\circ{\tr})_x.\]
	Thus, we can calculate that extending $\mc L_0(\psi)$ and $\mc L_0(\psi_x)$ is compatible with such field extensions.
\end{remark}
\begin{remark}
	The Leray spectral sequence implies that
	\[\mathrm H^1(\AA^1,\ov\QQ_\ell)=\mathrm H^1(\AA^1,p_*\ov\QQ_\ell)=\mathrm H^1_c(\AA^1,\ov\QQ_\ell)=\mathrm H^1_c(\AA^1,p_*\ov\QQ_\ell)=0.\]
	From this, one can calculate $\mathrm H^1(\AA^1,\mc L(\psi_x))=\mathrm H^1_c(\AA^1,\mc L(\psi_x))=0$ by taking the sum.
\end{remark}
We are now ready to define the Fourier transform.
\begin{definition}[Fourier transform]
	Fix a nontrivial character $\psi\colon\FF_q\to\ov\QQ_\ell^\times$, and consider the following diagram.
	% https://q.uiver.app/#q=WzAsNCxbMSwwLCJcXEFBXjFcXHRpbWVzXFxBQV4xIl0sWzIsMCwiXFxBQV4xIl0sWzAsMSwiXFxBQV4xIl0sWzIsMSwiXFxBQV4xIl0sWzAsMiwiXFxvcHtwcn1fMSJdLFswLDMsIlxcb3B7cHJ9XzIiLDJdLFswLDEsIm0iXV0=&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}[cramped]
		& {\AA^1\times\AA^1} & {\AA^1} \\
		{\AA^1} && {\AA^1}
		\arrow["m", from=1-2, to=1-3]
		\arrow["{\op{pr}_1}", from=1-2, to=2-1]
		\arrow["{\op{pr}_2}"', from=1-2, to=2-3]
	\end{tikzcd}\]
	Here, $m$ is the multiplication map. Then we define $T_\psi\colon D_c^b(\AA^1,\ov\QQ_\ell)\to D^b_c(\AA^1,\ov\QQ_\ell)$ to be given by
	\[T_\psi(K_0)\coloneqq\mathrm R\op{pr}_{1!}\big(\op{pr}_2^*K_0\otimes m^*\mc L_0(\psi)\big)[1].\]
\end{definition}
\begin{remark}[Perverse sheaves]
	The shift $[1]$ is included for technical reasons. In short, it ensures that our Fourier transform preserves perverse sheaves. Note that this shift $[1]$ is distinct from the Tate twist $(1)$! Perverse sheaves are the heart of the derived category of our complexes, and they have many desirable properties.
\end{remark}
\begin{remark}
	One can think about this Fourier transform as some kind of ``intersection'' of the complex $K_0$ with a cycle given by $\mc L(\psi)$, and this latter cycle is intimately related to the Frobenius because it arises from the Artin--Schreier covering.
\end{remark}
Morally, we are ``integrating'' (which is $\mathrm R\pi_{1!}$) our complex $K_0$ twisted by the character $m$. It takes some work to see how taking trace of $\pi_{1!}$ is the desired integration.

We will want a way to calculate the Fourier transform.
\begin{theorem} \label{thm:calculate-fourier}
	For $a\in\ov\FF_q$ and $K_0\in D^b_c(\AA^1,\ov\QQ_\ell)$, we have
	\[(T_\psi K_0)_a=\mathrm R\Gamma_c(K\otimes\mc L(\psi_a))[1].\]
\end{theorem}
\begin{proof}
	This follows directly from base-changing along $\{a\}\into\AA^1$.
\end{proof}
We've done a lot of discussion of sheaves, so let's now turn to the other side of the sheaf-function correspondence. Note that $K_0\in D_b^c(X,\ov\QQ_\ell)$ may define a function $f^{K_0}\colon X(\FF_{q^m})\to\CC$ given by
\[f^{K_0}(\ov x)\coloneqq\sum_{v}(-1)^vf^{\mathrm H^v(K_0)},\]
where $H^v(K_0)$ refers to the $v$th cohomology.
\begin{example}
	Let's compute $f^{\mc L_0(\psi)}(x)$: our Frobenius is mapping $\alpha\in\ov\FF_q$ which is a root of $T^{q^m}-T=x$ to a new solution $\beta\coloneqq\alpha^{q^m}$. But then $\beta-\alpha=x$, so the Galois element we are looking at is simply given by $-x$. By diagonalizing the regular representation again, it follows that $f^{\mc L_0(\psi)}(x)=\psi(-x)$.
\end{example}
The above example allows us to compute the following.
\begin{lemma} \label{lem:trace-fourier-sheaf}
	Choose $m\ge1$ and a complex $K_0\in D^b_c(\AA^1,\ov\QQ_\ell)$. Then one has
	\[f^{T_\psi K_0}(t)=-\sum_{x\in\FF_{q^m}}f^{K_0}(x)\ov\psi(xt).\]
\end{lemma}
\begin{proof}
	This is a direct computation. We write
	\begin{align*}
		f^{T_\psi K_0}(t) &= \sum_i(-1)^i\tr\left(F_t;\mathrm H^i\left(\mathrm R\op{pr}_{1!}(\op{pr}_2^*K_0\otimes m^*\mc L_0(\psi))\right)[1]\right) \\
		&= -\sum_i(-1)^i\tr\left(F_t;\mathrm H^i\left(\mathrm R\op{pr}_{1!}(\op{pr}_2^*K_0\otimes m^*\mc L_0(\psi))\right)\right) \\
		&\stackrel*= -\sum_i(-1)^i\sum_{x\in\FF_{q^m}}\tr\left(F_{(t,x)};\mathrm H^i(\pi_2^*K_0\otimes m^*\mc L_0(\psi))\right) \\
		&= -\sum_i(-1)^i\sum_{x\in\FF_{q^m}}\tr\left(F_{(t,x)};\mathrm H^i(\pi_2^*K_0)\right)\psi(-tx) \\
		&= -\sum_i(-1)^i\sum_{x\in\FF_{q^m}}\tr\left(F_{x};\mathrm H^i(K_0)\right)\psi(-tx).
	\end{align*}
	Here, $\stackrel*=$ is a special case of base-changing to a fiber, where the point is that taking a trace of $\mathrm R\op{pr}_{1!}$ turns into summing along the fiber. The result now follows from a rearrangement.
\end{proof}
We are interested in developing some Fourier theory on the level of sheaves, so it is worth our time to recall how Fourier theory works for functions. In general, given a finite abelian group $G$, we let $\widehat G$ denote the character group. Then any function $f\colon G\to\CC$ admits a Fourier transform $\hat f\colon\widehat G\to\CC$ given by
\[\hat f(\chi)\coloneqq\sum_{g\in G}f(g)\ov\chi(g).\]
Then there are two main statements: there is a Fourier inversion formula
\[f(g)=\frac1{\left|G\right|}\sum_{\chi\in\widehat G}\hat f(\chi)\chi(g),\]
and there is a Plancherel formula
\[\sum_{g\in G}\left|f(g)\right|^2=\frac1{\left|G\right|}\sum_{\chi\in\widehat G}\left|\hat f(\chi)\right|^2.\]
We will lift these two results to sheaves next class, though we will not prove them.

\end{document}