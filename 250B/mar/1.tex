% !TEX root = ../notes.tex

Welcome back everyone. The average and median for the exam was 32/50.

\subsection{Krull's Intersection Theorem}
Last time we showed the following.
\begin{restatable}[Krull intersection]{theorem}{krullintersect2}
	Fix $R$ a Noetherian ring with an ideal $I$ and finitely generated module $M$. Then
	\[N:=\bigcap_{s\ge0}I^sM\]
	satisfies that there is some $x\in I$ such that $(1-r)N=0$.
\end{restatable} % \todo{make this a restatable}
\noindent The Noetherian condition is necessary here; consider the following example.
\begin{exe}
	Let $R$ be the germ of infinitely differentiable functions $f:\RR\to\RR$ at $0$. Namely, two functions $f,g:\RR\to\RR$ are equivalent in $R$ if and only if they coincide on an open neighborhood around $0$. Then
	\[\bigcap_{s>0}(x)^s\]
	is nonzero.
\end{exe}
\begin{proof}
	The point is that
	\[I:=\bigcap_{s>0}(x)^s\]
	is the set of germs represented by a function with all derivatives vanishing. However, it is a counterexample from real analysis that $e^{-1/x^2}$ also has all derivatives vanish but is a nonzero function.
\end{proof}

\subsection{Flat Modules}
Today we are talking about flatness and $\op{Tor}$. Let's start with flatness; we recall the definition.
\begin{definition}[Flat]
	Fix $R$ a ring. Then an $R$-module $M$ is \textit{flat} if and only if the functor $M\otimes_R-$ is exact.
\end{definition} % \todo{make this a restatable}
\begin{remark}
	Because $M\otimes_R-$ is already left-exact, we merely have to check that $N\into N'$ induces an injection $M\otimes_RN\into M\otimes_RN'$.
\end{remark}
We also had the following examples.
\begin{example}
	We showed long ago that $R$ and therefore free modules $R^n$ are flat.
\end{example} % \todo{restatable}
For our next example, we pick up the following definition.
\begin{definition}[Projective]
	An $R$-module $P$ is \textit{projective} if and only if one of the following four equivalent conditions are satisfied.
	\begin{listalph}
		\item The functor $\op{Hom}_R(P,-)$ is exact.
		\item There exists an $R$-module $K$ such that $P\oplus K$ is a free $R$-module.
		\item If we have a surjection $M\onto M'$ and a map $P\to M'$, there is a map $P\to M$ making the following diagram commute.
		% https://q.uiver.app/?q=WzAsMyxbMSwwLCJQIl0sWzEsMSwiTScnIl0sWzAsMSwiTSJdLFswLDFdLFswLDIsIiIsMix7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dLFsyLDEsIiIsMix7InN0eWxlIjp7ImhlYWQiOnsibmFtZSI6ImVwaSJ9fX1dXQ==
		\[\begin{tikzcd}
			& P \\
			M & {M''}
			\arrow[from=1-2, to=2-2]
			\arrow[dashed, from=1-2, to=2-1]
			\arrow[two heads, from=2-1, to=2-2]
		\end{tikzcd}\]
		\item Any short exact sequence
		\[0\to A\to B\to Q\to 0\]
		splits.
	\end{listalph}
\end{definition}
It is not obvious that these definitions are equivalent, but they are. For example, (a) and (c) are equivalent by writing out what the commutative diagram is asking for in terms of $\op{Hom}$ sets. Further, (c) implies (d) by lifting from the following diagram.
% https://q.uiver.app/?q=WzAsNixbMywwLCJQIl0sWzMsMSwiUCJdLFsyLDEsIkIiXSxbNCwxLCIwIl0sWzAsMSwiMCJdLFsxLDEsIkEiXSxbMCwxLCIiLDAseyJsZXZlbCI6Miwic3R5bGUiOnsiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFswLDIsIiIsMix7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dLFsyLDEsIiIsMix7InN0eWxlIjp7ImhlYWQiOnsibmFtZSI6ImVwaSJ9fX1dLFs0LDVdLFs1LDJdLFsxLDNdXQ==
\[\begin{tikzcd}
	&&& P \\
	0 & A & B & P & 0
	\arrow[Rightarrow, no head, from=1-4, to=2-4]
	\arrow[dashed, from=1-4, to=2-3]
	\arrow[two heads, from=2-3, to=2-4]
	\arrow[from=2-1, to=2-2]
	\arrow[from=2-2, to=2-3]
	\arrow[from=2-4, to=2-5]
\end{tikzcd}\]
To show that (d) implies (b), we make the short exact sequence
\[0\to\ker\pi\to\bigoplus_{m\in M}Rm\stackrel\pi\to M\to 0,\]
where $\pi$ is defined in the natural way. Lastly, (b) implies (a) because it gives
\[\op{Hom}_R(M\oplus K,-)\cong\op{Hom}_R(M,-)\oplus\op{Hom}_R(K,-).\]
This more or less completes the equivalences.
\begin{example}
	Projective modules are flat, which we can see from the fact that $P\oplus K$ is free and then using the fact that free modules are flat already.
\end{example}
\begin{example}
	For any multiplicative set $U\subseteq R$, the module $R\left[U^{-1}\right]$ is flat. We showed this a long time ago. As a small aside, we note that $R\left[U^{-1}\right]\otimes-$ is a priori only exact for $R\left[U^{-1}\right]$-modules, but this restricts to $R$-modules just fine (even when $R\to R\left[U^{-1}\right]$ is not injective).
\end{example}
And let's see a non-example.
\begin{nex}
	The $\ZZ$-module $\ZZ/n\ZZ$ is not exact. For example, we take
	\[0\to\ZZ\stackrel{\times n}\ZZ\to\ZZ/n\ZZ\to0\]
	apply $-\otimes\ZZ/n\ZZ$ to get
	\[0\to\ZZ/n\ZZ\stackrel{\times n}\ZZ/n\ZZ\to\ZZ/n\ZZ\to0,\]
	but this is no longer exact at $\ZZ/n\ZZ$ term because $\stackrel{\times n}\to$ is the zero map.
\end{nex}

\subsection{Flatness via Algebraic Geometry}
In algebraic geometry, we are interested in families of affine varieties, which consists of a base $B$ for a family and a map $\varphi:X\to B$. As usual, the algebraic story will reverse, so the family in the algebraic world  becomes a function
\[\varphi^{-1}:A(B)\to A(X).\]
In particular, this is exactly the data of $A(X)$ being an $A(B)$-algebra. To make our notions more general, we set $S:=A(X)$ an $R:=A(B)$-algebra by $\varphi:R\to S$. As such, we have the following definition.
\begin{definition}[Flat]
	An $R$-algebra $S$ is \textit{flat} if and only if $S$ is flat as an $R$-module.
\end{definition}
To access flatness, we talk about fibers. In the algebraic world, the fiber of a ``point'' $\mf m$ should be the ring of functions in $S$ on the point $\mf m$, which means we want to look at
\[S/\mf mS.\]
Flatness, roughly speaking, means that $S/\mf mS$ varies continuously as the point $\mf m$ moves.

Let's see some examples. We will take our base to be $B:=\AA^1(k)$ the affine line over an algebraically closed field $k$, which gives that $R:=k[x]$.
\begin{exe}
	We consider the flatness of $S:=R[x]/\left(x^2-t\right)$ geometrically and algebraically.
\end{exe}
\begin{proof}
	This looks like the following.
	\begin{center}
		\begin{asy}
			unitsize(1cm);
			import graph;
			real y(real t)
			{
				return t;
			}
			real x(real t)
			{
				return t*t;
			}
			draw(graph(x, y,-2,2));
		\end{asy}
	\end{center}
	The fiber at $t=a$ as $a\in k$ varies is
	\[\frac{k[x]}{\left(x^2-a\right)}\cong\begin{cases}
		k^2 & a\ne0, \\
		k[x]/\left(x^2\right) & a=0.
	\end{cases}\]
	Visually, we can see that $a\ne0$ has two points above it, and at $x=0$, we are vertical. Because the dimension is constant as the point moves, we suspect $S$ to be a flat $R$-algebra. And indeed, viewing $x^2-t$ as a monic polynomial with coefficients in $R[t]$, we see that $S$ is a free module over $R[t]$ of rank $2$, so $S$ is flat.
\end{proof}
\begin{exe}
	We consider the flatness of $S:=R[x]/\left(xt-1\right)$ geometrically and algebraically.
\end{exe}
\begin{proof}
	This looks like the following.
	\begin{center}
		\begin{asy}
			unitsize(0.4cm);
			import graph;
			real y(real t)
			{
				return t;
			}
			real x(real t)
			{
				return 1/t;
			}
			draw(graph(x, y,-4,-1/4));
			draw(graph(x, y, 4,1/4));
		\end{asy}
	\end{center}
	Visually, we can see that the fiber over any $t=a$ as $a\in k$ is one point, except when $a=0$, where the fiber is empty. So we expect $S$ to be flat, and indeed it is: $S=R\left[t^{-1}\right]$ is a localization and therefore flat.
\end{proof}
\begin{exe}
	We consider the non-flatness of $S:=R[x]/(tx-t)$ geometrically and algebraically.
\end{exe}
\begin{proof}
	This looks like the following.
	\begin{center}
		\begin{asy}
			unitsize(0.4cm);
			import graph;
			draw((-4,1)--(4,1));
			draw((0,-4)--(0,4));
		\end{asy}
	\end{center}
	The problem here is that the fiber is jumping at $t=0$, so we expect $S$ to not be flat as an $R$-module. For this, we have the following result.
	\begin{lemma}
		Fix $R$ a ring $a\in R$ a non-zero-divisor. Further, if $M$ is a flat $R$-module, then $am=0$ implies $m=0$ for $m\in M$.
	\end{lemma}
	\begin{proof}
		The point is to look at the short exact sequence
		\[0\to(a)\to R\to R/(a)\to 0.\]
		Upon tensoring with $M$, we see that $(a)\otimes_RM\into R\otimes_RM$, so $(a)M\into M$. In particular, multiplication by $a$ is injective on $M$, so $am=0=a\cdot0$ implies $m=0$.
	\end{proof}
	From the above lemma, we note that $t(x-1)=0$ in $S$ while $t$ is not a zero-divisor, so $S$ is not flat.
\end{proof}

\subsection{Homological Algebra}
We will want to talk about $\op{Tor}$ for our discussion, so we will want to talk about homological algebra.
\begin{quot}
	The difference between homology and cohomology is that homology indexes like $H_i$, and cohomology indexes like $H^i$.
\end{quot}
We will want to talk about chains in homological algebra, so we will start with complexes.
\begin{definition}[Complex]
	Fix $C:=\oplus_{i\ge0}C_i$ a $\NN$-graded $R$-module. Then $C$ is a \textit{chain} if and only if it is equipped with a (graded) morphism $\del\in\op{End}_R(C)$ such that $\del^2=0$. If $\deg\del=-1$, this is homology, and if $\deg\del=+1$, this is cohomology.
\end{definition}
In the homology case, we can view this like
\[\cdots\stackrel\del\to C_2\stackrel\del\to C_1\stackrel\del\to C_0\stackrel\del\to 0.\]
If we wanted, we could index the arrows as $\del_i:C_i\to C_{i-1}$, but it makes things a little harder to keep track of.
\begin{definition}[Homology]
	Given a chain $(C,\del)$, we define the \textit{homology groups} as
	\[H_i(C):=\ker\del_i/\im\del_{i+1}\]
\end{definition}
Note this is well-defined because $\del^2=0$.

As usual in algebra, we will want morphisms between our objects.
\begin{definition}[Chain morphism]
	Fix chain complexes $(C,\del)$ and $(C',\del')$, we define a morphism $\varphi$ as a degree-$0$ morphism $\varphi:C\to C'$ preserving $\del$ as in the following diagram.
	% https://q.uiver.app/?q=WzAsNCxbMCwwLCJDX2kiXSxbMSwwLCJDX3tpLTF9Il0sWzEsMSwiQydfe2ktMX0iXSxbMCwxLCJDJ19pIl0sWzAsMSwiXFxkZWwiXSxbMywyLCJcXGRlbCciLDJdLFswLDMsIlxcdmFycGhpIiwyXSxbMSwyLCJcXHZhcnBoaSJdXQ==
	\[\begin{tikzcd}
		{C_i} & {C_{i-1}} \\
		{C'_i} & {C'_{i-1}}
		\arrow["\del", from=1-1, to=1-2]
		\arrow["{\del'}"', from=2-1, to=2-2]
		\arrow["\varphi"', from=1-1, to=2-1]
		\arrow["\varphi", from=1-2, to=2-2]
	\end{tikzcd}\]
\end{definition}
We can check that $\varphi$ maps kernels of $\del$ to kernels of $\del'$ and images of $\del$ to images of $\del'$, so we get an induced map $H(\varphi):H_i(C)\to H_i(C')$.

And because abstraction is all the rage, there is also a notion of morphisms being the same.
\begin{definition}[Homotopically equivalent]
	Two chain morphisms $\varphi,\psi:(C,\del)\to(C',\del')$ are \textit{homotopically equivalent} if and only if there exists an $R$-module homomorphism $h:C\to C$ of degree $1$ (i.e., $h:C_i\to C_{i+1}'$) such that $\varphi-\psi=h\del+\del'h$.
\end{definition}
The image is as follows. As a warning, this diagram does not commute.
% https://q.uiver.app/?q=WzAsMTAsWzIsMCwiQ18xIl0sWzMsMCwiQ18wIl0sWzQsMCwiMCJdLFsyLDEsIkNfMSciXSxbMywxLCJDXzAnIl0sWzQsMSwiMCJdLFsxLDAsIkNfMiJdLFsxLDEsIkNfMiciXSxbMCwwLCJcXGNkb3RzIl0sWzAsMSwiXFxjZG90cyJdLFs4LDZdLFs2LDBdLFswLDFdLFsxLDJdLFs5LDddLFs3LDNdLFszLDRdLFs0LDVdLFsxLDRdLFswLDNdLFs2LDddLFsxLDMsImgiLDFdLFswLDcsImgiLDFdXQ==
\[\begin{tikzcd}
	\cdots & {C_2} & {C_1} & {C_0} & 0 \\
	\cdots & {C_2'} & {C_1'} & {C_0'} & 0
	\arrow[from=1-1, to=1-2]
	\arrow[from=1-2, to=1-3]
	\arrow[from=1-3, to=1-4]
	\arrow[from=1-4, to=1-5]
	\arrow[from=2-1, to=2-2]
	\arrow[from=2-2, to=2-3]
	\arrow[from=2-3, to=2-4]
	\arrow[from=2-4, to=2-5]
	\arrow[from=1-4, to=2-4]
	\arrow[from=1-3, to=2-3]
	\arrow[from=1-2, to=2-2]
	\arrow["h"{description}, from=1-4, to=2-3]
	\arrow["h"{description}, from=1-3, to=2-2]
\end{tikzcd}\]
The main point of this definition is the following.
\begin{proposition}
	Suppose $\varphi,\psi:(C,\del)\to(C',\del')$ are homotopically equivalent. Then $H(\varphi)=H(\psi)$.
\end{proposition}
\begin{proof}
	It suffices (by taking $\gamma:=\varphi-\psi$) to show that if $\gamma$ is homotopically equivalent to $0$, then $H(\gamma)$ vanishes. Now, suppose we have any $c\in\ker\del$, and we want to show that $\gamma(c)\in\im\del'$. Well, we compute
	\[\gamma(c)=(h\del+\del'h)(c)=\del'(h)\in\im\del',\]
	so we are done.
\end{proof}

To close out class, we discuss the long exact sequence.
\begin{theorem}
	Fix
	\[0\to C'\stackrel\alpha\to C\stackrel\beta\to C''\to0\]
	a short exact sequence of complexes. Then there is a long exact sequence of homology
	\[\cdots\to H_i(C')\stackrel{H(\alpha)}\to H_i(C)\stackrel{H(\beta)}\to H_i(C'')\stackrel{\delta}\to H_{i-1}(C')\to\cdots.\]
\end{theorem}
\begin{proof}
	We will be very brief. The main point is the construction of $\delta$. Fix some element $c\in\ker\del_i''$ from $H_i(C'')$. Then we can pull it back to $\beta^{-1}(c)$ in $H_i(c)$, then push it forwards through $\del'$ to live in $H_{i-1}(C)$, which we can then lastly check lives in the image of $\alpha$, so we finish by pulling backwards along $\alpha$ to get back to $H_{i-1}(C')$.
\end{proof}