% !TEX root = ../notes.tex

Let's begin.

\subsection{A Criterion for Flatness}
Let's review the following result.
\begin{theorem} \label{thm:flatcondition}
	An $R$-module $M$ is flat if and only if $\op{Tor}_1^R(R/I,M)=0$ for all finitely generated ideals $I\subseteq R$. Equivalently, $\op{Tor}_1^R(R/I,M)=0$ if and only if the natural map $I\otimes M\to M$ is injective.
\end{theorem} % \todo{restatable}
\begin{proof}
	We proceed with the following steps.
	\begin{enumerate}
		\item From the long exact sequence of $\op{Tor}$, the injectivity of $I\otimes M\to M$ is equivalent to
		\[\op{Tor}_1^R(R/I,M)=0\]
		for all finitely generated ideals $I$. In particular, we use the short exact sequence
		\[0\to I\to R\to R/I\to 0\]
		and consider the long exact sequence we get upon applying $-\otimes_RM$.
		\item We extend to all ideals $I=(x_\alpha)_{\alpha\in\lambda}$. Well, if we have a nontrivial element $x\otimes m$ of the kernel of $I\otimes M\to M$, then we can write
		\[x=\sum_{i=1}^nr_ix_{\alpha_i}\otimes m,\]
		because $x$ only uses finitely many of the $x_\alpha$, so we see that the finitely generated (!) ideal $(x_{\alpha_1},\ldots,x_{\alpha_n})$ will also have a kernel.
		\item We reduce checking that, for all submodule $N'\into N$, we have that $M\otimes_RN'\into M\otimes_RN$, to the case where $N$ is finitely generated. Well, if there is a nontrivial kernel, then we write a nontrivial element of the kernel as
		\[\sum_{i=1}^nm_i\otimes n_i'\mapsto0,\]
		so the same trick lets us assume that both $M$ and $N'$ are finitely generated.

		\item We would like to check that $\op{Tor}_1^R(M,N)=0$ for finitely generated $N$. Well, let $n$ be the minimal number of generators for $N$. For $n=0$, we have $N=0$ and are done. For $n=1$, we use step 1. Then for our induction, we write
		\[0\to N''\to N\to N'\to0\]
		where $N''$ and $N'$ have fewer than $n$ generators. Then the long exact sequence tells us that
		\[\op{Tor}_1^R(M,N'')\to\op{Tor}_1^R(M,N)\to\op{Tor}_1^R(M,N)\]
		is exact, so the induction forces the left and right terms to vanish, so $\op{Tor}_1^R(M,N)=0$.
		\qedhere
	\end{enumerate}
\end{proof}
Let's see some example.
\begin{exe}
	Set $R:=k[x]/\left(x^2\right)$. We show that an $R$-module $M$ is flat if and only if $M$ is free.
\end{exe}
\begin{proof}
	We use \autoref{thm:flatcondition}. Certainly if $I=R$ or $I=0$ we are done. The only other ideal to check is $(x)$, so we just need to verify that
	\[(x)M\to M\]
	is injective. In particular, we need to check that $\ker(x)/\im(x)=0$, which amounts to verifying that $M$ is free because $x$ is the only element that could provide us with a kernel.
\end{proof}
\begin{remark}[Serganova]
	In fact, we can show that any $R$-module $M$ can be written as $M_0\oplus F$ where $M_0\cong\ker(x)/\im(x)$ and $F$ is free.
\end{remark}
\begin{exe}
	Fix $R$ a principal ideal domain. Then an $R$-module $M$ is flat if and only if $M$ is torsion-free.
\end{exe}
\begin{proof}
	All ideals take the form $(a)$, but $(a)\cong R$ because $R$ is a principal ideal domain, so we are merely verifying that the map $R\otimes_RM\to M$ is injective, which is true if and only if $M$ is torsion free.
\end{proof}
\begin{example}
	If a $\ZZ$-module $M$ is finitely generated and torsion free, then $M$ must actually be free. Also, $\QQ$ is torsion free and hence flat.
\end{example}

\subsection{Flatness Locally}
We note the following.
\begin{lemma}
	Fix $R$ a ring and $\mf p$ a prime. If $M$ is a flat $R$-module, then $M_\mf p$ is a flat $R_\mf p$-module.
\end{lemma}
\begin{proof}
	Use the $\op{Tor}$ condition for flatness and note that $R_\mf p$ being flat allows us to simply tensor in the projective resolution for $M$ to give a projective resolution for $M_\mf p$. Alternatively, simply note that $R_\mf p\otimes_RM$ is the tensor product of two flat modules.
\end{proof}
We might hope the converse holds. Indeed, it does.
\begin{proposition}
	Fix $R$ a ring and $M$ an $R$-module. If $M_\mf p$ is flat for all primes $\mf p$, then $M$ is also flat.
\end{proposition}
\begin{proof}
	Well, fix some inclusion $N\subseteq N'$ so that we want to show that
	\[M\otimes_R N'\to M\otimes_RN\]
	is also an inclusion. Well, we know that, upon localization, we have an inclusion
	\[M_\mf p\otimes_{R_\mf p}N'_\mf p\to M_\mf p\otimes_{R_\mf p}N_\mf p,\]
	so because this is an inclusion locally, it becomes an inclusion globally as we showed a while ago.
\end{proof}
So we are motivated to study how flat modules behave under localization.
\begin{prop}
	Fix $R$ a local ring with maximal ideal $\mf p$. Further, let $M$ be a finitely presented $R$-module. If $M$ is flat, then $M$ is free.
\end{prop}
\begin{proof}
	The idea is to use Nakayama's lemma. Because $M$ is finitely presented, we can build a short exact sequence
	\[0\to N\to F\to M\to 0,\]
	where $N$ is finitely generated, and $F$ is free. Upon tensoring with $R/\mf p$, we get the right-exact sequence
	\[N/\mf pN\to F/\mf pF\to M/\mf pM\to 0.\]
	Now, choose $F$ such that $\dim F/\mf pF=\dim M/\mf pM$, for otherwise we could use Nakayama's lemma to generate $F$ by fewer (namely, $\dim F/\mf pF$ many) elements.
	
	It follows that $N/\mf pN$ must vanish, so because $N$ is finitely generated, Nakayama's lemma promises that $N=0$. Thus, $F=M$, so $M$ is free, so we are done.
\end{proof}
\begin{remark}
	In fact, any projective module over a local ring is free. The case for finitely generated modules is on the homework. The homework also includes some examples of flatness checks.
\end{remark}

\subsection{Completions, Algebraically}
We shift gears to talk about completion. The idea is to give a ring a topology by more or less by thinking about a filtration like a fundamental system of neighborhoods around the identity.
\begin{definition}[Completion, rings]
	Fix $R$ with a filtration $\mathcal J$ given by
	\[R=I_0\supseteq I_1\supseteq I_2\supseteq\cdots.\]
	Then we define the \textit{completion $\widehat R_\mathcal J$} as a subring of $\prod_{s\in\NN}R/\mf I_s$ by
	\[\widehat R_\mathcal J=\left\{(r_0,r_1,\ldots)\in\prod_{s\in\NN}R/I_s:r_i\equiv r_j\pmod{I_j}\text{ for }i>j\right\}.\]
\end{definition}
As usual, the most interesting filtrations for us will be the $I$-adic filtrations, especially when $I$ is a maximal ideal.

We have the following check.
\begin{lemma}
	Fix $R$ with a filtration $\mathcal J$. Then $\widehat R_\mathcal J$ is a ring.
\end{lemma}
\begin{proof}
	For concreteness, label our filtration $\mathcal J$ by
	\[R=I_0\supseteq I_1\supseteq I_2\supseteq\cdots.\]
	The ring structure of $\widehat R_\mathcal J$ is inherited from the product $\prod_{s\in\NN}R/\mf I_s$, so we merely have to run checks for being a subring.
	\begin{itemize}
		\item We note that the identity element of $\prod_{s\in\NN}R/I_s$ is $\{[1]_{I_s}\}_{s\in\NN}$. To see that this is in $\widehat R_\mathcal J$, we see that
		\[[1]_{I_n}\equiv[1]_{I_m}\pmod{I_m}\]
		for $n>m$.
		\item We show closure under addition and multiplication. Indeed, if $\{r_n\}_{n\in\NN},\{s_n\}_{n\in\NN}\in\widehat R_\mathcal J$, then the sum is
		\[\{r_n+s_n\}_{n\in\NN}\]
		To see that this lives in $\widehat R_\mathcal J$, we see that $n>m$ has $r_s\equiv r_m\pmod{I_m}$ and $s_n\equiv s_m\pmod{I_m}$, so
		\[r_n+s_n\equiv r_m+s_m\pmod{I_m}\qquad r_ss_n\equiv r_ms_m\pmod{I_m},\]
		which finishes.
		\item We show closure under negation. Indeed, if $\{r_n\}_{n\in\NN}\in\widehat R_\mathcal J$, then $r_n\equiv r_m\pmod{I_m}$ for $n>m$, so
		\[-r_n\equiv-r_m\pmod{I_m},\]
		so $\{-r_n\}_{n\in\NN}$ lives in $\widehat R_\mathcal J$. This is our negative element in $\prod_{s\in\NN}R/I_s$, so we are done.
	\end{itemize}
	The above checks show that we have a subring.
\end{proof}

Let's see some examples.
\begin{exe}
	Fix $R:=k[x]$ and $\mf m:=(x)$ a maximal ideal. We claim $\widehat R_\mf m\cong k[[x]]$.
\end{exe}
\begin{proof}
	We see $\widehat R_\mf m$ consists of sequences of polynomials $\{p_n(x)\}_{n\in\NN}$ such that
	\[p_n\equiv p_m\pmod{x^m}\]
	for $n>m$. To be explicit, we set
	\[p_n(x):=\sum_{k=0}^\infty a_{n,k}x^k\]
	so that we know
	\[\sum_{k=0}^\infty a_{n,k}x^k=p_n(x)\equiv p_m(x)=\sum_{k=0}^\infty a_{m,k}x^k\pmod{x^m}.\]
	In particular, we see that are forced to have $a_{n,k}=a_{m,k}$ for $k<m$ because the above equation tells us that $x^m$ divides
	\[\sum_{k=0}^{m-1}(a_{n,k}-a_{m,k})x^k,\]
	which can only be possible if all these coefficients vanish by degree arguments.

	We are ready to construct our isomorphism $\widehat R_\mf m\cong k[[x]]$: we take the above sequence $\{p_n(x)\}_{n\in\NN}$. We set
	\[\varphi\left(\{p_n(x)\}_{x\in\NN}\right):=\sum_{k=0}^\infty a_{k+1,k}x^k.\]
	This map is of course well-defined. Our inverse map is
	\[\psi\left(\sum_{k=0}^\infty a_kx^k\right)=\left\{\sum_{k=0}^{n-1}a_kx^k\right\}_{n\in\NN}.\]
	We run the following checks.
	\begin{itemize}
		\item We check that $\psi$ is well-defined. Indeed, if $n>m$, then we see
		\[\sum_{k=0}^{n-1}a_kx^k\equiv\sum_{k=0}^{m-1}a_kx^k\pmod{x^m},\]
		which is what we need to live $\widehat R_\mf m$.
		\item We check $\varphi\circ\psi$ is the identity. Indeed, we see that
		\[\varphi\left(\psi\left(\sum_{k=0}^\infty a_kx^k\right)\right)=\varphi\Bigg(\Bigg\{\sum_{k=0}^{n-1}a_kx^k\Bigg\}_{n\in\NN}\Bigg)=\sum_{k=0}^\infty a_{k,k+1}x^k,\]
		but $a_{k,k+1}=a_k$ by construction, so we are done.
		\item We check $\psi\circ\varphi$ is the identity. Indeed, we see that
		\[\psi\left(\varphi\left(\Bigg\{\sum_{k=0}^\infty a_{n,k}x^k\Bigg\}_{n\in\NN}\right)\right)=\psi\left(\sum_{k=0}^\infty a_{k+1,k}x^k\right)=\left\{\sum_{k=0}^{n-1}a_{k+1,k}x^k\right\}_{n\in\NN}.\]
		To see that this is identity, we need to show that
		\[\sum_{k=0}^\infty a_{n,k}x^k\equiv\sum_{k=0}^{n-1}a_{k+1,k}x^k\pmod{x^n},\]
		for which we have to show that $a_{n,k}=a_{k+1,k}$ for $k<n$. But by definition of $\widehat R_\mf m$, we see that
		\[\sum_{k=0}^\infty a_{n,k}x^k\equiv\sum_{k=0}^\infty a_{k+1,k}x^k\pmod{x^{k+1}},\]
		so we get the desired result upon comparing the $x^k$ term above.
		\item We check that $\psi$ preserves addition. This is a matter of force. We write
		\begin{align*}
			\varphi\left(\sum_{k=0}^\infty a_kx^k+\sum_{k=0}^\infty b_kx^k\right) &= \varphi\left(\sum_{k=0}^\infty(a_k+b_k)x^k\right) \\
			&= \left\{\sum_{k=0}^{n-1}(a_k+b_k)x^k\right\}_{n\in\NN} \\
			&= \left\{\sum_{k=0}^{n-1}a_kx^k\right\}_{n\in\NN}+\left\{\sum_{k=0}^{n-1}b_kx^k\right\}_{n\in\NN} \\
			&= \varphi\left(\sum_{k=0}^\infty a_kx^k\right)+\varphi\left(\sum_{k=0}^\infty b_kx^k\right).
		\end{align*}
		\item We check that $\psi$ preserves multiplication. Again, this is a matter of force. We write
		\begin{align*}
			\varphi\left(\sum_{k=0}^\infty a_kx^k\cdot\sum_{k=0}^\infty b_kx^k\right) &= \varphi\left(\sum_{m=0}^\infty\sum_{k+\ell=m}(a_kb_\ell)x^m\right) \\
			&= \left\{\sum_{m=0}^{n-1}\sum_{k+\ell=m}(a_kb_\ell)x^m\right\}_{n\in\NN} \\
			&= \left\{\sum_{m=0}^{n-1}a_kx^k\cdot\sum_{\ell=0}^{n-1}a_\ell x^\ell\right\}_{n\in\NN},
		\end{align*}
		where in the last equality we have used the fact that the terms of degree at least $x^n$ will vanish in the $n$th term. Continuing we see
		\begin{align*}
			\varphi\left(\sum_{k=0}^\infty a_kx^k\cdot\sum_{k=0}^\infty b_kx^k\right) &= \left\{\sum_{k=0}^{n-1}a_kx^k\right\}_{n\in\NN}\cdot\left\{\sum_{k=0}^{n-1}b_kx^k\right\}_{n\in\NN} \\
			&= \varphi\left(\sum_{k=0}^\infty a_kx^k\right)\varphi\left(\sum_{k=0}^\infty b_kx^k\right).
		\end{align*}
		\item We check that $\psi$ preserves identities. Well, we note $\psi(1)=\{1\}_{n\in\NN}$.
	\end{itemize}
	The first three checks shows that $\psi$ is bijective, and the last three checks show that $\psi$ is a homomorphism. So we are done.
\end{proof}
% \begin{example}
% 	Fix $R:=k[x]$ with $\mf m:=(x)$ a maximal ideal. Then 
% 	for $n>m$. These sequences just define formal power series, where the last $n$ terms of the power series are determined by $p_n$, and the coherence above guarantees that this is well-defined.
% \end{example}
\begin{example}
	Fix $R:=\ZZ$ with $\mf m:=(p)$. Then the ring $\widehat R_\mf m$ is called the $p$-adic integers, more commonly denoted $\ZZ_p$. This ring consists of sequences $\{b_n\}_{n\in\NN}$ which behave as ``formal power series'' in $p$ in the following way. Note $b_{n+1}-b_n\equiv0\pmod{p^n}$, so we can set $a_n:=\frac{b_{n+1}-b_n}{p^n}\in\ZZ/p\ZZ$; in particular, we see that
	\[b_n=\sum_{k=0}^{n-1}(b_{k+1}-b_k)=\sum_{k=0}^{n-1}a_kp^k.\]
	Taking $n\to\infty$ recovers a power series in $p$.
\end{example}
\begin{example}
	The $2$-adic integer $u\in\ZZ_2$ given by
	\[u:=1+2+2^2+2^3+\cdots\]
	is actually just $-1$. To be explicit, we set
	\[u_n\equiv\sum_{k=0}^{n-1}2^k\pmod{2^n}\]
	and consider the sequence $\{u_k\}_{k\in\NN}$; notably, $u_n\equiv u_m\pmod{2^m}$ for $n>m$ by simply expanding out $u_n$ and $u_m$. Now, if we multiply $(1-2)u$, then we see that
	\[(1-2)u_n=(1-2)\left(\sum_{k=0}^{n-1}2^k\right)=1-2^n\equiv1\pmod{2^n}.\]
	Thus, $\{(1-2)u_n\}_{n\in\NN}=\{1\}_{n\in\NN}$, so $(1-2)u=1$. After rearranging, we see that $u=-1$.
\end{example}

\subsection{Complete Rings}
In the previous examples, we might have noticed that there are natural inclusions $k[x]\subseteq k[[x]]$ and $\ZZ\subseteq\ZZ_2$. More generally, we have the following.
\begin{lemma} \label{lem:naturalcompletionmap}
	Fix $R$ a ring and $\mathcal J$ a filtration. Then there is a natural map $R\to\widehat R_\mathcal J$ by $r\mapsto\{r\}_{n\in\NN}$. If $\mathcal J$ is the $I$-adic filtration for a proper ideal $I$, and $R$ is local or a domain, then this map is injective.
\end{lemma}
\begin{proof}
	For now, denote the filtration $\mathcal J$ by
	\[R=I_0\supseteq I_1\supseteq I_2\supseteq\cdots.\]
	Let $\iota:R\to\widehat R_\mathcal J$ by $r\mapsto\{r\}_{n\in\NN}$. To see that $\iota$ is well-defined, we note that
	\[r\equiv r\pmod {I_s}\]
	for any ideal $I_s$ in the filtration $\mathcal J$, so we are done. To see that $\iota$ is a ring homomorphism, note that we have small ring homomorphisms
	\[\pi_s:R\onto R/I_s\]
	by $r\mapsto[r]_{I_s}$, which will glue into a larger map
	\[\pi:R\to\prod_{s\in\NN}R/I_s\]
	by $r\mapsto\{r\}_{s\in\NN}$. In particular, we see that $\iota=\pi$, and we are promised that $\pi$ is a ring homomorphism by universal property, so we are done.

	Now take $I$ to be a proper ideal and fix $I_s:=I^s$ so that $\mathcal J$ is the $I$-adic filtration. We show that $\iota$ is injective. Indeed, if $\iota(r)=0$, then we have that
	\[r\equiv0\pmod{I^s}\]
	for all $s$. In particular,
	\[r\in\bigcap_{s\in\NN}I^s.\]
	Thus, if $R$ is local or a domain, we see that \autoref{cor:krullintersect} forces $r=0$, so indeed, $\ker\iota$ is trivial, making $\iota$ injective.
\end{proof}
Notably, the image of an ideal need not be an ideal; for example, the inclusion $\ZZ\into\QQ$ does not map the ideal $\ZZ\subseteq\ZZ$ to an ideal of $\QQ$.

The above inclusion gives rise to the following definition, which is our motivation for the word ``completion.''
\begin{definition}[Complete]
	Fix a filtration $\mathcal J$ and a ring $R$. Then the ring $R$ is \textit{complete with respect to $\mathcal J$} if and only if $\widehat R_\mathcal J=R$, in that the natural map $\iota:R\to\widehat R_\mathcal J$ is an isomorphism.
\end{definition}
Before actually showing that the completion is complete, we need to talk about which filtration we are complete with respect to.
\begin{notation}
	Fix $R$ a ring and $\mathcal J$ a filtration. Then, given an ideal $I\subseteq R$ of the filtration $\mathcal J$, we let $\widehat I$ denote the kernel of the projection map (onto the $I$th coordinate) $\widehat R_\mathcal J\onto R$.
\end{notation}
Note that $\widehat R_\mathcal J\onto R$ is indeed surjective because $\iota(r)$ maps to $r$ under this projection.
\begin{remark}
	One might wish that we had used the ideal generated by $I$ under the natural map $R\to\widehat R_\mathcal J$ instead. We will show these notions coincide when $R$ is Noetherian later.
\end{remark}
Anyways, here is our result.
\begin{lemma}
	Fix $R$ a ring and $\mathcal J$ a filtration denoted by
	\[R=I_0\supseteq I_1\supseteq I_2\supseteq\cdots.\]
	Then the completion $\widehat R:=\widehat R_\mathcal J$ is a complete ring with respect to the induced filtration $\widehat{\mathcal J}$ given by
	\[\widehat R=\widehat{I_0}\supseteq \widehat{I_1}\supseteq \widehat{I_2}\supseteq\cdots.\]
\end{lemma}
\begin{proof}
	We very quickly check that $n>m$ implies $I_n\subseteq I_m$, so the kernel of $\widehat R\to R/I_n$ is smaller than the kernel of $\widehat R\to R/I_m$, so $\widehat{I_n}\subseteq\widehat{I_m}$. So indeed, $\widehat{\mathcal J}$ is indeed a filtration.

	Now, for notational ease, set $S:=\widehat R$ and $\widehat S:=\widehat S_{\widehat{\mathcal J}}$ its completion so that  we are showing that the map $\widehat\iota:S\to\widehat S$ is an isomorphism. We already know that $\widehat\iota$ is a ring homomorphism by \autoref{lem:naturalcompletionmap}, so it suffices to show that $\widehat\iota$ is a bijection.

	Well, by definition of $\widehat{I_s}$, we see that
	\[\pi_s:\widehat R/\widehat{I_s}\to R/I_s\]
	by $\{r_n\}_{n\in\NN}\mapsto[r_s]_{I_s}$ is an isomorphism. On the other hand, the map $\iota:R\to\widehat R/\widehat{I_s}$ takes $r$ to $\{[r]\}_{n\in\NN}$. In particular,
	\[\pi_s(\iota(r))=[r]_{I_s},\]
	so $I_s\subseteq\ker(\pi_s\circ\iota)$, so $\pi_s\circ\iota$ will induce a map $R/I_s\to R/I_s$ which is the identity. Because $\pi_s$ is an isomorphism, we see that $\ker\iota$ must be $I_s$, so we get an induced map $\iota_s:R/I_s\to\widehat R/\widehat{I_s}$ which is inverse to $\pi_s$ and therefore an isomorphism.

	We now glue the $\iota_s$ together to show $\widehat\iota$ is a bijection. Notably, they glue together to give us a bijection
	\[\varphi:\prod_{s\in\NN}R/I_s\to\prod_{s\in\NN}\widehat R/\widehat{I_s}\]
	by $\varphi:\{[r_s]\}_{s\in\NN}\mapsto\{[\iota(r_s)]_{\widehat{I_s}}\}_{s\in\NN}$. In particular, restricting to $\widehat R$, we see that the $n$th component comes out to
	\[\iota(r_n)\stackrel*\equiv\{[r_s]\}_{s\in\NN}=\left(\widehat\iota\left(\{[r_s]\}_{s\in\NN}\right)\right)_n\pmod{\widehat{I_n}},\]
	where we have to check $\stackrel*\equiv$ by hand on coordinates: for $m<n$, we have $r_n\equiv r_m\pmod{I_m}$, so $[r_n]=[r_m]$ here. For $m=n$, there is nothing to say, and for $m>n$, we note that $\iota(r_n)-\{[r_s]\}_{s\in\NN}$ now has a zero component in the $I_n$ term, so it lives in the kernel of the map $\widehat R\to R/I_n$, so we get our equivalence$\pmod{\widehat{I_n}}$.

	In particular, the glued map $\varphi$ is equal to $\widehat\iota$. Because $\varphi$ was injective, it follows that $\widehat\iota$ is also injective. We now show that $\widehat\iota$ is surjective. Well, given an element of
	\[\widehat S\subseteq\prod_{s\in\NN}\widehat R/\widehat{I_s},\]
	we note that it will have exactly one pull-back along $\varphi$, and $\varphi|_{\widehat R}=\widehat\iota$ as shown above, so it suffices to show that this pull-back is an element of $\widehat R$.
	
	Well, fix our element $\{\hat r_s\}_{s\in\NN}\in\widehat S$, where $\hat r_s=\{r_{s,q}\}_{q\in\NN}\in\widehat R$. The inverse map of $\varphi$ is made by gluing together the inverse maps of $\iota_s$, but we know these maps as $\pi_s$. Thus,
	\[\varphi^{-1}\left(\{\hat r_s\}_{s\in\NN}\right)=\{\iota_s^{-1}(\hat r_s)\}_{s\in\NN}=\{\pi_s(\hat r_s)\}_{s\in\NN}=\{r_{s,s}\}_{s\in\NN}\]
	To show that this is a well-defined element of $\widehat R$, it remains to show that $n>m$ has $r_{n,n}\equiv r_{m,m}\pmod{I_m}$. Well, at the very least we know that
	\[\{r_{n,q}\}_{n\in\NN}-\{r_{m,q}\}_{m\in\NN}\in\widehat{I_m}\]
	because $\{\hat r_s\}_{s\in\NN}\in\widehat S$, so we project $\{r_{n,q}\}_{n\in\NN}-\{r_{m,q}\}_{m\in\NN}$ onto the $m$th coordinate to be forced to have
	\[r_{n,m}\equiv r_{m,m}\pmod{I_m}\]
	by definition of $\widehat{I_m}$. However, $r_{n,n}\equiv r_{n,m}\pmod{I_n}$ because $\hat r_n\in\widehat R$, so we are done.
	% \begin{lemma}
	% 	Fix $R$ a ring and $\mathcal J$ a filtration denoted by
	% 	\[R=I_0\supeteq I_1\supseteq I_2\supseteq\cdots.\]
	% 	Then the natural map $\iota:R\to\widehat R_\mathcal J$ induces an isomorphism $\iota_s:R/I_s\to\widehat R_\mathcal J/\widehat{I_s}$ for any $s\in\NN$.
	% \end{lemma}
	% \begin{proof}
	% 	Set $\pi$ to be the composite
	% 	\[R\to\widehat R_\mathcal J/\widehat{I_s}.\]
	% 	We need to show that $\pi$ is surjective and has kernel $I_s$.
	% 	\begin{itemize}
	% 		\item We show that $\pi$ is surjective. Indeed, fix some $\{r_n\}_{n\in\NN}\in\widehat R_\mathcal J$ whose coset we want to represent. Well, we simply fix $r:=r_{s-1}$. Notably,
	% 		\[r=r_{s-1}\equiv r_k\pmod{I_k}\]
	% 		for each $k<s$, so we match in the first $s$ coordinates. It remains to show that $\{r_n\}_{n\in\NN}-\iota(r)\in\widehat{I_s}$.
	% 	\end{itemize}
	% \end{proof}
	% Fix some $a$ in the completion of $\widehat R_{\widehat {\mathcal J}}$.
\end{proof}

\subsection{The Krull Topology}
Let's have a little fun with our completions.
\begin{warn}
	The following two subsections (on the Krull topology and the topological interpretation of completion) are very topological in nature and were not covered in class. They appear in these notes because they are fun.
\end{warn}
\begin{defi}[Krull topology]
	Fix $R$ a ring and $\mathcal J$ a filtration. Then we define the \textit{Krull topology} on $R$ to have a basis consisting of $\emp$ as well as the open sets $a+I$ for any $a\in R$ and $I\in\mathcal J$.
\end{defi}
Here is our key example.
\begin{example}
	The standard topology on the $p$-adic integers $\ZZ_p$ is the Krull topology induced by the $(p)$-adic filtration.
\end{example}
We run some checks on this topology.
\begin{lemma}
	Fix $R$ a ring and $\mathcal J$ a filtration. Then the Krull topology is a topology.
\end{lemma}
\begin{proof}
	We merely have to check that the claimed open sets do in fact form a basis for a topology.
	\begin{itemize}
		\item We show that our basis covers $R$. Fixing any $I\in\mathcal J$, we note that
		\[\bigcup_{a\in R}(a+I)=R,\]
		so our open sets do cover $R$.
		\item We show that our basis is closed under intersection. Fix any two basis elements $a+I$ and $b+J$. Because $\mathcal J$ is a filtration, either $I\subseteq J$ or $J\subseteq I$; without loss of generality, take the former case.

		Now, if $b\equiv a\pmod J$, then $(a+I)\subseteq(b+J)$ because $I\subseteq J$. So here, we have $(a+I)\cap(b+J)=(a+I)$, implying that we are closed intersection.

		Otherwise, $b\not\equiv a\pmod J$, in which case $x\in a+I\subseteq a+J$ implies $x\notin b+J$, so $(a+I)\cap(b+J)=\emp$, finishing.
		\qedhere
	\end{itemize}
\end{proof}
\begin{lemma} \label{lem:krulltoporing}
	Fix $R$ a ring and $\mathcal J$ a filtration. Then the Krull topology makes $R$ into a topological ring; i.e., the addition and multiplication maps $R\times R\to R$ are both continuous.
\end{lemma}
\begin{proof}
	We run our checks separately.
	\begin{itemize}
		\item We show that the addition map $R\times R\to R$ is continuous. For brevity, name this map $f:R\times R\to R$ by $f(a,b)=a+b$. We need to show that the pre-image of any open set $U\subseteq R$ has $f^{-1}(U)\subseteq R\times R$ still open. Because we have a basis, it suffices to take $U$ to be a basis element.

		If $U=\emp$, then $f^{-1}(\emp)=\emp$, which is open. Otherwise, we are looking at $f^{-1}(x+I)$ for some open set $x+I$. Well,
		\begin{align*}
			f^{-1}(x+I)=\{(a,b):a+b\in x+I\} &= \bigcup_{(r+I)\in R/I}\{(a,b):a\in (r+I),b\in((x-a)+I)\} \\
			&= \bigcup_{(r+I)\in R/I}(r+I)\times((x-r)+I).
		\end{align*}
		Now, each of the sets $(r+I)\times((x-r)+I)$ are in fact open in the product topology $R\times R$, so we are done.

		\item We show that the multiplication map $R\times R\to R$ is continuous. Again, we set $g:R\times R\to R$ by $g(a,b):=ab$ to be our multiplication map. As with last time, it suffices to show that the pre-image of any basis element under $g$ is an open set in $R\times R$.

		If $U=\emp$, then $g^{-1}(\emp)=\emp$, which is open. Otherwise, we are looking at $g^{-1}(x+I)$ for some open set $x+I$. For this, we compute
		\[g^{-1}(x+I)=\{(a,b):ab\in x+I\}=\bigcup_{(r+I),(s+I)\in R/I}\{(a,b):a\in(r+I).b\in (s+I),ab\in (x+I)\}.\]
		At this point, we see $a\in r+I$ and $b\in s+I$ implies that $ab\in x+I$ if and only if $rs\in x+I$. Thus, we can move this condition outside and write
		\[g^{-1}(x+I)=\bigcup_{\substack{(r+I),(s+I)\in R/I\\rs\in x+I}}\{(a,b):a\in (r+I),b\in (s+I)\}=\bigcup_{\substack{(r+I),(s+I)\in R/I\\rs\in x+I}}(r+I)\times(s+I),\]
		which we can see is the union of basis of elements in $R\times R$.
		\qedhere
	\end{itemize}
\end{proof}
\begin{remark} \label{rem:krulladdandmultcont}
	Fix any $a\in R$. Because the map $x\mapsto(a,x)$ is a continuous map $R\to R\times R$ (it is the product of continuous maps), we see that the composites
	\[x\mapsto(a,x)\mapsto a+x\qquad\text{and}\qquad x\mapsto(a,x)\mapsto ax\]
	are also both continuous.
\end{remark}
The Krull topology need not always be Hausdorff, but it is Hausdorff for many well-behaved rings and filtrations.
\begin{example}
	Fix the ring $R:=\ZZ\times\ZZ$ and the proper ideal $I:=(2)\times\ZZ$, and endow $R$ with the Krull topology induced by the $I$-adic filtration. We claim that $\{0\}$ is not closed. 
\end{example}
\begin{lemma}
	Fix a Noetherian ring $R$ and a proper ideal $I\subsetneq R$, and endow $R$ with the Krull topology induced by the $I$-adic filtration. If $R$ is local or a domain, then $R$ is Hausdorff.
\end{lemma}
\begin{proof}
	The point is to use the Krull intersection theorem. Namely, we need to show that the sets $\{a\}\subseteq R$ are closed for any $a\in R$. Well, we note that, by \autoref{cor:krullintersect}, we have
	\[R\setminus\{0\}=R\mathbin{\bigg\backslash}\bigcap_{s\ge0}I^s=\bigcup_{s\ge0}\left(R\setminus I^s\right)=\bigcup_{s\ge0}\bigcup_{a\notin I^s}\left(a+I^s\right).\]
	So $R\setminus\{0\}$ is open, thus making $\{0\}$ closed.

	To finish, we cop out and use the fact that we live in a topological ring. Fixing any $a\in R$, note that \autoref{rem:krulladdandmultcont} tells us that the map $\mu_a:x\mapsto x-a$ is continuous. Thus, because $\{0\}$ is closed, we see that
	\[\mu_a^{-1}(\{0\})=\{a\}\]
	is also closed, finishing.
\end{proof}
So we see that the Krull topology is reasonably nice.

\subsection{Completions, Topologically}
For the discussion that follows, fix a ring $R$ with a filtration $\mathcal J$ given by
\[R=I_0\supseteq I_1\supseteq I_2\subseteq\cdots.\]
Now, in the example $\ZZ_p$, we see that we can define
\[d(a,b):=p^{-\max\left\{k\in\NN:a-b\in\left(p^k\right)\right\}},\]
which we can check forms a metric on $\ZZ_p$. In fact, this restricts to a metric on $\ZZ$, for which $\ZZ_p$ is the completion. (We will be able to justify this claim shortly.) This is our first hint of that the name ``completion'' should be a topological notion. In particular, it will turn out that a ring being ``complete'' with respect to a filtration means that every Cauchy sequence converges to some limit.

To generalize the case of $\ZZ_p$, we can still fix some $c>1$ and define the function
\[d(a,b):=c^{-\max\{k\in\NN:a-b\in I_k\}},\]
where $a,b\in R$. For our edge case, if $a-b\in I_k$ for arbitrarily large $k$, then $a-b\in I_k$ for each $k$, so we might as well set $d(a,b)=0$.

This edge case, ultimately, is where we are going to have problems: it is possible for the intersection of all the $I_k$ to be nonzero, in which case any element
\[r\in\bigcap_{k\ge0}I_k\]
would have $d(r,0)=0$, so $d$ cannot be a metric. However, this is the only obstruction.
\begin{lemma} \label{lem:krullmetric}
	Fix a ring $R$ with a filtration $\mathcal J$, notated
	\[R=I_0\supseteq I_1\supseteq I_2\supseteq\cdots.\]
	Further, suppose that $x\in I$ for each $I\in\mathcal J$ implies $x=0$. Then, fixing a real number $c>1$, the function $d:R^2\to\RR$ defined by
	\[d(a,b):=\begin{cases}
		c^{-\max\{k\in\NN:a-b\in I_k\}} & a-b\notin I_n\text{ for some }n, \\
		0 & \text{else},
	\end{cases}\]
	is a metric on $R$.
\end{lemma}
\begin{proof}
	Observe that the function $d$ is well-defined because $a-b\notin I_k$ for some $n$ implies that $a-b\notin I_m$ for any $m\ge n$ because $I_m\subseteq I_n$, so this means that the set $\{k\in\NN:a-b\in I_k\}$ does indeed have a maximum.
	
	We have the following checks on $d$.
	\begin{itemize}
		\item Identity: fix $a,b\in R$. Note that $d(a,b)=0$ if and only if $a-b\in I_k$ for each $I_k\in\mathcal J$, so $a-b=0$ by hypothesis on $\mathcal J$, so $a=b$. Conversely, if $a=b$, then $a-b\in I_k$ for each $k$, so $d(a,b)=0$.
		\item Symmetry: fix $a,b\in R$. Then $a-b\in I_k$ if and only if $-1(a-b)=b-a\in I_k$, so
		\[\{k\in\NN:a-b\in I_k\}=\{k\in\NN:b-a\in I_k\}.\]
		If both of these sets are $\NN$, then $d(a,b)=d(b,a)=0$. Otherwise, these sets have maximums, which must be the same $M\in\NN$, so $d(a,b)=c^{-M}=d(b,a)$.
		\item Triangle inequality: fix $a,b,c\in R$. We need to show that
		\[d(a,b)+d(b,c)\ge d(a,c).\]
		If $a=b$ or $b=c$, then this inequality collapses to $d(x,y)\ge d(x,y)$.

		The point is that if $a-b\in I_k$ and $b-c\in I_\ell$, then $a-c=a-b+b-c\in I_{\min\{k,\ell\}}$. In particular, fix
		\[m:=\max\{k\in\NN:a-b\in I_k\}\qquad\text{and}\qquad n:=\max\{\ell\in\NN:b-c\in I_\ell\}.\]
		Without loss of generality, we take $m\le n$, which implies that $a-c=(a-b)+(b-c)\in I_m+I_n\subseteq I_m$, so
		\[d(a,c)\le c^{-m}\le c^{-m}+c^{-n}=d(a,b)+d(b,c).\]
		This is what we wanted.
	\end{itemize}
	These checks finish showing that $d$ is a metric on $R$.
\end{proof}
Continuing with our story, as with $\ZZ_p$, we see that elements of $R$ are considered ``close'' if and only if their difference lies in the same ``small'' open set. In particular, for any $x\in R$ and $r\in\RR^+$, some $a\in R$ has
\begin{align*}
	d(a,x)<r &\iff c^{-\max\{k\in\NN:a-x\in I_k\}}<r \\
	&\iff -\max\{k\in\NN:a-x\in I_k\}<\log_cr \\
	&\iff \max\{k\in\NN:a-x\in I_k\}>-\log_cr \\
	&\iff a-x\in I_k\text{ for some }k>-\log_cr \\
	&\iff a\in x+I_{\ceil{-\log_cr}}.
\end{align*}
Thus, any $r>0$ will make $\{a\in R:d(a,x)<r\}=x+I_{\ceil{-\log_cr}}$ into some open set (where $I_k=R$ for $k<0$); conversely, any open basis element $x+I_k$ arises in this way by choosing $r=c^{-k}$.

So it looks like our function $d$ correctly induces the Krull topology as a metric. Of course, we need to overcome the Hausdorff obstruction for this to make sense, but we do have the following lemma.
\begin{lemma}
	Work in the context of \autoref{lem:krullmetric}. Then the metric topology induced by $d$ is the Krull topology induced by $\mathcal J$.
\end{lemma}
\begin{proof}
	We get that $d$ is a metric from \autoref{lem:krullmetric}. Further, $d$ induces the Krull topology from the computation above.
\end{proof}
With all of this set-up, it makes sense to think about the Krull topology as a metric space, which is the context where ``completions'' actually make topological sense: we want every Cauchy sequence to have a limit. In order to stop talking about topology (and worrying about the Hausdorff condition), we would like to translate these notions back to algebra.

Let's start with limits. An element $a\in R$ is a limit of the sequence $\{a_n\}_{n\in\NN}\subseteq R$ (with respect to  $d$) means that
\[\lim_{n\to\infty}d(a,a_n)=0.\]
By definition of $d$, this is the same as requiring
\[\lim_{n\to\infty}\max\{k\in\NN:a-a_n\in I_k\}=\infty.\]
This means that, for any bound $m\in\NN$, there exists some $N$ such that $n>N$ implies $\max\{k\in\NN:a-a_n\in I_k\}>m$. However, this last condition is equivalent to $a-a_n\in I_m$ because $\mathcal J$ is a filtration. So we have the following definition.
\begin{definition}[Limit]
	Fix a ring $R$ with a filtration $\mathcal J=\{I_k\}_{k\in\NN}$. Then we say that an element $a\in\widehat R$ is the \textit{limit} of a sequence $\{a_n\}_{n\in\NN}$ if and only if, for each $m$, there exists $N$ such that $a_n-a\in I_m$ for each $n>N$.
\end{definition}
Now let's move to Cauchy sequences. A sequence $\{a_n\}_{n\in\NN}\subseteq R$ is Cauchy (with respect to $d$) if and only if, for any $\varepsilon>0$, there exists $n$ such that $k,\ell>N$ implies
\[d(a_k,a_\ell)<\varepsilon.\]
By replacing $\varepsilon$ with $-\log_c\varepsilon$, this is equivalent to saying that, for any $m\in\NN$, there exists $N$ such that $k,\ell>N$ implies
\[\max\{n\in\NN:a_k-a_\ell\in I_n\}\ge m,\]
or equivalently, $a_k-a_\ell\in I_m$. So we have the following definition.
\begin{definition}[Cauchy sequence]
	Fix a ring $R$ with a filtration $\mathcal J=\{I_k\}_{k\in\NN}$. Then we say that a sequence $\{a_k\}_{k\in\NN}$ is \textit{Cauchy} if and only if, for each $m$, there exists $N$ such that $a_k-a_\ell\in I_m$ for each $k,\ell>N$.
\end{definition}
We are finally able to unite our two notions of completion.
\begin{prop} \label{prop:unitecompletion}
	Fix a ring $R$ with a filtration $\mathcal J$ such that $x\in I$ for each $I\in\mathcal J$ implies $I=0$. Then $\widehat R_\mathcal J$ is the completion of $R$ with respect to the Krull (metric) topology, where the needed inclusion $R\to\widehat R_\mathcal J$ is the canonical one.
\end{prop}
\begin{proof}
	We already have that $R$ is a metric space from \autoref{lem:krullmetric}. We will construct $\widehat R$ as the completion of the metric space for $R$ and then show that $\widehat R\cong\widehat R_\mathcal J$ as topological rings.

	The completion $\widehat R$ consists of equivalence classes of Cauchy sequences of $R$, where two Cauchy sequences $\{a_n\}_{n\in\NN}\sim\{b_n\}_{n\in\NN}$ if and only if
	\[d(a,b):=\lim_{n\to\infty}d(a_n,b_n)=0.\]
	Very quickly, we let $S$ be the set of Cauchy sequences of $R$, and we note that we can give $S\subseteq R^\NN$ a subring structure, with operations given by
	\[\{a_n\}_{n\in\NN}+\{b_n\}_{n\in\NN}:=\{a_n+b_n\}_{n\in\NN}\qquad\text{and}\qquad\{a_n\}_{n\in\NN}\cdot\{b_n\}_{n\in\NN}:=\{a_nb_n\}_{n\in\NN}.\]
	We quickly check that $S$ is closed under these operations: for any bound $m\in\NN$, there exists $N$ such that $k,\ell>N$ implies $a_k-a_\ell,b_k-b_\ell\in I_m$, so
	\[(a_k+b_k)-(a_\ell+b_\ell)\in I_m\qquad\text{and}\qquad a_kb_k-a_\ell b_\ell\in I_m\]
	follows. To finish checking that $S$ is a subring, we merely note that $\{1_R\}_{n\in\NN}$ is a Cauchy sequence.
	
	Now, $\widehat R$ is $S$ modded out by the equivalence relation $\sim$ described above. To make this notion more ring-theoretic, we set
	\[I:=\{a\in S:a\sim0\}.\]
	In particular $\{a_n\}_{n\in\NN}\sim\{b_n\}_{n\in\NN}$ if and only if
	\[0=\lim_{n\to\infty}d(a_n,b_n)=\lim_{n\to\infty}d(a_n-b_n,0)\]
	if and only if $\{a_n\}_{n\in\NN}-\{b_n\}_{n\in\NN}\in I$. Thus, we see that $\widehat R=S/I$, as sets. However, we in fact claim that $I$ is an ideal: if $\{a_n\}_{n\in\NN},\{b_n\}_{n\in\NN}\in I$ and $\{r_n\}_{n\in\NN},\{s_n\}_{n\in\NN}\in S$, then we need to show that
	\[\{r_na_n+s_nb_n\}_{n\in\NN}\in I.\]
	Well, $d(a_n,0)\to0$ and $d(b_n,0)\to0$ as $n\to\infty$, so for any $m$, there exists $N$ such that $n>N$ implies $a_n,b_n\in I_m$, so $r_na_n+s_nb_n\in I_m$. Thus, $d(r_na_n+s_nb_n,0)\to0$ as $n\to\infty$.

	Thus, we have given $\widehat R:=S/I$ a ring structure as well as a topology. We claim that $S/I\cong\widehat R_J$; it will happen that this is also an isomorphism of topological rings, but we won't check the topological aspects of this isomorphism. We start by defining
	\[\varphi:S\to\widehat R_J.\]
	For this, we take some Cauchy sequence $\{a_n\}_{n\in\NN}$. Then, for any index $m\in\NN$, there exists $N_m$ such that $k,\ell\ge N_m$ implies $a_k-a_\ell\in I_m$. As such, we define
	\[\varphi\left(\{a_n\}_{n\in\NN}\right):=\left\{[a_{N_m}]_{I_m}\right\}_{n\in\NN}.\]
	We have the following checks on $\varphi$.
	\begin{itemize}
		\item To start, we see that $[a_{N_m}]_{I_m}$ is well-defined: if $N_m'$ is another constant such that $k,\ell\ge N_m'$ implies $a_k-a_\ell\in I_m$, then without loss of generality $N_m\ge N_m'$ so that $a_{N_m}-a_{N_m'}\in I_m$, so $[a_{N_m}]_{I_m}=[a_{N_m'}]_{I_m}$.
	
		\item Further, $\varphi$ does actually output an element of $\widehat R_J$. We need to show that $a_{N_{m+1}}\equiv a_{N_m}\pmod{I_m}$ for any $m\in\NN$. Well, $N_{m+1}$ satisfies $k,\ell\ge N_{m+1}$ implies $a_k-a_\ell\in I_{m+1}\subseteq I_m$, so the argument from the previous point shows that
		\[[a_{N_{m+1}}]_{I_m}=[a_{N_m}]_{I_m},\]
		which is what we wanted.
	
		\item We show $\varphi$ is surjective. Well, suppose that we have an element
		\[\{[a_m]_{I_m}\}\in\widehat R_\mathcal J.\]
		Well, we claim that $\{a_m\}_{m\in\NN}$ is itself a Cauchy sequence, which will be our pre-image element. To see that this is a Cauchy sequence, we note that any $m\in\NN$ has $k,\ell>m$ has
		\[a_k-a_\ell\in I_{\min\{k,\ell\}}\subseteq I_m.\]
		In fact, this computation shows that, in our definition of $\varphi(\{a_n\}_{n\in\NN})$, we can set $m:=N_m$ so that
		\[\varphi(\{a_n\}_{n\in\NN})=\{[a_{N_m}]_{I_m}\}_{m\in\NN}=\{[a_m]_{I_m}\}_{m\in\NN},\]
		which is what we wanted.

		\item We show $\varphi$ has kernel $I$. In one direction, if $\{a_n\}_{n\in\NN}\in I$, we see that, for any $m\in\NN$, there exists $N_m$ for which $a_n\in I_m$ for each $n\ge N_m$. Thus, $k,\ell\ge N_m$ will have $a_k-a_\ell\in I_m$, so we can set
		\[\varphi\left(\{a_n\}_{n\in\NN}\right)=\{[a_{N_m}]_{I_m}\}_{m\in\NN}=\{[0]\}_{m\in\NN},\]
		which is what we wanted.
		
		Conversely, suppose that $\{a_n\}_{n\in\NN}$ goes to $0$ under $\varphi$. This means that, for any $m\in\NN$, there exists $N_m$ such that $k,\ell\ge N_m$ will have $a_k-a_\ell\in I_m$ and
		\[a_{N_m}\in I_m.\]
		In particular, we see that any $k\ge N_m$ will have $a_k\in a_{N_m}+I_m=I_m$. So indeed, $a_n\to0$ as $n\to\infty$.
	\end{itemize}
	The above checks finish showing our isomorphism of rings. We could show that $\varphi$ is continuous as well (but won't do so here); the third point explicitly constructs our inverse, which we could also show is continuous (but again won't do it here).

	We close the proof by remarking that, because the canonical maps $R\to\widehat R_\mathcal J$ and $R\to\widehat R$ above both simply take $r\in R$ to the constant sequence $\{[r_n]\}_{n\in\NN}\in\widehat R_\mathcal J$ and $\{r_n\}_{n\in\NN}+I\in\widehat R$ (respectively), we see that the following diagram commutes.
	% https://q.uiver.app/?q=WzAsNCxbMCwwLCJSIl0sWzEsMCwiXFx3aWRlaGF0IFIiXSxbMSwxLCJcXHdpZGVoYXQgUl9cXG1hdGhjYWwgSiJdLFswLDEsIlIiXSxbMCwxXSxbMywyXSxbMSwyLCJcXHZhcnBoaSJdLFswLDMsIiIsMSx7ImxldmVsIjoyLCJzdHlsZSI6eyJoZWFkIjp7Im5hbWUiOiJub25lIn19fV1d
	\[\begin{tikzcd}
		R & {\widehat R} \\
		R & {\widehat R_\mathcal J}
		\arrow[from=1-1, to=1-2]
		\arrow[from=2-1, to=2-2]
		\arrow["\varphi", from=1-2, to=2-2]
		\arrow[Rightarrow, no head, from=1-1, to=2-1]
	\end{tikzcd}\]
	Indeed, going along the top, we take $r\in R$ to $\{r\}_{n\in\NN}$ to $\{[r]\}_{n\in\NN}$, which is the same as we get along the bottom. This shows that we can make $\widehat R_\mathcal J$ is not only isomorphic to the metric completion $\widehat R$, but in fact, the canonical inclusion $R\to\widehat R_\mathcal J$ is the inclusion needed by the completion.
\end{proof}
And just for fun, let's unite our notions of complete.
\begin{corollary}
	Fix a ring $R$ and a filtration $\mathcal J=\{I_k\}_{k\in\NN}$ such that $x\in I$ for all $I\in\mathcal J$ implies $x=0$. Then $R$ is complete with respect to the filtration $\mathcal J$ if and only if $R$ is complete with respect to the Krull (metric) topology.
\end{corollary}
\begin{proof}
	Note $R$ is complete with respect to the Krull (metric) topology if and only if $R$ is homeomorphic to its completion. But by \autoref{prop:unitecompletion}, we see that the metric completion of $R$ is $\widehat R_\mathcal J$ with the canonical inclusion $\iota:R\to\widehat R_\mathcal J$.

	We already know that $\iota$ is injective because $x\in I$ for each $I\in\mathcal J$ implies $x=0$. Thus, the only thing to worry about is that $\iota$ is surjective. Well, $\iota$ is surjective if and only if $\iota$ is an isomorphism of rings (because $\iota$ is a priori an injective homomorphism of rings), so $R$ is metrically complete if and only if $\iota:R\to\widehat R_\mathcal J$ is an isomorphism. This finishes.
\end{proof}
% As an aside, we note that, if we have a sequence $a:=\{a_k\}_{k\in\NN}\in\widehat R_\mathcal J$, then we have $a_{i+1}-a_i\in\mf I_n$, so we can write
% \[a=\sum_{j=1}^\infty(a_{j+1}-a_j)\]
% to be an infinite convergent series; in particular, the partial sums converge.

\subsection{Properties Preserved by Completion}
Taking the completion also tends to look like localization.
\begin{proposition} \label{prop:completelocalize}
	Fix $R$ complete with respect to an $I$-adic filtration. Then any element $1-a$ with $a\notin I$ is a unit.
\end{proposition}
\begin{proof}
	We see that
	\[(1-a)^{-1}=1+a+a^2+\cdots\]
	will work, essentially by just summing an infinite geometric series.
\end{proof}
\begin{corollary}
	Fix $R$ a ring and $\mf m$ a maximal ideal. Then $\widehat R_\mf m$ is a local ring with maximal ideal $\mf m\widehat R_\mf m$.
\end{corollary}
\begin{proof}
	We need to check that $a\notin\mf m\widehat R_\mf m$ implies that $a$ is a unit. Well, we can write out
	\[a=\sum_{k=0}^nb_k\]
	where $b_k\in\mf m^k$. We can select $b$ so that $ab\equiv1\pmod{\mf m}$ because $R/\mf m$ is a field, so we see that $ab=1+c$ for some $c\in\mf m$. But now \autoref{prop:completelocalize} assures us that $1+c$ is a unit, so $a$ must be a unit also.
\end{proof}
In fact, we can see how similar completion looks like localization by how it focuses on $\mf m$.
\begin{lemma}
	We have that $R/\mf m^n\cong\widehat R/\mf m\widehat R_\mf m^n$.
\end{lemma}
\begin{proof}
	This is by definition of $\mf m\widehat R_\mf m^n$.
\end{proof}
And now we can glue these isomorphisms together.
\begin{corollary}
	We have that $\op{gr}_\mf mR\cong\op{gr}_{\mf m\widehat R_\mf m}\widehat R_\mf m$.
\end{corollary}
\begin{proof}
	Glue together the isomorphisms of the preceding result. The multiplicative structure matches.
\end{proof}
We can also say the following.
\begin{theorem}
	Fix $R$ a Noetherian ring and $\mf m\subseteq R$ an ideal. Then $\widehat R_\mf m$ is Noetherian.
\end{theorem}
\begin{proof}
	We need the following lemma.
	\begin{lemma}
		Fix $R$ a ring complete with respect to the filtration $\mathcal J$ denoted by
		\[R=I_0\supseteq I_1\supseteq I_2\supseteq\cdots.\]
		Further, if we have $I=(a_1,\ldots,a_n)$, then $(\op{in}I)=(\op{in}a_1,\ldots,\op{in}a_n)$.
	\end{lemma}
	\begin{proof}
		Suppose for the sake of contradiction that we have some element $f\notin(\op{in}a_1,\ldots,\op{in}a_n)$. But now, we can write
		\[f=\sum_{i=1}^na_ig_i\]
		for some elements $g_i$, so if $f\in I^d\setminus I^{d+1}$, then we have
		\[\op{in}f=\Bigg[\sum_{i=1}^na_kg_i\Bigg]_{\mf m^{d+1}}.\]
		Now, lifting the elements $g_i$ to the completion, we hit our contradiction because the above should be an equality.
	\end{proof}
	We now attack the proof of the theorem. Well, fix some ideal $I\subseteq\widehat R_\mf m$. Then we project $I$ into $\op{gr}_\mf mR$, which is equal to $\op{gr}_{\mf m\widehat R_\mf m}\widehat R_\mf m$, and here we see that $I$ must be finitely generated because $\op{gr}_\mf mR$ needs to be Noetherian as lifted from $R$, by the lemma. So we are done.
\end{proof}
We close by stating the following theorem.
\begin{definition}[Completion, modules]
	Fix $R$ a ring with filtration $\mathcal J$ denoted by
	\[R=I_0\supseteq I_1\supseteq I_2\supseteq\cdots.\]
	Further, given an $R$-module $M$, there is an induced filtration
	\[M=I_0M\supseteq I_1M\supseteq I_2M\supseteq\cdots.\]
	Doing the same construction as for $\widehat R$ gives rise to $\widehat R$.
\end{definition}
We can check that $\widehat M$ is an $\widehat R$-module.

We have the following, which says that completion is really looking like localization.
\begin{theorem}
	Fix $R$ a Noetherian ring with ideal $I$. Given a finitely generated module $M$, we have
	\[\widehat M_\mf m\cong\widehat R_\mf m\otimes_RM.\]
	In fact, $\widehat R_\mf m$ is a flat $R$-module.
\end{theorem}
\begin{proof}
	We will show this next time.
\end{proof}