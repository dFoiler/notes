% !TEX root = ../notes.tex

We're back, y'all.

\subsection{A Quick Exercise}
Let's start with an exercise, to review for the midterm. Recall the following result.
\begin{lem}[Eisenbud 6.4]
	Fix $R$ a ring and $S:=R[x_1,\ldots,x_n]/(f)$, where $f$ is some polynomial. Then $S$ is a flat $R$-algebra if and only if $\op{cont}f=R$.
\end{lem}
\begin{proof}
	This was on the homework.
\end{proof}
And here is our exercise.
\begin{exe}
	Fix $R:=k[x,y]$ with maximal ideal $\mf m:=(x,y)$, and we consider the blow-up ring
	\[S:=\op B_\mf mR:=R\oplus\mf m\oplus\mf m^2\oplus\cdots.\]
	Now, we ask if $S$ is a flat $R$-module.
\end{exe}
\begin{proof}
	Heuristically, the fiber at any point except for $(0,0)$ is a point, but the fiber over $(0,0)$ is the full projective line. So these fibers are pretty poorly behaved, so we expect this to not be a flat module.

	Well, by staring hard at our grading, we see that
	\[S\cong k[x,y,tx,ty]\cong\frac{k[x,y,z,w]}{(yz-xw)},\]
	where the point is that we induce the right-hand isomorphism by $tx\mapsto z$ and $ty\mapsto w$. As such, we see that this module is not flat because the polynomial $f(z,w)=yz-xw$ has coefficients which generate $\op{cont}(f)=(x,y)\ne R$. In particular, we have ``detected'' the fiber over the origin.
\end{proof}

\subsection{The Krull Dimension}
\begin{warn}
	For effectively the rest of the course, all of our rings will be Noetherian. This hypothesis will only occasionally be stated.
\end{warn}
Recall the following definition.
\krulldimdef*
\noindent This gives rise to the following definitions.
\begin{definition}[Krull dimension, ideals]
	Fix a ring $R$ and an ideal $I\subseteq R$. Then we define the \textit{dimension} of an ideal $I$ to be $\dim I:=\dim R/I$.
\end{definition}
\begin{definition}[Codimension]
	Fix $I$ a proper ideal of a ring $R$.
	\begin{itemize}
		\item If $I=\mf p$ is a prime ideal of $R$, then we define the \textit{codimension} as $\codim\mf p:=\dim R_\mf p$.
		\item More generally, we define the \textit{codimension} as
		\[\codim I:=\min_{\mf p\subseteq I}\codim\mf p,\]
		where the minimum is over all prime ideals $\mf p$ containing $I$.
	\end{itemize}
\end{definition}
We quickly check the well-definedness of these definitions. To start, we give more hands-on characterizations of these definitions.
\begin{lemma} \label{lem:dimisascend}
	Fix an ideal $I$ of a ring $R$. Then $\dim I$ is equal to the length of the longest chain of primes
	\[I\subseteq\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_d\]
	in $R$.
\end{lemma}
\begin{proof}
	Let $\pi:R\onto R/I$ be the natural projection. In one direction, suppose that
	\[I\subseteq\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_d\]
	is the longest possible such chain of primes in $R$. Then, projecting down via $\pi$, we get a chain
	\[\pi\mf p_0\subseteq\pi\mf p_1\subseteq\cdots\subseteq\pi\mf p_d.\tag{1}\label{eq:chaininquotient}\]
	We have two checks.
	\begin{itemize}
		\item If $\mf p$ is a prime ideal containing $I$, then we claim $\pi\mf p$ is also a prime ideal. Indeed, if $(a+I)(b+I)\in\pi\mf p$ implies $ab+I\in\pi\mf p$ implies $ab+x\in\mf p$ for some $x\in I$ implies $ab\in\mf p$ because $I\subseteq\mf p$.
		
		Thus, because $\mf p$ is prime, $a\in\mf p$ or $b\in\mf p$, so $a+I\in\pi\mf p$ or $b+I\in\pi\mf p$.

		\item If $I_1\subsetneq I_2$ are distinct ideals containing $I$, then we claim $\pi(I_1)\subsetneq\pi(I_2)$. Indeed, we claim that $\pi(I_1)=\pi(I_2)$ would imply $I_1=I_2$; by symmetry, it suffices to show that $\pi(I_1)\subset\pi(I_2)$ implies $I_1\subseteq I_2$.

		Well, fix any $a\in I_1$. Then $\pi(a)\in\pi(I_1)\subseteq\pi(I_2)$, so $a+I\in\pi(I_2)$, so there exists $b\in I_2$ such that
		\[a+I=b+I.\]
		Then $a-b\in I\subseteq I_2$, so $a\in b+I_2=I_2+I_2=I_2$. Thus, $I_1\subseteq I_2$.

		By symmetry, we see that $\pi(I_2)\subseteq\pi(I_1)$ implies $I_2\subseteq I_1$ as well. Thus, $\pi(I_1)=\pi(I_2)$ implies both $\pi(I_1)\subseteq\pi(I_2)$ and $\pi(I_2)\subseteq\pi(I_1)$ and so $I_1\subseteq I_2$ and $I_2\subseteq I_1$, giving $I_1=I_2$.
	\end{itemize}
	Thus, \autoref{eq:chaininquotient} provides a chain of distinct primes in $R/I$, so $d\le\dim R/I$.

	In the other direction, suppose that we have chosen our largest possible chain of distinct primes
	\[\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_{\dim R/I}\]
	in $R/I$. Pulling backwards, we get a chain of primes
	\[\pi^{-1}\mf p_0\subseteq\pi^{-1}\mf p_1\subseteq\cdots\subseteq\pi^{-1}\mf p_{\dim R/I}.\tag{2}\label{eq:chainabovei}\]
	Notably, $(0)\subseteq\mf p_k$ for each prime $\mf p_k\subseteq R/I$ above, so $I=\pi^{-1}(0)\subseteq\pi^{-1}\mf p_k$ for each prime $\pi^{-1}\mf p_k$, so all these primes contain $I$.

	Additionally, we check that distinct $R/I$-ideals $I_1\ne I_2$ will have $\pi^{-1}(I_1)\ne\pi^{-1}(I_2)$. Indeed, we claim that $\pi^{-1}(I_1)=\pi^{-1}(I_2)$ implies $I_1=I_2$. To see this, we show $\pi^{-1}(I_1)\subseteq\pi^{-1}(I_2)$ implies $I_1\subseteq I_2$. Well, pick up $a+I\in I_1$ so that $\pi(a)\in I_1$, implying
	\[a\in\pi^{-1}(I_1)\subseteq\pi^{-1}(I_2)\]
	and hence $a+I=\pi(a)\in I_2$ as well.
	
	Now, by symmetry, we see that $\pi^{-1}(I_2)\subseteq\pi^{-1}(I_1)$ will also imply $I_2\subseteq I_1$, so when we have both in the equality $\pi^{-1}(I_1)=\pi^{-1}(I_2)$, we will have both $I_1\subseteq I_2$ and $I_2\subseteq I_1$. Thus, $I_2=I_2$.

	In total, \autoref{eq:chainabovei} now provides us with a chain of $\dim R/I$ distinct primes above $I$ in $R$, showing that $\dim R/I\le d$. This finishes the proof, for we now have $d=\dim R/I$.
\end{proof}
\begin{lemma} \label{lem:codimisdescend}
	Fix a prime ideal $\mf p$ of a ring $R$. Then $\codim\mf p$ is equal to the length of the longest chain of primes
	\[\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_d=\mf p,\]
	where $\mf p$ is included in the chain; i.e., $\codim\mf p=d$ here.
\end{lemma}
\begin{proof}
	Let $\iota:R\to R_\mf p$ denote the natural inclusion. In one direction, suppose that
	\[\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_d=\mf p\]
	is the longest possible chain of distinct prime ideals below $\mf p$. Notably, none of these primes have intersection with $R\setminus\mf p$ because they are contained in $\mf p$, so \autoref{thm:localizedprimes} (combined with \autoref{lem:localidealsa} to give the inverse map) tells us that we have a chain of primes
	\[\mf p_0R_\mf p\subsetneq\mf p_1R_\mf p\subsetneq\cdots\subsetneq\mf p_dR_\mf p=\mf pR_\mf p.\]
	By the bijection of \autoref{thm:localizedprimes}, we are getting an ascending chain of distinct primes, so we see $\dim R_\mf p\ge d$, as needed

	In the other direction, suppose that we have chain of distinct primes
	\[\mf q_0\subsetneq\mf q_1\subsetneq\cdots\subsetneq\mf q_{\codim\mf p}.\]
	Notably, $R_\mf p$ is a local ring with maximal ideal $\mf pR_\mf p$, so  if the prime $\mf q_{\codim\mf p}$ is not equal to $\mf pR_\mf p$, then $\mf q_{\codim\mf p}\subsetneq\mf pR_\mf p$, allowing us to add an extra prime to the list and violating the definition of $\codim\mf p=\dim R_\mf p$. So we must have $\mf q_{\codim\mf p}=\mf pR_\mf p$.

	Now, applying \autoref{thm:localizedprimes} once more, we get a chain of primes
	\[\iota^{-1}\mf q_0\subsetneq\iota^{-1}\mf q_1\subsetneq\cdots\subsetneq\iota^{-1}\mf q_{\codim\mf p}=\iota^{-1}(\mf pR_\mf p),\]
	which remain distinct by our bijection. In particular, $\iota^{-1}\mf q_{\codim\mf p}=\iota^{-1}\left(\mf pR_\mf p\right)=\mf p$ because $\iota^{-1}:I\mapsto\iota^{-1}I$ is inverse to $I\mapsto IR_\mf p$ by \autoref{lem:localidealsa}.

	Thus, we see that we have exhibited a chain of $\codim\mf p$ primes below $\mf p$, so we see that $\dim R_\mf p\le d$ as well. Combining with our previous inequality, we are done.
\end{proof}
\begin{lemma}
	Fix an ideal $I$ of a ring $R$. The two definitions of codimension of an ideal coincide when $I$ is a prime ideal.
\end{lemma}
\begin{proof}
	For this proof, we will ignore the second definition when discussing codimension of a prime ideal. We need to show that
	\[\codim I=\min_{\mf p\supseteq I}\codim\mf p\]
	and in particular that one is finite when the other is finite.

	In one direction, note that $I\supseteq I$ implies that
	\[\codim I\ge\min_{\mf p\supseteq I}\codim\mf p\]
	because the ideal $I$ is contained in the ideal. In the other direction, we note that we can find a chain of primes
	\[\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subseteq\mf p_{\codim I-1}\subsetneq I\]
	by \autoref{lem:codimisdescend}. As such, by tacking on the prime $\mf p\supseteq I$ to the end, we get a chain of length at least $\codim I$ distinct primes descending from $\mf p$, so \autoref{lem:codimisdescend} again tells us that
	\[\codim\mf p\ge\codim I.\]
	It follows that $\min_{\mf p\supseteq I}\mf p\ge\codim I$, and this inequality finishes the proof.
\end{proof}
These results give us the following proposition, which finishes our well-definedness checks.
\begin{prop}
	Fix a ring $R$ such that $\dim R$ is finite. Then, for any proper ideal $I$, both $\dim I$ and $\codim I$ are finite.
\end{prop}
\begin{proof}
	We prove the statements in steps.
	\begin{itemize}
		\item We show that $\dim I$ is finite. Well, by \autoref{lem:dimisascend}, we note that $\dim I$ is equal to the length of the longest possible chain of distinct primes
		\[I\subseteq\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_d.\]
		However, ignoring the $I$ and viewing this as a chain of distinct primes in $R$, we see that $d\le\dim R$ is forced, and in particular, $\dim I$ must be finite.
		\item We show that $\codim\mf p$ is finite when $\mf p$ is a prime ideal. By \autoref{lem:codimisdescend}, we note that $\codim\mf p$ is equal to the length of the longest possible chain of distinct primes
		\[\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_d=\mf p.\]
		Again ignoring the $\mf p$ at the end and viewing this as a chain of distinct primes in $R$, we see that $d\le\dim R$ is forced, and in particular, $\codim\mf p$ must be finite.
		\item We show that $\codim I$ is finite when $I$ is any ideal. Well, we note that $I$ is contained in some maximal and hence prime ideal because $I$ is proper, so
		\[\{\codim\mf p:\mf p\supseteq I\}\]
		is nonempty and only contains natural numbers by our previous checks. So the well-ordering of $\NN$ promises us that we have a minimum, finishing.
		\qedhere
	\end{itemize}
\end{proof}
As a reward for all of our hard work, we note that we have the following nice result: dimension can be computed locally.
\begin{theorem} \label{thm:dimislocal}
	Fix a ring $R$. Then
	\[\dim R=\max_{\mf p\in\op{Spec}R}\dim R_\mf p\]
\end{theorem}
\begin{proof}
	The point is to use \autoref{lem:codimisdescend}.
	
	By \autoref{lem:codimisdescend}, we see that $\dim R_\mf p=\codim\mf p$ is equal to the length of the largest chain of distinct primes below $\mf p$ in $R$. Because such a chain of primes below $\mf p$ is still a chain of primes in $R$, we conclude $\codim\mf p\le\dim R$ for each prime $\mf p$. Thus,
	\[\max_{\mf p\in\op{Spec}R}\dim R_\mf p\le\dim R.\]
	In the other direction, we know that we have a chain of distinct primes
	\[\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_{\dim R}\]
	in $R$. But this is a chain of distinct primes below $\mf p_{\dim R}$, so we conclude $\codim\mf p_{\dim R}\ge\dim R$ by \autoref{lem:codimisdescend}. Thus,
	\[\max_{\mf p\in\op{Spec}R}\dim R_\mf p\ge\codim\mf p_{\dim R}\ge\dim R.\]
	Combining with the previous inequality, we are done.
\end{proof}

\subsection{Bounds on Dimension}
With our checks out of the way, here are some examples.
\begin{example}
	Fix $R:=\ZZ$, which has $\dim\ZZ=1$. Then $\codim(0)=\dim\ZZ_{(0)}=\dim\QQ=0$; in fact, $\dim(0)=1$.
\end{example}
\begin{example}
	Similarly, if $p$ is a positive prime, one can show that
	\[\codim(p)=\dim\ZZ_p=1\]
	by showing that $\ZZ_p$ is a principal ideal domain whose principal ideals take the form $\left(p^\bullet\right)$. On the other hand, $\dim(p)=\dim\ZZ/p\ZZ=0$ because $\ZZ/p\ZZ$ is a field.
\end{example}
In all these examples, we see that
\[\dim\mf p+\codim\mf p\stackrel?=\dim R.\]
This equality need not hold in general, as we will show in a second, but we do have the following.
\begin{proposition} \label{prop:upperbounddimension}
	Fix $\mf p$ a prime ideal of a ring $R$. Then
	\[\dim\mf p+\codim\mf p\le\dim R.\]
\end{proposition}
\begin{proof}
	By \autoref{lem:codimisdescend}, we have a chain of distinct primes
	\[\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_{\codim\mf p}=\mf p.\]
	Similarly, by \autoref{lem:dimisascend}, we have a chain of distinct primes
	\[\mf p\subseteq\mf q_0\subsetneq\mf q_1\subsetneq\cdots\subseteq\mf q_{\dim\mf p}.\]
	By maximality, we note that we need $\mf p=\mf q_0$, lest we be able to make this chain longer by taking on $\mf p\subsetneq\mf q_0$ at the front. As such, we can zipper our two chains together into a long chain
	\[\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_{\codim\mf p}=\mf p=\mf q_0\subsetneq\mf q_1\subsetneq\mf q_2\subsetneq\cdots\subsetneq\mf q_{\dim\mf p}.\]
	This chain has length $\codim\mf p+\dim\mf p$, which must be less than or equal to $\dim R$ because we have constructed a chain of distinct primes in $R$. This finishes.
\end{proof}
\begin{remark}
	Equality in \autoref{prop:upperbounddimension} holds for affine domains (i.e., the ring of functions over a reduced variety).
\end{remark}
Here is another useful lemma.
\begin{lemma} \label{lem:diminclusionbounds}
	Fix ideals $I$ and $J$ in a ring $R$. If $I\subseteq J$, then
	\[\dim I\ge\dim J\qquad\text{and}\qquad\codim I\le\codim J.\]
	Similarly, if $\mf p$ and $\mf q$ are primes with $\mf p\subseteq\mf q$, then $\codim\mf p\le\codim\mf q$, with equality if and only if $\mf p=\mf q$.
\end{lemma}
\begin{proof}
	Roughly speaking, these follow directly from \autoref{lem:dimisascend} and \autoref{lem:codimisdescend}. We show them separately.
	\begin{itemize}
		\item From \autoref{lem:dimisascend}, we can find a chain of distinct primes
		\[J\subseteq\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_{\dim J}.\]
		However, $I\subseteq J$, so replacing the $J$ at the end $I$ implies $\dim I$ is at least $\dim J$ by \autoref{lem:dimisascend}.
		\item We need to show that
		\[\min_{\mf p\supseteq I}\codim\mf p\stackrel?\le\min_{\mf p\supseteq J}\codim\mf p.\]
		Well, there will exist some $\mf p_0\supseteq J$ for which $\codim I=\codim\mf p_0$. But this prime $\mf p_0$ also contains $I\subseteq J$, so
		\[\min_{\mf p\supseteq I}\codim\mf p\le\codim\mf p_0=\codim J,\]
		finishing.
		\item Lastly, let $\mf p$ and $\mf q$ be primes with $\mf p\subsetneq\mf q$. By \autoref{lem:codimisdescend}, we are promised a chain
		\[\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_{\codim\mf p}=\mf p.\]
		Placing $\subsetneq\mf q$ at the end of this chain gives $\codim\mf p+1\le\codim\mf q$, finishing.
	\end{itemize}
	Thus, we have shown the desired inequalities.
\end{proof}
For the sake of examples, we pick up the following computation.
\begin{lemma} \label{lem:primesinprods}
	Fix rings $R_1$ and $R_2$, and let $\pi_1:R_1\times R_2\to R_1$ and $\pi_1:R_1\times R_2\to R_2$ be the natural projections. If $\mf p\subseteq R_1\times R_2$ is a prime ideal, then one of the following is true.
	\begin{itemize}
		\item $\mf p=\pi_1\mf p\times R_2$, and $\pi_1\mf p$ is prime.
		\item $\mf p=R_1\times\pi_2\mf p$, and $\pi_2\mf p$ is prime.
	\end{itemize}
	Conversely, if $\mf p_1\subseteq R_1$ is prime, then $\mf p_1\times R_2\subseteq R_1\times R_2$ is a prime. Similarly, if $\mf p_2\subseteq R_2$ is prime, then $R_1\times\mf p_2\subseteq R_1\times R_2$ is prime.
\end{lemma}
\begin{proof}
	We start with the first statement; let $\mf p\subseteq R_1\times R_2$ be prime. Note that $(0,1)\cdot(1,0)=(0,0)\in\mf p$, so primality forces $(0,1)\in\mf p$ or $(1,0)\in\mf p$. By swapping $R_1$ and $R_2$, we may say (without loss of generality) that $(0,1)\in\mf p$ and show that $\mf p=\pi_1\mf p\times R_2$. We will show the inclusions separately.
	\begin{itemize}
		\item We show $\mf p\subseteq\pi_1\mf p\times R_2$. Indeed, pick up $(a,b)\in\mf p$. Then $a=\pi_1(a,b)\in\pi_1\mf p$, so $(a,b)\in\pi_1\mf p\times R_2$.
		\item We show $\pi_1\mf p\times R_2\subseteq\mf p$. Indeed, pick up any $(a,b)\in\pi_1\mf p\times R_2$. Because $a\in\pi_1\mf p$, pulling back along $\pi_1$ promises some $b'\in R_2$ such that $(a,b')\in\mf p$. But then we note that $(0,1)\in\mf p$ implies that
		\[(a,b')+(b-b')\cdot(0,1)=(a,b)\in\mf p\]
		as well, finishing.
	\end{itemize}
	Thus, $\mf p=\pi_1\mf p\times R_2$. It remains to show that $\pi_1\mf p$ is prime. Well, if $a_1a_2\in\pi_1\mf p$, then $(a_1a_2,0)\in\mf p_1\times R_2=\mf p$, so
	\[(a_1,0)\cdot(a_2,0)\in\mf p.\]
	Thus, $(a_1,0)\in\mf p$ or $(a_2,0)\in\mf p$, so $a_1\in\pi_1\mf p$ or $a_2\in\pi_1\mf p$.

	We now show the second part of the statement. On one hand, if $\mf p_1\subseteq R_1$ is prime, then we see immediately that $\pi_1^{-1}\mf p_1=\mf p_1\times R_2$ is prime. Similarly, if $\mf p_2\subseteq R_2$ is prime, then again we have that $\pi_2^{-1}\mf p_2=R_1\times\mf p_2$ is prime.
\end{proof}
\begin{corollary} \label{cor:dimofprods}
	Fix rings $R_1$ and $R_2$ with finite dimension. Then
	\[\dim(R_1\times R_2)=\max\{\dim R_1,\dim R_2\}.\]
\end{corollary}
\begin{proof}
	We show the inequalities separately.
	\begin{itemize}
		\item We show $\dim(R_1\times R_2)\ge\max\{\dim R_1,\dim R_2\}$. Indeed, we will show that $\dim(R_1\times R_2)\ge\dim R_1$, and then swapping the roles of $R_1$ and $R_2$ will show that $\dim(R_1\times R_2)\ge\dim R_2$ as well, finishing.

		Well, set $d:=\dim R_1$, and suppose that we have a chain of primes
		\[\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_d\]
		in $R_1$. Then \autoref{lem:primesinprods} gives us the chain of primes
		\[(\mf p_0\times R_2)\subseteq(\mf p_1\times R_2)\subseteq\cdots\subseteq(\mf p_d\times R_2).\]
		Notably, these primes are still distinct because $a\in\mf p_{k+1}\setminus\mf p_k$ has $(a,0)\in(\mf p_{k+1}\times R_2)\setminus(\mf p_k\times R_2)$. Thus, we have a chain of $\dim R_1$ distinct primes in $\dim(R_1\times R_2)$, so $\dim(R_1\times R_2)\ge\dim R_1$ follows.
		
		\item We show $\dim(R_1\times R_2)\le\max\{\dim R_1,\dim R_2\}$. Suppose that we have a chain of distinct primes
		\[\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_d\]
		in $R_1\times R_2$. Our goal is to show that $d\le\max\{\dim R_1,\dim R_2\}$. Now, \autoref{lem:primesinprods} $\mf p_0\in\{\pi_1\mf p_0\times R_2,R_1\times\pi_2\mf p_0\}$, so without loss of generality, we will assume that $\mf p_0=\pi_1\mf p_0\times R_2$; otherwise, we can swap the roles of $R_1$ and $R_2$ everywhere. Notably, the quantity $\max\{\dim R_1,\dim R_2\}$ is symmetric in $R_1$ and $R_2$.

		However, this implies that $(0,1)\in\pi_1\mf p_0\times R_2=\mf p_0$, so
		\[(0,1)\in\pi_1\mf p_k\]
		for each $\mf p_k$. So, using the proof of \autoref{lem:primesinprods}, we see that this implies $\mf p_k=\pi_1\mf p_k\times R_2$ for all $k$. Thus, our chain of primes now looks like
		\[(\pi_1\mf p_0\times R_2)\subsetneq(\pi_1\mf p_1\times R_2)\subsetneq\cdots\subsetneq(\pi_1\mf p_d\times R_2).\]
		In particular, applying $\pi_1$ gives us a chain of primes (by \autoref{lem:primesinprods})
		\[\mf p_0\subseteq\mf p_1\subseteq\cdots\subseteq\mf p_d\]
		in $R_1$. Now, we note distinctness: for any $k$, we see $(a,0)\in(\pi_1\mf p_{k+1}\times R_2)\setminus(\pi_2\mf p_k\times R_2)$ implies that $a\in\pi_1\mf p_{k+1}$. However, $a\in\pi_1\mf p_k$ would imply that $(a,0)\in\pi_1\mf p_k\times R_2$, which is false, so instead we must have $a\in\mf p_{k+1}\setminus\mf p_k$, so the above chain is indeed made of distinct primes.

		Thus, $d\le\dim R_1\le\max\{\dim R_1,\dim R_2\}$. This finishes.
	\end{itemize}
	Having shown both inequalities, we conclude $\dim(R_1\times R_2)=\max\{\dim R_1,\dim R_2\}$. So we are done.
\end{proof}
\begin{remark}
	By induction, we see that any $n\in\NN$ and rings $\{R_k\}_{k=1}^n$ will have
	\[\dim\prod_{k=1}^nR_k=\max\{\dim R_k:1\le k\le n\}.\]
	We won't talk about infinite products because they should mostly be infinite-dimensional. I don't think we have the machinery to talk about this here, but we refer to \href{https://mathoverflow.net/q/90980/473811}{mo90980}.
\end{remark}
And here is an example computation.
\begin{example}
	Let $R_1:=k[x]$ and $R_2:=k[x,y]$ and consider $R:=k[x]\times k[y,z]$, which is the coordinate ring of the disjoint union of a line and a plane.
	\begin{itemize}
		\item Note $\dim R=\max\{1,2\}=2$ by \autoref{cor:dimofprods}.
		\item Any prime below $(x)\times R_2$ needs to have the form $\mf p\times R_2$ (essentially by the argument above), but the only prime $\mf p$ below $(x)$ is $(0)$ because $k[x]$ is a principal ideal domain, so all nonzero primes are maximal. Thus, $\codim((x)\times R_2)=1$.
		\item Again, any prime above $(x)\times R_2$ needs to have the form $\mf p\times R_2$, but $(x)$ is a maximal ideal, so there is no such prime, so $\dim((x)\times R_2)=0$.
	\end{itemize}
	Computing, we see that $\dim R=2>1+0=\codim((x)\times R_2)+\dim((x)\times R_2)$, manifesting the lack of equality in \autoref{prop:upperbounddimension}.
\end{example}
To close out our examples, we study the most basic affine sets: sets of points.
\begin{proposition} \label{prop:dimenzionzero}
	Fix a nonzero Noetherian ring $R$.
	\begin{listalph}
		\item We have $\dim R=0$ if and only if $R$ is Artinian. In this case, $R$ is the product of finitely many Artinian local rings.
		\item If $X$ is an algebraic set, then $\dim A(X)=0$ if and only if $X$ is finite.
	\end{listalph}
\end{proposition}
\begin{proof}
	We go one at a time.
	\begin{listalph}
		\item A ring $R$ is Artinian if and only if $R$ is Noetherian and all primes are maximal by \autoref{thm:artingrabbag}. As such, under the hypothesis that $R$ is Noetherian, we see that $R$ is Artinian if and only if all primes are maximal.
		
		Now, all primes being maximal implies that we cannot build a chain of two distinct primes
		\[\mf p\subsetneq\mf q\]
		because $\mf p$ would need to be prime and hence maximal; thus, we have $\dim R=0$. (Note that $R$ does have dimension $0$ because $R$ is nonzero and hence has a maximal ideal.)

		And conversely, if $\dim R=0$, then any prime $\mf p$ must be maximal: we can put $\mf p$ inside a maximal ideal $\mf m$, which makes the chain
		\[\mf p\subseteq\mf m.\]
		If $\mf p\ne\mf m$, then $\dim R\ge1$, which is false. So instead we have $\mf p=\mf m$, making $\mf p$ maximal.

		Lastly, it remains to show that $R$ is the product of finitely many Artinian local rings. This follows directly from \autoref{prop:artiniandecomp}.

		\item By \autoref{prop:artinianisfinite}, we see that $\dim A(X)=0$ is equivalent to $A(X)$ being Artinian, which is equivalent to $X$ being finite.
		\qedhere
	\end{listalph}
\end{proof}

\subsection{Dimension in Families}
In algebraic geometry, we are interested in families of varieties, which in our algebraic context means morphisms of algebras. A helpful case to consider will be when we take an integral extension; this corresponds to the notion of a finite morphism of algebraic sets.
\begin{restatable}{proposition}{intextensiondimension} \label{prop:intextensiondimen}
	Fix a ring homomorphism $\varphi:R\to S$ which makes $S$ into an integral $R$-algebra. Then, for any $\mf p\in\op{Spec}R$ such that $\ker\varphi\subseteq\mf p$, there exists $\mf q\in\op{Spec}S$ such that
	\[\mf p=\varphi^{-1}(\mf q).\]
	In fact, for any ideal $I\subseteq S$, we have $\dim S/I=\dim R/\varphi^{-1}(I)$.
\end{restatable}
\begin{proof}
	We show the two sentences separately.
	\begin{itemize}
		\item To start, we claim that $S$ is still integral over $R/\ker\varphi$ by the induced map $\overline\varphi:R/\ker\varphi\to S$. Indeed, any $s\in S$ has some monic polynomial
		\[s^n+\sum_{k=0}^{n-1}\varphi(a_k)s^k=0\]
		for $\{a_0,\ldots,a_{n-1}\}\subseteq R$. However, $\varphi(a_k)=\overline\varphi([a_k]_{\ker\varphi})$, so we conclude
		\[s^n+\sum_{k=0}^{n-1}\overline\varphi([a_k]_{\ker\varphi})s^k=0,\]
		making $s$ still integral over $R/\ker\varphi$.

		Now, $\overline\varphi:R/\ker\varphi\to S$ has trivial kernel. Further, because $\ker\varphi\subseteq\mf p$, we see that $\mf p+\ker\varphi\subseteq R/\ker\varphi$ is still a prime: if $(a+\ker\varphi)(b+\ker\varphi)\in\mf p+\ker\varphi$, then $ab\in\mf p+\ker\varphi=\mf p$, so $a\in\mf p$ or $b\in\mf p$, so $a+\ker\varphi\in\mf p+\ker\varphi$ or $b+\ker\varphi\in\mf p+\ker\varphi$.

		Thus, we can invoke \autoref{prop:liftprimes} (notably, $\overline\varphi$ is injective!) so that we have a prime $\mf q\subseteq S$ such that
		\[\overline\varphi^{-1}(\mf q)=\mf p+\ker\varphi.\]
		In particular, we can compute
		\begin{align*}
			\varphi^{-1}(\mf q) &= \{a\in R:\varphi(a)\in\mf q\} \\
			&= \{a\in R:\overline\varphi([a]_{\ker\varphi})\in\mf q\} \\
			&= \{a\in R:[a]_{\ker\varphi}\in\overline\varphi^{-1}(\mf q)\} \\
			&= \{a\in R:[a]_{\ker\varphi}\in\mf p+\ker\varphi\} \\
			&= \{a\in R:a\in\mf p+\ker\varphi\} \\
			&= \mf p+\ker\varphi \\
			&= \mf p,
		\end{align*}
		which is what we wanted.

		\item Fix any ideal $I\subseteq S$. We claim that $S/I$ is integral over $R/\varphi^{-1}(I)$ by the induced map $\overline\varphi:R/\varphi^{-1}(I)\to S/I$. The argument is the same as before: any $s\in S$ has some monic polynomial
		\[s^n+\sum_{k=0}^{n-1}\varphi(a_k)s^k=0\]
		for $\{a_0,\ldots,a_{n-1}\}\subseteq R$. However, $\varphi(a_k)=\overline\varphi([a_k]_I)$, so we conclude
		\[s^n+\sum_{k=0}^{n-1}\overline\varphi([a_k]_I)s^k=0,\]
		making $s$ still integral over $R/\varphi^{-1}(I)$.

		Thus, we replace $R$ with $R/\varphi^{-1}(I)$, replace $S$ with $S/I$, and replace $\varphi$ with $\overline\varphi$. In total, we have an integral extension $\varphi:R\to S$, but in fact $\varphi$ is injective because we modded out by its kernel.

		We now compute dimensions. In one direction, suppose that we have a chain of distinct primes
		\[\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_{\dim R}\]
		in $R$. Then we can use \autoref{prop:liftprimes} to lift these to a chain of primes
		\[\mf q_0\subseteq\mf q_1\subseteq\cdots\subseteq\mf q_{\dim R}\]
		in $S$. Notably, $a\in\mf p_{k+1}\setminus\mf p_k$ implies that $\varphi(a)\in\mf q_{k+1}\setminus\mf q_k$ because $\varphi$ is injective, so we do indeed have a chain of $\dim R$ distinct primes in $S$. Thus, $\dim R\le\dim S$.

		Conversely, suppose that we have a chain of distinct primes
		\[\mf q_0\subsetneq\mf q_1\subsetneq\cdots\subsetneq\mf q_{\dim S}\]
		in $S$. Pulling these back to $R$, we have a chain of primes
		\[\mf p_0\subseteq\mf p_1\subseteq\cdots\subseteq\mf p_{\dim S}\]
		in $R$. Now, if any prime $\mf p\subseteq R$ appears more than once in the above chain, then there are two primes $\mf q_k\subsetneq\mf q_\ell$ of $S$ lying over $\mf p$. However, this is illegal by \autoref{lem:incomparability}, so instead we have a chain of $\dim S$ distinct primes in $S$, so we conclude $\dim R\ge\dim S$.

		Combining our arguments, we see that $\dim R=\dim S$, which is what we wanted.
	\end{itemize}
	The above statements finish the proof.
\end{proof}
\begin{remark}[Nir]
	Here is a nice application: let $K$ be a finite extension of $\QQ$, and let $\mathcal O_K$ be the integral closure of $\ZZ$ in $K$. Then $\mathcal O_K$ is integral over $\ZZ$ by construction, so \autoref{prop:intextensiondimen} promises us that
	\[\dim\mathcal O_K=\dim\ZZ=1.\]
	Thus, we have verified that all nonzero primes of $\mathcal O_K$ are maximal.
\end{remark}
And here is the geometric application.
\begin{corollary}
	Fix a morphism of varieties $\varphi:X\to Y$ and let $\varphi^*:A(Y)\to A(X)$ be the induced map on coordinate rings. Further, suppose $A(X)$ is finitely generated as an $A(Y)$-module. Then the following are true.
	\begin{listalph}
		\item The fibers of $\varphi$ are finite.
		\item If $\varphi^*$ is an injection, then $\varphi$ is surjective.
		\item If $Z\subseteq X$ is Zariski closed, then $\varphi(Z)\subseteq Y$ is also Zariski closed.
	\end{listalph}
\end{corollary}
\begin{proof}
	We go one at a time. For brevity, we set $R:=A(Y)$ and $S:=A(X)$ so that $\varphi^*:R\to S$ makes $S$ into an $R$-algebra. We quickly note that $A(X)$ being finite over $A(Y)$ implies that $S$ is an integral $R$ algebra by \autoref{lem:finiteimpliesintegral}.
	\begin{listalph}
		\item Fix a maximal ideal $\mf m\subseteq R$. Noting the coordinate ring of the fiber over $\mf m$ is $S/\mf mS$, so we compute
		\[\dim S/\mf mS=\dim R/\varphi^{-1}(\mf mS)=\dim R/\mf m=0,\]
		where we have used \autoref{prop:intextensiondimen}; notably, $S$ is indeed an integral $R$-algebra.

		\item Because points correspond to maximal ideals, we will show that
		\[\left(\varphi^*\right)^{-1}:\op{Spec}S\to\op{Spec}R\]
		surjects onto maximal ideals from maximal ideals. Indeed, pick up some maximal ideal $\mf m\subseteq R$ and use \autoref{prop:liftprimes} to get a prime $\mf p$ lying over $\mf m$. Note that we have used the fact that $\varphi^*$ is injective here.
		
		However, we can place $\mf p$ inside a maximal ideal $\mf p'$, so $(\varphi^*)^{-1}(\mf p')$ is a prime of $R$ containing $(\varphi^*)^{-1}(\mf p)=\mf m$ and hence will equal $\mf m$. Thus, we have a maximal ideal $\mf p\subseteq S$ lying over $\mf m$, as required.
		
		To finish, we claim $\varphi((a_1,\ldots,a_n))=(b_1,\ldots,b_m)$ only if
		\[\left(\varphi^*\right)^{-1}\big((x_1-a_1,\ldots,x_n-a_n)\big)=(y_1-b_1,\ldots,y_m-b_m),\]
		where $A(X)=k[x_1,\ldots,x_n]/I$ and $A(Y)=k[y_1,\ldots,y_m]/J$. This will be enough because we showed that there will be a maximal ideal $(x_1-a_1,\ldots,x_n-a_n)$ in $A(X)$ to hit the maximal ideal $(y_1-b_1,\ldots,y_m-b_m)$ of $A(Y)$ above.

		Well, observe that any $f\in(y_1-b_1,\ldots,y_m-b_m)$ has $f\varphi\in(x_1-a_1,\ldots,x_n-a_n)$, so $f\varphi(a_1,\ldots,a_n)=0$. In particular,
		\[\varphi(a_1,\ldots,a_n)\in Z((y_1-b_1,\ldots,y_m-b_m))=\{(b_1,\ldots,b_m)\},\]
		so we are done.
		
		\item Note that $\varphi$ restricts to a morphism $\varphi:Z\to\overline{\varphi(Z)}$ (which we conveniently rename to $\varphi$), where $\overline{\varphi(Z)}=Z(I(\overline{\varphi(Z)}))$ is the Zariski closure of $\varphi(Z)$. We would like to show that $\varphi$ is surjective, for which it suffices by (b) to show that $\varphi^*$ is injective.

		This is a matter of computation. We show that $\varphi^*$ has trivial kernel. Let $A(Z)=k[x_1,\ldots,x_n]/I$ (so that $Z=Z(I)$), which forces
		\[A(\overline{\varphi(Z)})=k[x_1,\ldots,x_n]/I(Z(I(\varphi(Z))))=I(\varphi(Z)).\]
		In particular, having $f\in k[y_1,\ldots,y_m]$ with $[f]_{I(\varphi(Z))}\in\ker\varphi^*$ means that $f\varphi\in I(Z)$ so that $f\varphi(p)=0$ for all $p\in Z$. But then $f$ vanishes on $I(\varphi(Z))$, so $f\in I(\varphi(Z))$, which is what we wanted.
		\qedhere
	\end{listalph}
\end{proof}
\begin{remark}[Nir]
	The statement (b) above is an instance of ``geometry is the opposite of algebra.''
\end{remark}
\begin{example}
	Fix $S:=k[x,y]/\left(x-y^2\right)$ and $R:=k[x]$ so that we have a mapping $R\into S$. The mapping between the algebraic curves is in fact surjective, though this is not apparent from the image in $\RR$.
\end{example}

\subsection{Local Dimension}
As an intermission, we quickly discuss how dimension behaves locally.
\begin{lem} \label{lem:localizedim}
	Fix a ring $R$ and a multiplicatively closed subset $U\subseteq R$. Further, set $S:=R\left[U^{-1}\right]$ with the natural map $\varphi:R\to S$. Then, for any prime $\mf p\subseteq R\left[U^{-1}\right]$, we have
	\[\codim\varphi^{-1}(\mf p)=\codim\mf p.\]
\end{lem}
\begin{proof}
	We use \autoref{lem:codimisdescend}. As such, we split the proof into two inequalities.
	\begin{itemize}
		\item We show $\codim\varphi^{-1}(\mf p)\le\codim\mf p$. Indeed, set $d:=\codim\varphi^{-1}(\mf p)$ so that we have a chain of distinct primes
		\[\mf p_0\subsetneq\mf p_1\subsetneq\cdots\mf p_d=\varphi^{-1}(\mf p).\]
		Note $\mf p_kR\left[U^{-1}\right]\subseteq\varphi^{-1}(\mf p)R\left[U^{-1}\right]$ for each $\mf p_k$, but $\varphi^{-1}(\mf p)R\left[U^{-1}\right]=\mf p$ by \autoref{lem:localidealsa}, so $\mf p_kR\left[U^{-1}\right]$ is a proper ideal, so $\mf p_k\cap U=\emp$, lest we have a unit.

		It follows from \autoref{thm:localizedprimes} that
		\[\mf p_0R\left[U^{-1}\right]\subsetneq\mf p_1R\left[U^{-1}\right]\subsetneq\cdots\mf p_dR\left[U^{-1}\right]=\mf p\]
		is a chain of primes in $R\left[U^{-1}\right]$. Notably, the map $\mf p_k\mapsto\mf p_kR\left[U^{-1}\right]$ is injective (with inverse $\varphi^{-1}$) by combining with \autoref{lem:localidealsb}.

		Thus, we have a chain $d$ distinct primes below $\mf p$, so $\codim\mf p\ge d$, as desired.

		\item We show $\codim\mf p\le\codim\varphi^{-1}(\mf p)$. Indeed, set $d:=\codim\mf p$ so that we have a chain of distinct primes
		\[\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_d=\mf p.\]
		In particular, pulling back along $\varphi^{-1}$ gives us a chain of primes
		\[\varphi^{-1}\mf p_0\subsetneq\varphi^{-1}\mf p_1\subsetneq\cdots\subsetneq\varphi^{-1}\mf p_d=\varphi^{-1}\mf p,\]
		which are distinct by using the bijectivity of \autoref{thm:localizedprimes}. Thus, we have a chain of $d$ distinct primes below $\varphi^{-1}\mf p$, so it follows $\codim\varphi^{-1}\mf p\ge d$, as desired.
	\end{itemize}
	Combining the above results gives $\codim\varphi^{-1}\mf p=\codim\mf p$, which is what we wanted.
\end{proof}
\begin{remark}
	In fact, one can show that $R_{\varphi^{-1}\mf p}\cong R\left[U^{-1}\right]_\mf p$ by using the universal property of localization a bunch of times.
\end{remark}

\subsection{The Principal Ideal Theorem}
Here is our statement.
\begin{restatable}[Principal ideal]{theorem}{pidtheorem} \label{thm:pit1}
	Fix a Noetherian ring $R$. Given $x\in R$, suppose $\mf p$ is a minimal prime over $(x)$. Then
	\[\codim\mf p\le1.\]
\end{restatable}
\begin{proof}
	We start by localizing. The key is the following lemma.
	\begin{lemma} \label{lem:localminimal}
		Fix an ideal $I$ of a ring $R$. If the prime $\mf p$ of $R$ is minimal over $I$, then $\mf pR_\mf p$ is minimal over $IR_\mf p$.
	\end{lemma}
	\begin{proof}
		Indeed, if we can find a prime $\mf q\subseteq R_\mf p$ such that
		\[IR_\mf p\subseteq\mf q\subseteq\mf pR_\mf p,\]
		then pulling back along the localization map $\psi:R\to R_\mf p$ gives us the chain
		\[I\subseteq\psi^{-1}(\mf q)\subseteq\psi^{-1}(\mf pR_\mf p)\]
		because $I\subseteq\psi^{-1}(IR_\mf p)$. As such, minimality forces $\psi^{-1}(\mf q)$ to be equal to $\psi^{-1}(\mf pR_\mf p)=\mf p$ (here we are using \autoref{thm:localizedprimes}), so \autoref{lem:localidealsa} tells us
		\[\mf q=\psi^{-1}(\mf q)R_\mf p=\mf pR_\mf p,\]
		thus finishing.
	\end{proof}
	In particular, $\mf pR_\mf p$ is minimal over $(x)R_\mf p$.

	So at this point, we fully replace $R$ with $R_\mf p$ (which is still Noetherian by \autoref{cor:localisnoether}), $\mf p$ with $R_\mf p$, and $(x)$ with $(x)R_\mf p$. Thus, $R$ is a local ring with maximal ring $\mf p$, and $\mf p$ is a minimal prime over $(x)$. Before the replacement, we wanted to show that $\dim R_\mf p\le1$, so we see that now we want to show $\dim R\le1$. In other words, we want to show that any chain of distinct primes
	\[\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_d\]
	must have $d\le1$. Note that if $\mf p_d\ne\mf p$, then we can tack on $\subsetneq\mf p$ to the end of chain because $\mf p$ is the unique maximal ideal, so we may in fact assume that $\mf p_d=\mf p$. Thus, we are essentially showing that the chain
	\[\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\underbrace{\mf p_{d-1}}_{\mf q:=}\subsetneq\mf p\]
	has $d\le1$. If $d=0$, then there is nothing to say.
	
	Otherwise, we want $\mf q=\mf p_{d-1}$ to have no primes strictly below it, which means (from \autoref{lem:codimisdescend}) we want to show $\dim R_\mf q=\codim\mf q=0$. Noting that $R_\mf q$ is still Noetherian, we see that showing $\dim R_\mf q=0$ is equivalent to showing $R_\mf q$ is Artinian by \autoref{prop:dimenzionzero}. Thus, we will imitate the discussion in \autoref{thm:artingrabbag} and show that the ideal $\mf q$ is nilpotent.

	As a starting step, we claim that $R/(x)$ is Artinian. We have the following stronger statement.
	\begin{lemma} \label{lem:minprimegrabbag}
		Fix a proper ideal $I$ of a ring local ring $R$ with maximal ideal $\mf p$. Then the following are equivalent.
		\begin{listalph}
			\item $\mf p$ is minimal over $I$.
			\item $R/I$ is Artinian.
			\item $\mf p^n\subseteq I$ for some positive integer $n$.
		\end{listalph}
	\end{lemma}
	\begin{proof}
		We have the following implications. Let $\pi:R\to R/I$ be the natural projection.
		\begin{itemize}
			\item We show (a) implies (b). In particular, we claim $\dim I=\dim R/I=0$, for which we use \autoref{lem:dimisascend}. Well, if we have some chain
			\[I\subseteq\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_d,\]
			then because $R$ is local, we can place $\subseteq\mf p_d$ at the end, thus allowing us to assume $\mf p_d=\mf p$. But then $\mf p$ is minimal over $I$, so the entire chain collapses to $\mf p_0=\mf p$. It follows $d=0$, finishing.
			\item We show (b) implies (c). By \autoref{lem:pullmax}, we see that $\pi(\mf p)$ is the unique maximal ideal of $R/I$, so $\pi(\mf p)$ is the Jacobson radical of $R/I$. Because $R/I$ is Artinian, this Jacobson radical is nilpotent by \autoref{lem:jacobsonnilpotent}, so there exists a positive integer $n$ for which
			\[\pi(\mf p)^n=(0)+I.\]
			As such, any generating element $x_1\cdot\ldots\cdot x_n\in\mf p^n$ will have its projection go to $0\pmod I$, meaning that $x_1\cdot\ldots\cdot x_n\in I$, which verifies $\mf p^n\subseteq I$ for our $n$.
			\item We show (c) implies (a). Indeed, suppose that we have a prime $\mf q$ such that
			\[I\subseteq\mf q\subseteq\mf p.\]
			We need $\mf q=\mf p$, for which it suffices to show $\mf p\subseteq\mf q$ because $\mf p$ is the unique maximal ideal. Well, any $x\in\mf p$ has $x^n\in\mf p^n\subseteq I\subseteq\mf q$, so $x\in\mf q$ follows.
		\end{itemize}
		The above implications finish the proof.
	\end{proof}
	So indeed, $R/(x)$ is Artinian by \autoref{lem:minprimegrabbag}.

	Continuing, to measure how close $\mf q$ is to being nilpotent, we let $\varphi:R\to R_\mf q$ be the localization map and set
	\[\mf q^{(n)}:=\varphi^{-1}\left((\mf qR_\mf q)^n\right).\]
	In particular, $\frac r1\in(\mf qR_\mf q)^n$ if and only if $\frac r1=\frac{r'}{s'}$ for some $r'\in\mf q^n$ and $s'\notin\mf q$,\footnote{To see $(\mf qR_\mf q)^n=\mf q^nR_\mf q$, certainly $\mf q^nR_\mf q\subseteq(\mf qR_\mf q)^n$ by directly localizing. On the other hand, any product $\frac{r_1}{s_1}\cdot\ldots\cdot\frac{r_n}{s_n}$ generating $(\mf q^nR_\mf q)$ must live in $\mf q^nR_\mf q$ by multiplying through.} or equivalently, $rs''\in\mf q^n$ for some $s''\notin\mf q$, where we are implicitly using the fact $R\setminus\mf q$ is multiplicative. Thus,
	\[\mf q^{(n)}=\left\{r\in R:rs\in\mf q^n\text{ for some }s\notin\mf q\right\}.\]
	Now, using the fact that $R/(x)$ is Artinian, we see that the chain
	\[\mf q^{(1)}+(x)\supseteq\mf q^{(2)}+(x)\supseteq\mf q^{(3)}+(x)\supseteq\cdots\]
	must stabilize, so we are promised some $n$ for which $\mf q^{(n)}+(x)=\mf q^{(n+1)}+(x)$. It follows $\mf q^{(n)}\subseteq\mf q^{(n+1)}+(x)$. Quickly, this means that any element of $\mf q^{(n)}$ can be written as $a+bx$ with $a\in\mf q^{(n+1)}$ and $b\in R$. But then $bx\in\mf q^{(n)}$, so $b(sx)\in\mf q^n$ for some $s\notin\mf q$, but $x\notin\mf q$ (otherwise $(x)\subseteq\mf q\subseteq\mf p$ forces $\mf q=\mf p$ by minimality), so in fact $b\in\mf q^{(n)}$. So actually
	\[\mf q^{(n)}\subseteq\mf q^{(n+1)}+(x)\mf q^{(n)},\]
	and we get a full equality because $\mf q^{(n+1)},(x)\mf q^{(n)}\subseteq\mf q^{(n)}$ individually. In other words, looking in $R/\mf q^{(n+1)}$, we find
	\[\left(\mf q^{(n)}+\mf q^{(n+1)}\right)=(x)\cdot\left(\mf q^{(n)}+\mf q^{(n+1)}\right),\]
	so we can apply Nakayama's lemma: the fact that $(x)\subseteq\mf p$ lives in the Jacobson radical, forces by \autoref{thm:nakayama} that $\mf q^{(n)}+\mf q^{(n+1)}=0+\mf q^{(n+1)}$. Thus, $\mf q^{(n)}=\mf q^{(n+1)}$, so
	\[(\mf qR_\mf q)^n=\varphi^{-1}\left((\mf qR_\mf q)^n\right)R_\mf q=\mf q^{(n)}R_\mf q=\mf q^{(n+1)}R_\mf q=\varphi^{-1}\left((\mf qR_\mf q)^{n+1}\right)R_\mf q=(\mf qR_\mf q)^{n+1}\]
	using \autoref{lem:localidealsa}. In particular, noting that the Jacobson radical in $R_\mf q$ is $\mf qR_\mf q$, applying \autoref{thm:nakayama} to the above equation gives
	\[(\mf qR_\mf q)^n=0.\]
	So indeed, our maximal ideal $\mf qR_\mf q$ is nilpotent, so it follows that $R_\mf q$ has dimension $1$, which is what we wanted. One could track through the proof of \autoref{thm:artingrabbag} to see this. Alternatively, one could note more directly that, $R_\mf q$ has only one prime: if $\mf q'\subseteq R_\mf q$ is a prime, then of course $\mf q'\subseteq\mf qR_\mf q$ by maximality; conversely, any element $a\in\mf qR_\mf q$ has $a^n=0\in\mf q'$, so $a\in\mf q'$ follows, giving $\mf q'=\mf qR_\mf q$. So we get $\dim R_\mf q=0$.
\end{proof}
\begin{remark} \label{rem:geometricpit}
	The analogous statement in the affine case is that the dimension of the intersection between a one-dimensional curve $f=0$ and the space cut out by $\mf p$ is either going to be $0$ (if we intersect at points) or $1$ (if a nontrivial part of the curve $f=0$ lives in the region cut out by $\mf p$).
	
	More rigorously, by the implicit function theorem in differential geometry, having one equation in a tangent space will have a solution set with either the same dimension or one fewer dimension.
\end{remark}
We can extend this result to any finitely generated ideal by an induction.
\begin{theorem} \label{thm:pit}
	Fix a Noetherian ring $R$. Given an ideal $(x_1,\ldots,x_s)\in R$, suppose $\mf p$ is a minimal prime over $(x_1,\ldots,x_s)$. Then
	\[\codim\mf p\le s.\]
\end{theorem}
\begin{proof}
	We proceed by induction on $s$; the case of $s=0$ is merely saying that a minimal prime $\mf p$ (over $(0)$) has $\codim\mf p=0$, which is true by \autoref{lem:codimisdescend}. The case of $s=1$ is \autoref{thm:pit1}.
	
	So now we discuss the inductive step. As before, we begin by localizing. By \autoref{lem:localminimal}, we see that $\mf pR_\mf p$ remains minimal over $(x_1,\ldots,x_s)R_\mf p$, and we are trying to show that $\dim R_\mf p=\codim\mf p=s$. In particular, replacing $R$ with $R_\mf p$, $\mf p$ with $R_\mf p$, and $(x_1,\ldots,x_s)$ with $(x_1,\ldots,x_s)R_\mf p$, we see that $R$ is local with maximal ideal $\mf p$, which is minimal over $(x_1,\ldots,x_s)$, and we want to show that
	\[\dim R\le s.\]
	We now proceed with the proof. In particular, we would like to show that any chain of distinct primes
	\[\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_d\]
	must have $d\le s$. If $d=0$, there is nothing to say.
	
	Otherwise, note that $\mf p$ is the unique maximal ideal, so we can tack on $\subseteq\mf p$ to the end of this chain, allowing us to assume $\mf p=\mf p_d$. Similarly, we can replace $\mf p_{d-1}$ with the largest prime $\mf q$ containing $\mf p_{d-1}$ while strictly below $\mf p$ so that we have the chain
	\[\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_{d-2}\subsetneq\mf q\subsetneq\mf p.\]
	As such, we would like to show that there at most $s-1$ primes below $\mf q$, which means we want $\codim\mf q\le s-1$ by \autoref{lem:codimisdescend}. By the inductive hypothesis, it will suffice to show that $\mf q$ is minimal over an ideal generated by $s-1$ elements.

	Note that, if $\mf q$ contains the $x_\bullet$, then $(x_1,\ldots,x_s)\subseteq\mf q\subsetneq\mf p$, violating the minimality of $\mf p$. So $\mf q$ does not contain at least one of the $x_\bullet$; by rearranging, suppose $x_s\notin\mf q$. Now, imitating the previous proof, we note that $\mf p$ is a minimal prime over $\mf q$ and contains $(x_s)$, so actually $\mf p$ is a minimal prime over $\mf q+(x_s)$. So \autoref{lem:minprimegrabbag} tells us
	\[\mf p^n=\mf q+(x_s)\]
	for some positive integer $n$. In particular, each $x_i$ has $x_i^n\in\mf p^n=\mf q+(x_s)$, so there exists a corresponding $y_i\in\mf q$ and $r_i\in R$ such that
	\[x_i^n=y_i+r_ix_s.\tag{$*$}\label{eq:getnilpotent}\]
	We now claim that $\mf q$ is minimal over $(y_1,\ldots,y_{s-1})$, which will of course finish. To see this, we proceed in steps.
	\begin{enumerate}
		\item Note that $\mf p+(y_1,\ldots,y_{s-1},x_s)$ is nilpotent in $R/(y_1,\ldots,y_{s-1},x_s)$ by \autoref{lem:minprimegrabbag}: taking $\mf p$ to a sufficiently large power places $\mf p^\bullet$ in $(x_1,\ldots,x_s)$, but then taking any generator $x_i$ to a sufficiently large power places it into $(y_1,\ldots,y_{s-1},x_s)$ by \autoref{eq:getnilpotent}.
		\item Reading the previous step backwards, it follows that the image of $\mf p$ in $(R/(y_1,\ldots,y_{s-1}))/(x_s)$ nilpotent, so the image of $\mf p$ in $R/(y_1,\ldots,y_{s-1})$ is minimal over $(x_s)$ by \autoref{lem:minprimegrabbag}. In particular, \autoref{thm:pit1} enforces
		\[\codim(\mf p+(y_1,\ldots,y_{s-1}))\le1.\]
		\item We now track through $\mf q$. To show that $\mf q$ is minimal over $(y_1,\ldots,y_{s-1})$ we are showing that there are no primes strictly between $(y_1,\ldots,y_{s-1})$ and $\mf q$. Modding out by $(y_1,\ldots,y_{s-1})$, we are showing that there are no primes strictly between $(0)$ and $\mf q+(y_1,\ldots,y_{s-1})$ in $R/(y_1,\ldots,y_{s-1})$. (The fact that the modding process preserves inclusions of primes is discussed in \autoref{lem:dimisascend}.) As such, we need
		\[\codim(\mf q+(y_1,\ldots,y_{s-1}))=0\]
		in $R/(y_1,\ldots,y_{s-1})$. Well, note that $x_s$ is not in $\mf q$ and hence not in $(y_1,\ldots,y_{s-1})$, so we have
		\[\mf q+(y_1,\ldots,y_{s-1})\subsetneq(\mf q+(x_s))+(y_1,\ldots,y_{s-1})\subseteq\mf p+(y_1,\ldots,y_{s-1}),\]
		in $R/(y_1,\ldots,y_{s-1})$. Thus, the previous step forces $\mf q+(y_1,\ldots,y_{s-1})$ to in fact have no primes strictly smaller (and hence have codimension $0$), lest we be able to add more primes below $\mf p+(y_1,\ldots,y_{s-1})$.
	\end{enumerate}
	So $\mf q$ is minimal over $(y_1,\ldots,y_{s-1})$, which is what we wanted.
\end{proof}
\begin{remark}
	As in \autoref{rem:geometricpit}, the analogous statement in linear algebra is that the solution set to $s$ equations (carved out by $(x_1,\ldots,x_s)$) will have at most dimension codimension $s$ when living inside an affine variety.
\end{remark}
We close class by discussing the sharpness of \autoref{thm:pit}. As an example, the equality case is in fact achievable, for any $s$.
\begin{example}
	Fix $R:=k[x_1,\ldots,x_n]$. Then the codimension of the prime $\mf p:=(x_1,\ldots,x_r)$ is upper-bounded by $r$ by \autoref{thm:pit}, but we also have a chain of distinct primes
	\[(0)\subsetneq(x_1)\subsetneq(x_1,x_2)\subsetneq\cdots\subsetneq(x_1,\ldots,x_r)=\mf p,\]
	so $\codim\mf p=r$ follows.
\end{example}
And here is a full converse to \autoref{thm:pit}.
\begin{restatable}{cor}{pidthmconverse} \label{cor:pitconverse}
	Fix a prime ideal $\mf p$ of a Noetherian ring $R$ with codimension $r$. Then there are elements $x_1,\ldots,x_r$ such that $\mf p$ is minimal over $(x_1,\ldots,x_r)$, and in fact $\codim(x_1,\ldots,x_r)=r$.
\end{restatable}
\begin{proof}
	We induct. If $\mf p$ has codimension $0$, then by \autoref{lem:codimisdescend}, we see that there is no prime strictly smaller than $\mf p$. In other words, $\mf p$ is minimal over $(0)$, the ideal generated by $0$ elements.

	We now proceed with the induction. Because $\mf p$ has codimension $r>0$, we can build a chain of primes
	\[\mf p_0\subsetneq\mf p_1\subsetneq\cdots\subsetneq\mf p_{r-1}\subsetneq\mf p\]
	by \autoref{lem:codimisdescend}. In particular, $\codim\mf p_{r-1}=r-1$ (it is at least $r-1$ by this construction and cannot exceed $r-1$ by \autoref{lem:diminclusionbounds}), so the induction promises us that $\mf p_{r-1}$ is minimal over some ideal $(x_1,\ldots,x_{r-1})$ of codimension $r-1$.

	We now just need to choose $x_r$ to make our codimension a little bigger. Indeed, the set of primes minimal over $(x_1,\ldots,x_{r-1})$ is finite by \autoref{prop:finminprimes} have codimension at most $r-1$ by the inductive hypothesis, so $\mf p$ is not contained in of them by \autoref{lem:diminclusionbounds}. So \autoref{lem:primeavoidance} promises that we can find an element $x_r$ which lives in $\mf p$ but in none of the primes minimal over $(x_1,\ldots,x_{r-1})$, so we claim that $\mf p$ is minimal over
	\[(x_1,\ldots,x_r).\]
	Indeed, fix any prime $\mf q$ such that
	\[(x_1,\ldots,x_r)\subseteq\mf q\subseteq\mf p.\]
	So to finish, we claim that any prime $\mf q$ containing $(x_1,\ldots,x_r)$ has codimension at least $r$. By \autoref{lem:diminclusionbounds}, this will force $\mf p=\mf q$ in the above case because $\mf q\subseteq\mf p$ already.
	
	On one hand, we get $\codim\mf q\le\codim\mf p=r$ by \autoref{lem:diminclusionbounds} automatically, so we want $\codim\mf q\ge r$. Well, $\mf q$ contains $(x_1,\ldots,x_{r-1})$ and hence have codimension at least
	\[\codim(x_1,\ldots,x_{r-1})=r-1.\]
	However, if we did have $\codim\mf q=r-1$, then there could be no prime strictly between $\mf q$ and $(x_1,\ldots,x_{r-1})$ because such a prime would have codimension strictly less than $\codim\mf q=r-1=\codim(x_1,\ldots,x_{r-1})$ by \autoref{lem:diminclusionbounds}. So in this case, $\mf q$ is minimal over $(x_1,\ldots,x_{r-1})$, which is a contradiction because $x_r\in\mf q$.

	Lastly, we finish the induction by showing $\codim(x_1,\ldots,x_r)=r$. Certainly $\mf p\supseteq\codim(x_1,\ldots,x_r)$ shows that $\codim(x_1,\ldots,x_r)\le r$ by \autoref{lem:diminclusionbounds}. However, the argument of the previous paragraph showed that any prime $\mf q$ containing $(x_1,\ldots,x_r)$ has codimension at least $r$, so the equality follows.
\end{proof}