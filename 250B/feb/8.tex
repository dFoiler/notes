% !TEX root = ../notes.tex

Today we discuss primary decomposition.

\subsection{Minimal Primes}

Let's talk a little bit about minimal prime ideals. In particular, suppose that we have a striclty descending chain of prime ideals
\[\mf p_1\supseteq\mf p_2\supseteq\cdots.\]
Because prime ideals are closed under intersection in the chain, Zorn's lemma now promises us a minimal prime ideal.

More generally, we have the following definition.
\begin{definition}[Minimal prime]
	Fix $R$ a ring and $I\subseteq R$ an ideal. Then a prime $\mf p\subseteq R$ is a \textit{minimal prime ideal over $I$} if $\mf p$ is a minimal element of the set of prime ideals containing $I$.
\end{definition}
The above Zorn's lemma argument shows that these minimal primes actually exist.
\begin{proposition}
	Fix $R$ a ring and $I\subsetneq R$ a proper ideal. Then there is a minimal prime $\mf p$ over $I$.
\end{proposition}
\begin{proof}
	We will be a little more careful than the above discussion. Let $\mathcal P$ be the set of primes containing $I$, and we partial order $\mathcal P$ by inclusion. Note that $I$, being a proper ideal, is contained in some maximal ideal $\mf m$, so $\mf m\in\mathcal P$. Thus, $\mathcal P$ is nonempty.

	To apply Zorn's lemma to get out a minimal element, we need to show that any descending chain in $\mathcal P$ is bounded below. Well, suppose that we have a chain
	\[\mf p_1\supseteq\mf p_2\supseteq\mf p_3\supseteq\cdots\]
	of prime ideals containing $I$. Then we set
	\[\mf p:=\bigcap_{k=1}^\infty\mf p_k.\]
	We claim that $\mf p\in S$, which will finish by Zorn's lemma. Because $I\subseteq\mf p_k$ for each $\mf p_k$, we have $I\subseteq\mf p$. Because each $\mf p_k$ is an ideal, the intersection $\mf p$ will be an ideal.
	
	Lastly, to see that $\mf p$ is prime, suppose that $xy\in\mf p$ so that we need to show $x\in\mf p$ or $y\in\mf p$. If $x\in\mf p_k$ for each $\mf p_k$, then $x\in\mf p$, and we are done. Otherwise there exists $\mf p_N$ such that $x\notin\mf p_N$, but then for any $n\ge N$, we have $\mf p_n\subseteq\mf p_N$, so $x\notin\mf p_n$ as well. But because $xy\in\mf p_n$, we see that
	\[y\in\mf p_n\]
	for each $n\ge N$. Because $\mf p_N\subseteq\mf p_m$ for each $m\le N$, we see that in fact $y\in\mf p_k$ for each $k$. Thus $y\in\mf p$.
\end{proof}

In the Noetherian case, our minimal primes are somewhat controlled.
\begin{prop} \label{prop:finminprimes}
	Fix $R$ a Noetherian ring and $I\subseteq R$ an ideal. Then there are only finitely many minimal prime ideals over $I$.
\end{prop}
\begin{proof}[Proof 1]
	Note $I=R$ has no minimal prime ideals over $R$, so we only consider proper ideals. Suppose for the sake of contradiction we have a proper ideal $J$ for which there are infinitely many minimal prime ideals over $J$. Then, because $R$ is Noetherian, we may find a maximal such ideal, and we name it $I$.
	
	Note that if $I$ is prime, then $I$ is the unique minimal prime over $I$, for any minimal prime over $I$ which is contained in $I$ must equal $I$. Thus, $I$ cannot be prime, so there exist $a,b\in R$ such that $a,b\notin I$ while $ab\in I$. Now we look at
	\[I+(a)\qquad\text{and}\qquad I+(b).\]
	In particular, $I$ is a strict subset of both $I+(a)$ and $I+(b)$, so maximality of $I$ forces $I+(a)$ and $I+(b)$ to have only finitely many minimal prime ideals over them. Let $\mathcal P_a$ and $\mathcal P_b$ be the finite sets of minimal primes over $I+(a)$ and $I+(b)$, respectively.

	To finish, we claim that the set of minimal primes over $I$ is a subset $\mathcal P_a\cup\mathcal P_b$, which will be enough because it will show that there are only finitely many minimal primes over $I$, a contradiction. Indeed, suppose $\mf p$ is a minimal prime over $I$. Then $ab\in\mf p$, so $a\in\mf p$ or $b\in\mf p$; without loss of generality, we take
	\[I+(a)\subseteq\mf p.\]
	So we claim that $\mf p\in\mathcal P_a$. Indeed, if a prime $\mf q$ is contained in $\mf p$ while containing $I+(a)$, then $\mf q$ is a prime contained in $\mf p$ while containing $I$, so minimality of $\mf p$ implies $\mf p=\mf q$. This finishes.
\end{proof}
\begin{proof}[Proof 2]
	We can use the machinery of associated primes we have been building. Note that $R/I$ is a finitely generated $R$-module, and $x\in\op{Ann}R/I$ if and only if $x\cdot[r]_I=[0]_I$ for all $r\in R$ if and only if $xr\in I$ for all $r\in R$ if and only if $x\in I$ (by taking $r=1$). Thus,
	\[\op{Ann}R/I=I.\]
	Now, any prime minimal over $I$ will be a minimal prime containing $\op{Ann}R/I$, which by \autoref{prop:minassprimes} will be a prime associated to $R/I$. Thus, the set of minimal primes over $I$ is a subset of
	\[\op{Ass}R/I,\]
	which is finite by \autoref{thm:finass}.
\end{proof}

\subsection{Primary Decomposition for Geometers}
We note that \autoref{prop:finminprimes} has the following corollary.
\begin{corollary} \label{cor:easyprimarydecomp}
	Fix $R$ a Noetherian ring and $I\subseteq R$ an ideal. Then $\rad I$ is the intersection of finitely many prime ideals.
\end{corollary}
\begin{proof}
	By \autoref{prop:radprimes}, we write
	\[\rad I=\bigcap_{I\subseteq\mf p}\mf p.\]
	Letting $\mathcal P$ be the set of minimal primes over $I$, we see that each $\mf p$ over $I$ has some $\mf P_\mf p\in\mathcal P$ such that $\mf P_\mf p\subseteq\mf p$ (for otherwise $\mf p$ ought be minimal). Thus,
	\[\bigcap_{\mf p\in\mathcal P}\mf p\subseteq\bigcap_{I\subseteq\mf p}\mf p\subseteq\bigcap_{I\subseteq\mf p}\mf P_\mf p\subseteq\bigcap_{\mf p\in\mathcal P}\mf p,\]
	so equalities follow. Thus, $\rad I$ is equal to the intersection of the primes in $\mathcal P$, of which there are finitely many by \autoref{prop:finminprimes}.
\end{proof}
We close with a geometric interpretation of \autoref{cor:easyprimarydecomp}. We have the following definition.
\begin{defi}[Irreducible]
	Fix $X\subseteq\AA^n(k)$ an affine algebraic set. Then $X$ is \textit{irreducible} if and only if $I(X)\subseteq k[x_1,\ldots,x_n]$ is prime; i.e., $A(X)$ is an integral domain. We might call $X$ a \textit{variety} in this case.
\end{defi}
As an application, consider any algebraic set $X\subseteq\AA^n(k)$. Then we know that $I(X)$ is radical, so \autoref{cor:easyprimarydecomp} is saying that we can decompose
\[I(X)=\bigcap_{\mf p\in\mathcal P}\mf p,\]
where $\mathcal P$ is the finite collection of minimal primes over $I(X)$. Taking zero-sets everywhere, we see that\footnote{If $x\in Z(I\cap J)$ while $x\notin Z(J)$, then there is $g\in J$ such that $g(x)\ne0$; but $x\in Z(I\cap J)$ means that each $f\in I$ has $(fg)(x)=0$, forcing $f(x)=0$. Conversely, if $x\in Z(I)$ (without loss of generality), $x$ will also vanish on $I\cap J$.} $Z(I\cap J)=Z(I)\cup Z(J)$, so
\[X=Z(I(X))=Z\left(\bigcap_{\mf p\in\mathcal P}\mf p\right)=\bigcup_{\mf p\in\mathcal P}Z(\mf p).\]
Now, $I(Z(\mf p))=\rad\mf p$ by the Nullstellensatz, and $\rad\mf p=\mf p$ be primality, so the point of the above is that we have written an arbitrary algebraic set $X$ as a union of finitely many irreducible algebraic sets $Z(\mf p)$.
\begin{corollary}
	Fix $X\subseteq\AA^n(k)$ an algeraic set. Then $X$ can be written as the union of finitely many irreducible algebraic sets.
\end{corollary}
\begin{proof}
	This follows from the above discussin.
\end{proof}
And now let's see a physical example.
% a minimal prime $\mf p$ over $I(X)$, of which we know there are finitely many, so we call them
% \[\{\mf p_1,\ldots,\mf p_n\}.\]
% However, the intersection of all these primes will be the intersection of all the primes containing $I(X)$, which is the radical of $I(X)$, which is $I(X)$. Speaking geometrically, this means that any algebraic set is a finite union of maximal irreducible algebraic set.
\begin{exe}
	Fix $I:=\left(yx-x^3\right)\subseteq k[x_1,x_2]$, and we decompose $Z(I)\subseteq\AA^2(k)$ into irreducibles.
\end{exe}
\begin{proof}
	Well, $yx-x^3=0$ if and only if $x=0$ or $y-x^2=0$, so
	\[I=(x)\cap\left(y-x^2\right).\]
	So here is the image of $Z(I)$.
	\begin{center}
		\begin{asy}
			unitsize(1cm);
			import graph;
			real f(real x)
			{
				return x*x;
			}
			draw(graph(f,-1.5,1.5), red);
			label("$\left(y-x^2\right)$", (1,1), SE, red);
			draw((0,2.25)--(0,-0.5), blue);
			label("$(x)$", (0,1.8), E, blue);
		\end{asy}
	\end{center}
	Now we note $(x)$ and $\left(y-x^2\right)$ are prime ideals because they are irreducible.
\end{proof}

\subsection{Primary Grab-Bag}
In \autoref{cor:easyprimarydecomp}, we saw that when $I$ was a radical ideal, we could write it as a finite intersection of prime ideals. Primary decomposition provides us with a general theory to do something similar for arbitrary modules. Let's start building towards that.

We pick up the following definitions.
\begin{definition}[\texorpdfstring{$\mf p$}{p}-primary]
	Fix $M$ a finitely generated module over $R$ a Noetherian ring. Then a submodle $N\subseteq M$ is \textit{$\mf p$-primary} if and only if $\op{Ass}M/N=\{\mf p\}$.
\end{definition}
\begin{definition}[\texorpdfstring{$\mf p$}{p}-coprimary]
	Fix $M$ a finitely generated module over $R$ a Noetherian ring. Then $M$ is \textit{$\mf p$-coprimary} if and only if $\op{Ass}M=\{\mf p\}$.
\end{definition}
In other words, $N\subseteq M$ is $\mf p$-primary if and only if $M/N$ is $\mf p$-coprimary. Similarly, $M$ is $\mf p$-coprimary if and only if $(0)\subseteq M$ is $\mf p$-primary.

We would like some more concrete conditions for being $\mf p$-primary.
\begin{proposition}
	Fix $M$ a finitely generated module over $R$ a Noetherian ring. Then the following are equivalent.
	\begin{listalph}
		\item $M$ is $\mf p$-coprimary.
		\item $\mf p$ is the unique minimal prime over $\op{Ann}M$, and $\mf p$ contains $\op{Ann}m$ for each $m\in M$. % \todo{I don't think we have to assume that p is unique?}
		\item $\mf p^n\subseteq\op{Ann}M$ for some positive integer $n$, and $\mf p$ contains $\op{Ann}m$ for each $m\in M$.
	\end{listalph}
\end{proposition}
\begin{proof}
	We take our implications one at a time.
	\begin{itemize}
		\item We show that (a) implies (b). We are given that $\op{Ass}M=\{\mf p\}$.
		
		We first show that $\mf p$ is the unique minimal prime over $\op{Ann}M$. Note that $M\ne(0)$ because $\op{Ass}M\ne\emp$, so $\op{Ann}M\ne R$; thus, there is at least one minimal prime over $\op{Ann}M$. But we know that any prime minimal containing $\op{Ann}M$ will be associated (by \autoref{prop:minassprimes}) and therefore must equal $\mf p$. In particular, $\mf p$ is indeed the unique minimal prime over $\op{Ann}M$.

		To finish, we recall from \autoref{prop:unionass} that
		\[\bigcup_{m\in M\setminus\{0\}}\op{Ann}m=\bigcup_{\mf q\in\op{Ass}M}\mf q.\]
		However, $\op{Ass}M=\{\mf p\}$, so the right-hand side is just $\mf p$. Thus, each $m\in M\setminus\{0\}$ has $\op{Ann}m\subseteq\mf p$, as needed.

		\item We have to show that $\mf p^n\subseteq\op{Ann}M$ for some positive integer $n$. By \autoref{prop:radprimes}, we see that
		\[\rad\op{Ann}M=\bigcap_{\rad I\subseteq\mf q}\mf q,\]
		where the intersection is over all primes $\mf q$ containing $\op{Ann}M$. But $\mf p$ is the minimal such prime, so
		\[\mf p=\bigcap_{\rad I\subseteq\mf q}\mf p\subseteq\bigcap_{\rad I\subseteq\mf q}\mf q\subseteq\mf p,\]
		so equalities hold. Thus, $\mf p=\rad\op{Ann}M$. We now finish by appealing to the following lemma.
	\end{itemize}
	\begin{lemma}
		Fix $R$ a Noetherian ring and $I$ and $J$ ideals such that $I\subseteq\rad J$. Then there exists a positive integer $n\in\NN$ such that $I^n\subseteq J$.
	\end{lemma}
	\begin{proof}
		Because $R$ is Noetherian, the ideal $I$ is finitely generated, so we set
		\[I:=(x_1,\ldots,x_m).\]
		Additionally, because $I\subseteq\rad I$, we are promised positiev integers $a_1,\ldots,a_m$ such that $x_k^{a_k}\in I$ for each $x_k$. So we set $n:=a_1+\cdots+a_m$. Indeed, fix some generating element $y_1\cdots y_n\in I^n$ so that each $y_k\in I$. We can write
		\[y_k=\sum_{\ell=1}^mr_{k,\ell}x_\ell\]
		so that when we expand
		\[y_1\cdots y_n=\prod_{k=1}^n\sum_{\ell=1}^mr_{k,\ell}x_\ell,\]
		each monomial $x_1^{d_1}\cdots x_m^{d_m}$ must have some $d_k$ at least $a_k$ because $d_1+\cdots+d_m=n=a_1+\cdots+a_m$. In particular, each monomial lives in $J$, so the full generating element $y_1\cdots y_m$ lives in $J$.
	\end{proof}
	\begin{remark}[Nir]
		The Noetherian condition is necessary. Consider $R:=k[x_1,x_2,x_3,\ldots]$ with $I=(x_1,x_2,x_3,\ldots)$ and $J=\left(x_1,x_2^2,x_3^3,\ldots\right)$. Then any element of $I$ will only use finitely many monomials, so we can reduce to the Noetherian case to show that a sufficiently large power will be contained in $R$, giving $I\subseteq\rad J$. However, for each positive integer $n$, we see $x_{n+1}^n\in I^n\setminus J$, so $I^n\not\subseteq J$.
	\end{remark}
	\begin{itemize}
		\item Lastly, we show that (c) implies (a). The point is to read the arguments above backwards. Because $\mf p$ contains $\op{Ann}m$ for each $m\ne0$, we see that
		\[\mf p\supseteq\bigcup_{m\in M\setminus\{0\}}\op{Ann}m=\bigcup_{\mf q\in\op{Ass}M}\mf q,\]
		where the last equality is by \autoref{prop:unionass}. Namely, $\mf p$ contains all associated primes.

		So suppose $\mf q$ is some associated prime; because we already know that associateed primes exist, it will suffice to show that $\mf q=\mf p$. We know
		\[\mf p^n\subseteq\op{Ann}M\subseteq\mf q\subseteq\mf p,\]
		from which $\mf q=\mf p$ will follow. Indeed, if $x\in\mf p$, we see that $x^n\in\mf p^n\subseteq\mf q$, so $x\in\mf q$ by primality. So $\mf q\subseteq\mf p$, finishing.
		\qedhere
	\end{itemize}
\end{proof}
\begin{corollary}
	Fix $R$ a Noetherian ring. An ideal $I\subseteq R$ is $\mf p$-primary if and only if $\mf p^n\subseteq I$ for some positive integer $n$ and, for all $a\notin I$, we have $ab\in I$ implies $b\in\mf p$.
\end{corollary}
\begin{proof}
	This follows directly from (c) of the proposition. Namely, $I$ is $\mf p$-primary if and only if $R/I$ is $\mf p$-coprimary if and only if $\mf p^n\subseteq I$ for some positive integer $n$ and $\mf p$ contains all $\op{Ann}[a]_I$ for each $[a]_I\in R/I\setminus\{[0]_I\}$. This latter condition is the same as saying, if $a\notin I$, then $ab\in I$ (which is equivalent to $b\in\op{Ann}[a]_I$) implies $b\in\mf p$.
\end{proof}
\begin{example} \label{ex:primepowerprimary}
	Suppose $\mf p\subseteq R$ is a prime ideal. Then, for any positive integer $n$, $\mf p^n$ is $\mf p$-primary: note $\mf p^n\subseteq\mf p^n$ and, for $a\notin\mf p^n$, we see $a\notin\mf p$, so $ab\in\mf p^n$ forces $ab\in\mf p$ and so $b\in\mf p$.
\end{example}

\subsection{Primary Decompositon}
And here is our main result.
\begin{theorem}[Primary decomposition, I]
	Fix $M$ a finitely generated module over a Noetherian ring $R$. Then every submodule $N\subseteq M$ is the intersection of finitely many primary submodules. Such an intersection is called a \textit{primary decomposition}.
\end{theorem}
\begin{proof}
	The key to this result is to instead talk about irreducible decomposition.
	\begin{definition}[Irreducible]
		Fix $M$ a module over a ring $R$. Then a submodule $N\subseteq M$ is \textit{irreducible} if and only if $N=N_1\cap N_2$ for submodules $N_1,N_2\subseteq M$ implies $N=N_1$ or $N=N_2$.
	\end{definition}
	\begin{example} \label{ex:totalisirred}
		The module $M$ is an irreducible submodule of $M$. Indeed, if $N_1,N_2\subseteq M$ have $M=N_1\cap N_2$, then in fact $N_1=N_2=M$ is forced.
	\end{example}
	It will turn out that irreducible implies primary, but we do not know this yet.

	Here is the key claim.
	\begin{lemma}
		Fix $M$ a finitely generated module over a Noetherian ring $R$. Then every submodule $N\subseteq M$ is the intersection of finitely many irreducible submodules. (The empty intersection is considered $M$ here.)
	\end{lemma}
	\begin{proof}
		Suppose for the sake of contradiction that the statement is false so that there is a submodule which is not the intersection of finitely many irreduible submodules. Because $M$ is a Noetherian module, we can find a maximal such submodule $N$.

		Note that $N$ cannot be irreducible, so we can write $N=N_1\cap N_2$ for $N\subsetneq A,B$. But by the maximality of $N$, we can write
		\[A=\bigcap_{k=1}^nA_k\qquad\text{and}\qquad B=\bigcap_{\ell=1}^mB_k,\]
		where the $A_k$ and $B_k$ are irreducible modules. But now
		\[N=A\cap B=\left(\bigcap_{k=1}^nA_k\right)\cap\left(\bigcap_{\ell=1}^mB_k\right),\]
		so $N$ is also the intersection of finitely many irreducible modules, which is a contradiction.
	\end{proof}
	\begin{remark}[Nir]
		This essentially follows the proof of existence of prime factorizations in $\ZZ$: to show that any positive integer $n$ greater than $1$ has a prime factorization, we suppose a minimal counterexample (which corresponds to the maximal submodule).
		
		But the smallest counterexample cannot be prime and is thus a product of primes (which corresponds to the intersection of submodules) and derive from the factors having prime factorizations.
	\end{remark}
	And now we can finish up.
	\begin{lemma}
		Fix $M$ a finitely generated module over a Noetherian ring $R$ and $N\subsetneq M$ a proper submodule. If $N$ is irreducible, then $N$ is primary.
	\end{lemma}
	\begin{proof}
		We know that $\op{Ass}M/N$ is nonempty because $M\ne N$, so we need to show that there is exactly one prime.
		
		We proceed by contraposition. So suppose $\mf p,\mf q\in\op{Ass}M/N$ which are distinct, and we show that $N$ is not irreducible. By \autoref{lem:betterassociated}, we get embeddings
		\[\iota_\mf p:R/\mf p\into M/N\qquad\text{and}\qquad \iota_\mf q:R/\mf p\into M/N.\]
		In particular, let $[m_\mf p]_N:=\iota_\mf p([1]_\mf p)$ and $[m_\mf q]_N:=\iota_\mf q([1]_\mf 1)$. Note that an element $\iota_\mf p([r]_\mf p)\in\im\iota_\mf p$ is nonzero if and only if $r\notin\mf p$ because $\iota_\mf p$ is an embedding. In fact, for any nonzero $\iota_\mf p([r]_\mf p)$, the annihilator consists of $s\in R$ such that
		\[s\cdot r[m_\mf p]=sr\iota_\mf p([1]_\mf p)=\iota_\mf p([sr]_\mf p)\]
		vanishes, but then $r\notin\mf p$ makes this equivalent to $s\in\mf p$.

		So the annihilator of any nonzero element in $\im\iota_\mf p$ is $\mf p$. Similarly, the annihilator of any nonzero element in $\im\iota_\mf q$ is $\mf q$. Thus,
		\[(\im\iota_\mf p)\cap(\im\iota_\mf q)=0.\]
		So we can write
		\[N=(\im\iota_\mf p+N)\cap(\im\iota_\mf q+N)\]
		to break that $N$ is irreducible. Indeed, the $\im\iota_\bullet+N$ strictly contains $N$ because the $\iota_\bullet$ embedded into $M/N$ from a module with more than one element. And $m\in(\im\iota_\mf p+N)\cap(\im\iota_\mf q+N)$ implies that $[m]_N\in(\im\iota_\mf p)\cap(\im\iota_\mf q)$, forcing $m\in N$ as above.
	\end{proof}
	\begin{remark}
		Not all primary modules are irreducible; see \href{https://math.stackexchange.com/a/3040085/869257}{sx3039361}. Namely, set $R:=k[x,y]$ and $I:=(x^2,xy,y^2)=(x,y)^2$. Then $I$ is $(x,y)$-primary by \autoref{ex:primepowerprimary}, but $I$ is not irreducible because
		\[I=\left(x^2,y\right)\cap\left(x,y^2\right).\]
		That $x^2,xy,y^2\in\left(x^2,y\right)\cap\left(x,y^2\right)$ is clear. In the other direction, if we take $f\in\left(x^2,y\right)\cap\left(x,y^2\right)$ and remove all monomials divisible by $x^2$ or $y^2$, the remaining polynomial must live in $(x)\cap(y)=(xy)$.
	\end{remark}
	The above two lemmas essentially finish the theorem. Given our submodule $N\subseteq M$, we give it an irreducible ``decomposition''
	\[N=\bigcap_{k=1}^nN_k.\]
	Note that if any $N_k=M$, then we may safely remove the term because all terms of the intersection are subsets of $M$. So we can write an irreducible decomposition for $N$ where all terms are proper irreducible submodules, which we then know are primary submodules.
\end{proof}
Let's try to make primary decomposition a little more canonical.
\begin{theorem}[Primary decomposition, II]
	Fix $M$ a finitely generated module over a Noetherian ring $R$. Then write some submodule $N\subseteq M$ as
	\[N=\bigcap_{i=1}^nN_i\]
	such that $N_i$ is $\mf p_i$-primary. Then the following are true.
	\begin{listalph}
		\item We have $\op{Ass}M/N\subseteq\{\mf p_1,\ldots,\mf p_n\}$.
		\item If we cannot remove some $N_i$ from the decomposition, then $\mf p_i\in\op{Ass}M/N$. In particular, if we cannot remove any $N_i$ from the decomposition, then equality in (a) holds.
		\item If $n$ is as small as possible, then each $\mf p_i$ is unique.
	\end{listalph}
\end{theorem}
\begin{proof}
	We show these one at a time.
	% For psychological reasons, we note that we may swap $M$ and $N$ with $M/N$ and $(0)$ to assume that $N=(0)$ (without loss of generality).
	\begin{listalph}
		\item Note that we can glue together $M\onto M/N_i$ into a map
		\[M\to\bigoplus_{i=1}^nM/N_i\]
		with kernel $\bigcap_iN_i=N$, so we have an induced embedding $M/N\into\bigoplus_{i=1}^nM/N_i$. Then applying \autoref{lem:assses} and \autoref{cor:dirsumass}, we see
		\[\op{Ass}M/N\subseteq\op{Ass}\left(\bigoplus_{i=1}^nM/N_i\right)=\bigcup_{i=1}^n\op{Ass}M/N_i=\{\mf p_1,\ldots,\mf p_n\},\]
		where the last equality is by definition of the $N_i$.

		\item We are given that, for each $j$, we have
		\[K_j:=\bigcap_{\substack{i=1\\i\ne j}}^nN_i\]
		is not equal to $N$, but $N_j\cap K_j=N$. Thus, we can construct an embedding
		\[\frac{K_j}N=\frac{K_j}{K_j\cap N_j}\cong\frac{N_j+K_j}{N_j}\subseteq\frac M{N_j}\]
		to embed a nonzero submodule of $M/N$ into $M/N_j$. In particular, \autoref{lem:assses} tells us (because of the above embedding) that $\op{Ass}K_j/N\subseteq\op{Ass}M/N_i=\{\mf p_j\}$ forces $\op{Ass}K_j/N=\{\mf p_j\}$ because $K_j/N$ is nonzero.
		
		But then applying \autoref{lem:assses} again, we see $\{\mf p_j\}=\op{Ass}K_j/N\subseteq\op{Ass}M/N$, so we do indeed have $\mf p_j\in\op{Ass}M/N$.

		\item This is easiest done by contraposition: if we have $\mf p:=\mf p_i=\mf p_j$ for $i\ne j$, then we show that we can find a smaller primary decomposition. Indeed, by \autoref{lem:intersectprimary}, we see that $N_i\cap N_j$ will also be $\mf p$-primary, so we can write
		\[N=\bigcap_{k=1}^nN_k=(N_i\cap N_j)\cap\bigcap_{\substack{k=1\\k\ne i,j}}^nN_k\]
		is a primary decomposition of $N$ now using $n-1$ primary submodules.
		\qedhere
	\end{listalph}
\end{proof}
Primary decomposition also behaves with localization.
\begin{theorem}[Primary decomposition, III]
	Fix $M$ a finitely generated module over a Noetherian ring $R$. Then write some submodule $N\subseteq M$ as
	\[N=\bigcap_{i=1}^nN_i\]
	such that $N_i$ is $\mf p_i$-primary. If $U\subseteq R$ is some multiplicatively closed subset, then
	\[N\left[U^{-1}\right]=\bigcap_{\substack{i=1\\\mf p_i\cap U=\emp}}^nN_i\left[U^{-1}\right],\]
	where $N_i\left[U^{-1}\right]$ is $\mf p_i\left[U^{-1}\right]$-primary.
\end{theorem}
\begin{proof}
	By \autoref{lem:localizeintersection}, we see that
	\[N\left[U^{-1}\right]=\bigcap_{i=1}^nN_i\left[U^{-1}\right].\]
	Not all of the $N_i\left[U^{-1}\right]$ will in fact be primary submodules, but we can test which will be assoicated by using \autoref{prop:localizeass} to note
	\[\op{Ass}M\left[U^{-1}\right]/N_i\left[U^{-1}\right]=\left\{\mf p\left[U^{-1}\right]:\mf p\in\op{Ass}M/N_i,\mf p\cap U=\emp\right\}.\]
	(We have implicitly used the fact that localization commutes with quotients.) In particular, $\op{Ass}M/N_i=\{\mf p_i\}$ implies that we only have one prime to check.
	\begin{itemize}
		\item If $\mf p_i\cap U=\emp$, then $\mf p_i\left[U^{-1}\right]$ is in fact a prime, so $\op{Ass}M_i\left[U^{-1}\right]/N_i\left[U^{-1}\right]=\{\mf p_i\left[U^{-1}\right]\}$. Thus, $N_i\left[U^{-1}\right]$ is in fact $\mf p_i\left[U^{-1}\right]$-primary.
		\item Otherwise if $\mf p_i\cap U\ne\emp$, then we see that $\op{Ass}M\left[U^{-1}\right]/N_i\left[U^{-1}\right]$ is empty, so the quotient is $0$, so $N_i\left[U^{-1}\right]=M\left[U^{-1}\right]$. In particular, we can remove $N_i\left[U^{-1}\right]$ from the intersection.
	\end{itemize}
	So we see that
	\[N\left[U^{-1}\right]=\bigcap_{\substack{i=1\\\mf p_i\cap U=\emp}}^nN_i\left[U^{-1}\right],\]
	and we have in fact verified that each $N_i\left[U^{-1}\right]$ is $\mf p_i\left[U^{-1}\right]$-primary, so this provides a primary decomposition.
\end{proof}

\subsection{Examples of Primary Decomposition}
Let's do some examples.
\begin{example}
	For any nonzero integer $n\in\ZZ\setminus\{0\}$, we can write
	\[(n)=\prod_{p\text{ prime}}\left(p^{\alpha_p}\right),\]
	for some exponents $\alpha_p$. This is our primary decomposition, and it is unique.
	% \todo{what if n=0 here?}
\end{example}
\begin{example}
	In general, if $R$ is a unique factorization domain, then any $f\in R$ will have
	\[f=up_1^{d_1}\cdots p_n^{d_n}\]
	for some unit $u$, primes $p_\bullet$, and exponents $d_\bullet$. Then
	\[(f)=\bigcap_{i=1}^n\left(p_i^{d_i}\right).\]
\end{example}
In fact, we have the following statement.
\begin{proposition}
	Fix $R$ a Noetherian domain. Then $R$ is a unique factorization domain if and only if every minimal prime ideal over a principal ideal is principal.
\end{proposition}
\begin{proof}
	We omit this proof. The main idea to the backwards direction is to take a minimal prime ideal $(p)$ to sufficiently high power to read off the exponent.
\end{proof}

We remark that primary decomposition is not unique, in general, however.
\begin{example}
	Consider $R:=k[x,y]/\left(x^2,xy\right)$. As a $k$-module, this has basis $\{1,x,y,y^2,y^3\ldots\}$. Now, we see that we can write
	\[(x)\cap\left(y^n\right)=\left(xy^n\right)=(0)\]
	for any $n\in\NN$. This is a primary decomposition: in particular, $R/\left(y^n\right)$ is a local ring (notably, all the basis elements other than $1$ nilpotent, so $R$ minus their $k$-span is the unique maximal ideal), and our associated prime is $(x,y)R/\left(y^n\right)$. Additionally, $R/(x)$ will have unique maximal ideal $(x,y)/(x)$, for similar reasons.
\end{example}
The point is that the above example provides ``lots'' of different minimal primary decompositions.

\subsection{Graded Rings}
We will want to consider primary decomposition for graded rings because later in life we will want to talk about projective space.
\begin{proposition}
	Fix $R=R_0\oplus R_1\oplus\cdots$ a graded ring and $M$ a graded module over $R$. Suppose that we have $m\in M$ and $\mf p:=\op{Ann}m$ a prime ideal. Then $\mf p$ is a graded ideal of $R$.
\end{proposition}
In other words, associated primes of a graded module are graded.
\begin{proof}
	We have to show that
	\[\mf p=\bigoplus_{i=1}^\infty(R_i\cap\mf p).\]
	So we write, for some $f\in\mf p$, that
	\[f=\sum_{i=1}^p f_i,\]
	where $f_i\in R_{d_i}$, and $d_1<\cdots<d_n$. By induction, it will be enough to show that $f_1\in\mf p$ and then consider $f-f_1$ to continue. 
	
	Well, we may write
	\[m=\sum_{j\in\ZZ}^qm_j,\]
	where $m_j\in R_{e_j}$. Because $fm=0$, the term of lowest degree, which is $f_1m_1$, must itself vanish, so
	\[f_1m=\sum_{j=2}^pf_1m_j.\]
	Thus $\mf p\subseteq\op{Ann}f_1m$, so we set $I:=\op{Ann}f_1m$. If $\mf p=\op{Ann}f_1m$, then we are done because we have effectively removed our decomposition. Otherwise, we can find $g\in I\setminus\mf p$. But then $gf_1$ annihilates $m$, so $gf_1\in\mf p$, so $f_1\in\mf p$, and we are done.
\end{proof}