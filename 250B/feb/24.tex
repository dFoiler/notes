% !TEX root = ../notes.tex

So it's the day after death.

\subsection{Midterm Review}
Let's start talking about the second problem on the midterm.
\begin{exe}
	Identify matrices $X\in\CC^{2\times2}$ with $\AA^4(\CC)$ by
	\[\begin{bmatrix}
		a & b \\
		c & d
	\end{bmatrix}\mapsto(a,b,c,d).\]
	Let $Z:=\left\{X\in\CC^{2\times2}:X^2=0\right\}$. Then show that the ideal $I(Z)$ is prime.
\end{exe}
\begin{proof}
	We start by showing
	\[Z=\{(a,b,c,d):a+d=ad-bc=0\}.\]
	In one direction, we note that $X^2=0$ implies that all eigenvalues are $0$, so the characteristic polynomial of $X$ will be $X^2=0$, so we see that $\tr X=\det X=0$. Thus, $(a,b,c,d)\in I$ implies $a+d=ad-bc=0$.

	Conversely, if $(a,b,c,d)$ have $a+d=ad-bc=0$, then the associated matrix $X$ satisfies the equation
	\[x^2=x^2-(\tr X)x+\det X=0\]
	by \autoref{thm:ch}, so we conclude that $X^2=0$.

	Now, we see that $Z=Z(a+d,ad-bc)$, so by \autoref{thm:nullstellensatz},
	\[I(Z)=\rad(a+d,ad-bc).\]
	So we claim that $(a+d,ad-bc)$ is prime, which will show that it is radical and therefore showing $I(Z)=(a+d,ad-bc)$ is prime. To show $(a+d,ad-bc)$ is prime, we note that we have a map
	\[\CC[a,b,c,d]\to\CC[a,b,c]\]
	by sending $d\mapsto-a$. It is not too hard to check that $(a+d)$ is the kernel of this map, so we have an embedding
	\[\frac{\CC[a,b,c,d]}{(a+d)}\into\CC[a,b,c].\]
	Now, if we want to mod out the left by $(ad-bc)$, this goes to $\left(-a^2-bc\right)=\left(a^2+bc\right)$ on the right. In fact, the pre-image of $\left(a^2+bc\right)$ we can check will actually be $(a+d)$, so we get an embedding
	\[\frac{\CC[a,b,c,d]}{(a+d,ad-bc)}\into\frac{\CC[a,b,c]}{\left(a^2+bc\right)}.\]
	Now, to show that $(a+d,ad-bc)$ is prime, it suffices to show that the left-hand ring is an integral domain, for which it suffices to show that $\CC[a,b,c]/\left(a^2+bc\right)$ is an integral domain, for which it suffices to show that $a^2+bc$ is an irreducible element because $\CC[a,b,c]$ is a unique factorization domain. Well, by degree arguments with $a$, the only way to factor this would be as
	\[(a+f)(a+g)\qquad\text{or}\qquad\left(a^2+f\right)g,\]
	where $f$ and $g$ feature no $a$s. The former would force $ag$ and $af$, but $a^2+bc$ has no terms other than $a^2$ with an $a$. The latter would force $g=1$ because of the $a^2g$ term, so this factorization is trivial.
\end{proof}

\subsection{Filtrations of Rings}
Today we are talking about the Artin--Rees lemma, which requires us talking about filtrations. Here is our definition.
\begin{definition}[Filtration, rings]
	Fix $R$ a ring. Then a \textit{filtration} of $R$ is a sequence of ideals $\{I_p\}_{p\in\NN}$ forming the chain
	\[R=I_0\supseteq I_1\supseteq I_2\supseteq\cdots\]
	such that $I_pI_q\subseteq I_{p+q}$.
\end{definition}
While we're here, we record the following philosophy.
\begin{idea}
	Filtrations are useful to understand an object in smaller steps.
\end{idea}
Anyways, the condition $I_pI_q\subseteq I_{p+q}$ should remind us of grading, and indeed graded rings have nice filtrations.
\begin{exe}[``Graded'' filtration] \label{exe:gradedfiltration}
	Fix $R=R_0\oplus R_1\oplus R_2\oplus\cdots$ a graded ring. Then the ideals
	\[I_p:=\bigoplus_{i\ge p}R_i\]
	form a filtration.
\end{exe}
\begin{proof}
	We see that $R=I_0$ and $I_p\supseteq I_{p+1}$ is by construction, so we are allowed to write
	\[R=I_0\supseteq I_1\supseteq I_2\supseteq\cdots.\]
	Additionally, for any $f\in I_p$ and $g\in I_q$, then we can write out
	\[f=\sum_{i\ge p}a_i\qquad\text{and}\qquad g=\sum_{j\ge q}b_j\]
	with $a_i\in R_i$ and $b_j\in R_j$ so that, upon distributing,
	\[fg=\sum_{i\ge p,j\ge q}a_ib_j.\]
	Each term $a_ib_j$ lives in $R_iR_j\subseteq R_{i+j}\subseteq I_{p+q}$, so $fg\in I_{p+q}$.
\end{proof}
Here is our other chief example of filtration.
\begin{defihelper}[\texorpdfstring{$I$}{I}-adic filtration] \nirindex{I-adic filtration @\texorpdfstring{$I$}{I}-adic filtration}
	Fix $R$ a ring and $I\subseteq R$ an ideal. Then
	\[R=I^0\supseteq I^1\supseteq I^2\supseteq I^3\supseteq\cdots\]
	is a filtration. This is called the \textit{$I$-adic filtration}.
\end{defihelper}
As a brief justification, we see that $R=I^0$ by definition of $I^0$; $I^p\supseteq I^{p+1}$ is because $II^k\subseteq RI^k=I^k$; and lastly, $I^pI^q=I^{p+q}\subseteq I^{p+1}$.
\begin{exe}
	The graded filtration produced by grading $R=k[x_1,\ldots,x_n]$ by degree and using \autoref{exe:gradedfiltration} is the $(x_1,\ldots,x_n)$-adic filtration.
\end{exe}
\begin{proof}
	Let $R_d\subseteq k[x_1,\ldots,x_n]$ be the union of $\{0\}$ and the polynomials homogeneous of degree $d$. Then, fixing some nonnegative integer $p$, we are asserting that
	\[\bigoplus_{i\ge d}R_d\stackrel?=(x_1,\ldots,x_n)^d.\]
	But this is true essentially by tracking through what everything means. By definition,
	\[(x_1,\ldots,x_n)^d=\left(x_1^{d_1}\cdots x_n^{d_n}:d_1+\cdots+d_n=d\right).\]
	In particular, $(x_1,\ldots,x_n)^d$ is generated by elements in $R_d\subseteq\bigoplus_{i\ge d}R_d$.

	In the other direction, suppose that we have any $f\in\bigoplus_{i\ge d}R_d$. Then we can decompose
	\[f=\sum_{i\ge d}f_i,\]
	where $f_i\in R_i$. We claim that each $f_i$ lives in $(x_1,\ldots,x_n)^d$, which will finish by showing $f\in(x_1,\ldots,x_n)^d$. Well, by definition of $R_i$, we can write
	\[f_i(x_1,\ldots,x_n)=\sum_{d_1+\cdots+d_n=i}a_{(d_1,\ldots,d_n)}x_1^{d_1}\cdots x_n^{d_n}.\]
	Now, $d_1+\cdots+d_n=i\ge d$, so the monomial $x_1^{d_1}\cdots x_n^{d_n}$ is divisible by a polynomial of degree $d$ and therefore lives in $(x_1,\ldots,x_n)^d$.\footnote{Writing this out would be very annoying; here is one way: find the largest $m\ge0$ such that $d_1+\cdots+d_m<d$. Note $m<n$ because $d<i$. Then $x_1^{d_1}\cdots x_m^{d_m}x_{m+1}^{n-(d_1+\cdots+d_m)}$ divides $x_1^{d_1}\cdots x_n^{d_n}$.} So each monomial in the expansion of $f_i$ lives in $x_1^{d_1}\cdots x_n^{d_n}$, so $f_i$ lives in $x_1^{d_1}\cdots x_n^{d_n}$.
\end{proof}
\begin{remark}[Nir, Miles]
	Fix a graded ring $R$ and $I$ the irrelevant ideal. It is not in general true that the ``graded'' filtration from \autoref{exe:gradedfiltration} is the same as the $I$-adic filtration. For example, consider $R:=k\left[x^2\right]$ graded by degree; namely,
	\[R_{2d}=kx^{2d}\qquad\text{and}\qquad R_{2d+1}=0.\]
	Then we see that $I$ contains no nonzero linear polynomials, so $I^2$ will contain no nonzero quadratic polynomials, so the second term of the $I$-adic filtration has no quadratics. However, the graded filtration has the second term as $R_2\oplus R_3\oplus\cdots$, which definitely contains quadratics.
\end{remark}
To set up the discussion that follows, we note that, if we have a filtration
\[R=I_0\supseteq I_1\supseteq I_2\supseteq\cdots,\]
we might be interested in the ``bottom'' of this filtration
\[I:=\bigcap_{i=0}^\infty I_i.\]
It is not too hard to check that this is an ideal: $x,y\in I$ and $r,s\in R$ have $x,y\in I_i$ and therefore $rx+sy\in I_i$ for any $i$, so $rx+sy\in I$. Now, if we have a ``good'' filtration, we might hope that $I=0$ so that our filtration can actually see to the bottom of $R$. Of course, we will need some conditions on the filtration to guarantee this.

\subsection{Associated Graded Rings}
We saw that gradings give filtrations back in \autoref{exe:gradedfiltration}. We can partially go the other way as well.
\begin{definition}[Associated graded ring]
	Fix a ring $R$ and a filtration $\mathcal J$ notated
	\[R= I_0\supseteq I_1\supseteq I_2\supseteq\cdots.\]
	Then we set $R_i:=I_i/I_{i+1}$ and define
	\[\op{gr}_{\mathcal J}R:=\bigoplus_{p\ge0}I_p/I_{p+1}\]
	to be the \textit{associated graded ring}. If $\mathcal J$ is the $I$-adic filtration, we denote the associated graded ring by $\op{gr}_I(R)$. If the filtration is obvious, we will omit the subscript entirely.
\end{definition}
A priori, the associated graded ring is only some very large module, but we can give it a ring structure as follows: if we have terms $[a]\in I_p/I_{p+1}$ and $[b]\in I_q/I_{q+1}$, then we can lift them to some $a\in I_p$ and $b\in I_q$ so that $ab\in I_pI_q\subseteq I_{p+q}$, so we set
\[[a]\cdot[b]:=[ab]\in I_{p+q}/I_{p+q+1}.\]
We now run the following checks.
\begin{lemma}
	Fix $R$ a ring and filtration $\mathcal J$ notated
	\[R=I_0\supseteq I_1\supseteq I_2\supseteq\cdots.\]
	The above multiplication on $\op{gr}_\mathcal JR$ makes $\op{gr}_\mathcal JR$ into a graded ring in the natural way by $(\op{gr}_\mathcal JR)_p:=I_p/I_{p+1}$.
\end{lemma}
\begin{proof}
	We start by showing that the multiplication of our ``homogeneous'' elements is well-defined. If $a\equiv a'\pmod{I_{p+1}}$ both represent $[a]$ and $b\equiv b'\pmod{I_{q+1}}$ both represent $[b]$, then
	\[ab-a'b'=ab-ab'+ab'-a'b'=a(b-b')+(a-a')b'.\]
	Now, $a\in I_p$ and $b-b'\in I_{q+1}$, so $a(b-b')\in I_{p+q+1}$; similarly, $a-a'\in I_{p+1}$ and $b'\in I_q$, so $(a-a')b\in I_{p+q+1}$. Thus, the entire element lives in $I_{p+q+1}$, so $ab\equiv a'b'\pmod{I_{p+q+1}}$.
	
	Now we acknowledge that the above multiplication law extends distributively as
	\[\left(\sum_{p\ge0}[a_p]_{I_{p+1}}\right)\left(\sum_{q\ge0}[b_q]_{I_q}\right):=\sum_{n\ge0}\left(\sum_{p+q=n}[a_pb_q]_{I_{n+1}}\right).\]
	So we have indeed defined a multiplication on all of $\op{gr}_\mathcal JR$. We remark that we can see somewhat directly that one could imagine showing that the multiplication commutes (this is not so bad), associates (the point is to write the inner sum as $p+q+r=n$), and distributes (cry), but we will not write out these checks; the curious can port over the proof that multiplication in $R[x]$ forms a ring structure. % \todo{maybe do write out these checks?}

	It remains to show that the ring is actually graded in the natural way. Specifically, we need to show that
	\[(\op{gr}_\mathcal JR)_p(\op{gr}_\mathcal JR)_q\subseteq(\op{gr}_\mathcal JR)_{p+q}.\]
	But this is by definition of our multiplication: we see that $(\op{gr}_\mathcal JR)_p(\op{gr}_\mathcal JR)_q$ is generated by products
	\[[a]_{I_{p+1}}[b]_{I_{q+1}}=[ab]_{I_{p+q+1}}\in(\op{gr}_\mathcal JR)_{p+q},\]
	where $[a]_{I_{p+1}}\in(\op{gr}_\mathcal JR)_p$ and $[b]_{I_{q+1}}\in(\op{gr}_\mathcal JR)_q$.
\end{proof}
\begin{remark}
	Technically we should say that the element
	\[[1]_I+[0]_{I^2}+[0]_{I^3}+\cdots\]
	is our unit element. Indeed, we can compute
	\[([1]_I+[0]_{I^2}+[0]_{I^3}+\cdots)\cdot[a]_{I^n}=[a]_I^n\]
	by looking component-wise, and our identity will extend to all of $\op{gr}_\mathcal JR$ by how we defined our multiplication.
\end{remark}
\begin{remark}[Nir] \label{rem:iadicgradedmodule}
	In fact, $\op{gr}_IR$ is an $R/I$-module. Indeed, our map $R\to\op{End}_R(\op{gr}_IR)$ is created by stitching together the maps
	\[R\to\op{End}_R\left(I^p/I^{p+1}\right)\]
	by $r\mapsto([x]\mapsto[rx])$. However, we note that if $r\in I$ with $[x]\in I^p/I^{p+1}$, then $[rx]\in I^{p+1}/I^{p+1}$, so $[rx]=0$. In particular, the above map has $I$ in its kernel, so we actually get to stitch together the maps
	\[R/I\to\op{End}_R\left(I^p/I^{p+1}\right)\]
	to a map $R/I\to\op{End}_R(\op{gr}_IR)$.
\end{remark}
Anyways, let's see some examples.
\begin{exe}
	Fix $R:=k[[x]]$ and $I:=(x)$. We show that $\op{gr}_IR\cong k[x]$ as graded rings.
\end{exe}
\begin{proof}
	Here we are using the $I$-adic filtration given by $I^n=(x)^n=\left(x^n\right)$. In particular, given any
	\[f(x)=\sum_{d\ge n}a_dx^d\in\left(x^n\right),\]
	we see that $\sum_{d\ge n+1}a_dx^d\in\left(x^{n+1}\right)$, so we can give $f(x)\in I^n/I^{n+1}$ a fairly natural representative by
	\[f(x)=a_nx^n+\sum_{d\ge n+1}a_dx^d\equiv a_nx^n\pmod{I^{n+1}}.\]
	So, given $f(x)\in I^n/I^{n+1}$, we define $\varphi_n(f(x)):=a_nx^n$ so that $\varphi_n:I^n/I^{n+1}\to kx^n$. As such, we can assemble the $\varphi_n$ into a map
	\[\varphi:\bigoplus_{n\ge0}I^n/I^{n+1}\to\bigoplus_{n\ge0}kx^n\]
	component-wise. Now, we observe that the domain of $\varphi$ is $\op{gr}_IR$ and the codomain is $k[x]$, so it remains to show that $\varphi$ is an isomorphism of graded rings.

	We start by showing that $\varphi$ is a graded homomorphism. The grading part is fairly simple because $\varphi$ restricts to $\varphi_n:I^n/I^{n+1}\to kx^n$ on each component, so $\varphi$ does preserve the grading. Now, by the universal property of direct sums, it suffices to show that each $\varphi_n$ is a group homomorphism. Well, if we pick up
	\[f(x)=\sum_{d\ge n}a_dx^d\qquad\text{and}\qquad g(x)=\sum_{d\ge n}b_dx^d,\]
	and we compute
	\[\varphi_n\left([f]_{I^{n+1}}+[g]_{I^{n+1}}\right)=\varphi_n\left([f+g]_{I^{n+1}}\right)=a_nx^n+b_nx^n=\varphi_n\left([f]_{I^{n+1}}\right)+\varphi_n\left([g]_{I^{n+1}}\right).\]
	Continuing, we see that $\varphi$ preserves identity because
	\[\varphi(1)=\varphi\left(\sum_{n\ge0}[1_{n=0}]_{I^{n+1}}\right)=\sum_{n\ge0}1_{n=0}=1.\]
	Lastly, to check that $\varphi$ is multiplicative, we note that our multiplication was uniquely determined by what it did to homogeneous elements, so it suffices to show that $\varphi$ is multiplicative on homogeneous elements, for this will extend by distributivity. So pick up
	\[f_n(x)=\sum_{d\ge n}a_dx^d\qquad\text{and}\qquad g_m(x)=\sum_{e\ge m}b_ex^e\]
	so that $\varphi_n(f_n)=a_d$ and $\varphi_m(g_m)=b_mx^m$. Then $[f_n]_{I^{n+1}}=\left[a_nx^n\right]_{I^{n+1}}$ and $[g_m]_{I^{m+1}}=\left[b_mx^m\right]_{I^{m+1}}$ so that the well-definedness of our multiplication promises
	\[\varphi_{n+m}\left([f_n]_{I^{n+1}}\cdot[g_m]_{I^{m+1}}\right)=\varphi_{n+m}\left([a_nb_mx^{n+m}]_{I^{n+m+1}}\right)=a_nx^n\cdot b_mx^m=\varphi_n\left([f_n]_{I^{n+1}}\right)\cdot\varphi_m\left([g_m]_{I^{m+1}}\right),\]
	which is what we wanted. To be convinced that our distributivity hand-waving is legitimate, we note that we could write out
	\[\varphi\left(\sum_{p\ge0}[f_p]\cdot\sum_{q\ge0}[g_q]\right)=\varphi\left(\sum_{p+q=n}[f_pg_q]\right)=\sum_{p+q=n}\varphi_{p+q}([f_pg_q])=\sum_{p+q=n}\varphi_p([f_p])\varphi_q([g_q]),\]
	which we can then distribute backwards to $\varphi\left(\sum_p[f_p]\right)\varphi\left(\sum_q[g_q]\right)$.

	It remains to show that $\varphi$ is a bijection. For this, it suffices to show that $\varphi$ is an isomorphism of $R$-modules, for which we note that it suffices to check that $\varphi$ restricts to an isomorphism on each component $\varphi_n:I^n/I^{n+1}\to kx^n$. In fact, we already know that this is a group homomorphism (because $\varphi$ is additive), so we merely need to know that $\varphi_n$ is bijective.
	\begin{itemize}
		\item We show that $\varphi_n$ is surjective. Well, given $a_nx^n$, we see that $\varphi_n\left(\left[a_nx^n\right]_{I^{n+1}}\right)=a_nx^n$.
		\item We show that $\varphi_n$ is injective. Well, suppose that $f\in I^n$ has $\varphi_n\left([f]_{I^{n+1}}\right)=0x^n$. Then, by definition, our expansion
		\[f(x)=\sum_{d\ge n}a_dx^d\]
		has $a_n=0$. In particular, we can write $f(x)=\sum_{d\ge n+1}a_dx^d$ so that $f(x)\in I^{n+1}$, so $[f]_{I^{n+1}}=[0]_{I^{n+1}}$, which is what we wanted.
	\end{itemize}
	The above checks finish the proof that $\varphi$ is an isomorphism.
\end{proof}
% \begin{example}
% 	We work in $R:=k[[x]]$, which is local with maximal ideal $I:=(x)$. Then $I^n=\left(x^n\right)$ gives rise an $I$-adic filtration. We can compute
% 	\[I^n/I^{n+1}\cong\left\{ax^n:a\in k\right\}\cong kx^n\]
% 	because we are taking ($0$ or) a very long polynomial with minimal degree $x^n$ and then killing all higher degree terms. So our filtration reads as
% 	\[\op{gr}_IR=R/I\oplus I/I^2\oplus I^2/I^\oplus\cdots=k\oplus kx\oplus kx^2\oplus\cdots=k[x].\]
% 	We can check that the multiplication rule actually matches.
% \end{example}
We will be briefer with our next example because it is similar.
\begin{example} % \todo{add details}
	Fix $R=\ZZ$ and $I=(p)$ a prime ideal, where $p>0$ is a positive prime. Then, in $I^n/I^{n+1}=p^n\ZZ/p^{n+1}\ZZ$, all elements have a unique representative as $\left[p^na\right]_{p^{n+1}}$ for $a\in\ZZ/p\ZZ$, so we can represent anyone in $\op{gr}_IR$ by
	\[a_0+a_1p+a_2p^2+\cdots\]
	where $a_0,a_1,a_2\ldots\in\ZZ/p\ZZ$. In particular, we can see that multiplication of homogeneous elements behaves as
	\[\left[a_kp^k\right]_{p^{k+1}}\cdot\left[b_\ell p^\ell\right]_{p^{\ell+1}}=\left[a_kb_\ell p^{k+\ell}\right]_{p^{k+\ell+1}}.\]
	In particular, if we imagine taking $p\mapsto x$, the above is really the polynomial grading, so we see that extending $p\mapsto x$ to all of $\op{gr}_{(p)}\ZZ$ gives an isomorphism $\op{gr}_{(p)}\ZZ\cong(\ZZ/p\ZZ)[x]$.
\end{example}

\subsection{Initial Forms}
We begin with the following warning.
\begin{warn}
	There is no natural ring homomorphism $R\to\op{gr}_{\mathcal J}R$.
\end{warn}
This is sad because we would like to use the associated graded ring to understand the original ring, so not having a natural map significantly hinders our ability.

However, there is a natural map of sets.
\begin{definition}[Initial form]
	Fix $R$ a ring and $\mathcal J$ a filtration notated
	\[R=I_0\supseteq I_1\supseteq I_2\supseteq\cdots.\]
	Then, fix $f\in R$, and we define the \textit{initial form of $f$} $\op{in}f\in\op{gr}_IR$ as follows.
	\begin{itemize}
		\item If $f\in I_p$ for all $p$, then $\op{in}f=0$.
		\item If $f\in I_p$ but $f\notin I_{p+1}$, then $\op{in}f=[f]_{I_{p+1}}$.
	\end{itemize}
	Intuitively, $\op{in}$ extracts the smallest ``homogeneous'' part of $f$ to put in $\op{gr}_IR$; we return $0$ when this is impossible.
\end{definition}
This map of sets really does not have extra structure, though it feels like it comes close, which is reassuring.
\begin{remark}[Nir]
	To see that $\op{in}$ is not a ring homomorphism, we see that it is not additive. Consider $R=k[x]$ given the $(x)$-adic filtration.
	\begin{itemize}
		\item Take $f=x$ so that $\op{in}f=[x]_{x^2}$.
		\item Take $g=x^2$ so that $\op{in}g=\left[x^2\right]_{x^3}$.
		\item Then $f+g=x+x^2$ so that $\op{in}(f+g)=[x]_{x^2}$.
	\end{itemize}
	Notably, $\op{in}f+\op{in}g$ is not even homogeneous, but the image of $\op{in}$ always is. In general, we will have $\op{in}f+\op{in}g\in\{\op{in}f,\op{in}g,\op{in}(f+g)\}$ based off of if $f$ and $g$ live in the same part of the filtration; we will prove this shortly.
\end{remark}
In fact, $\op{in}$ need not even be multiplicative, though it is almost multiplicative.
\begin{proposition} \label{prop:multinitialform}
	Fix $R$ a ring and $\mathcal J$ a filtration
	\[R=I_0\supseteq I_1\supseteq I_2\supseteq\cdots.\]
	Then, given $f,g\in R$, we have $\op{in}f\cdot\op{in}g\in\{\op{in}(fg),0\}$. If $\op{gr}_\mathcal JR$ is an integral domain, then $\op{in}f\cdot\op{in}g=\op{in}(fg)$.
\end{proposition}
\begin{proof}
	Very quickly, suppose that one of $f$ or $g$ lives in $I_p$ for all $P$. Without loss of generality, say that $f\in I_p$ for all $I_p$, so $fg\in I_p\in I_p$ for all $p$, so
	\[\op{in}(fg)=0=\op{in}f=\cdot\op{in}f\cdot\op{in}g,\]
	dealing with the case of $\op{gr}_\mathcal JR$ an integral domain automatically as well.

	Otherwise, we have $f\in I_p\setminus I_{p+1}$ and $g\in I_q\setminus I_{q+1}$ for some $p$ and $q$ so that $\op{in}f=[f]_{I_{p+1}}$ and $\op{in}g=[g]_{I_{q+1}}$. Because $\mathcal J$ is a filtration, we see that
	\[fg\in I_pI_q\subseteq I_{p+q}.\]
	We now have two cases.
	\begin{itemize}
		\item If $fg\notin I_{p+q+1}$, then $\op{in}(fg)=[fg]_{I_{p+q+1}}=[f]_{I_{p+1}}\cdot[g]_{I_{q+1}}=\op{in}f\cdot\op{in}g$.
		\item If $fg\in I_{p+q+1}$, then $\op{in}f\cdot\op{in}g=[fg]_{I_{p+q+1}}=0$.
	\end{itemize}
	The above casework finishes the proof of the general case. When $\op{gr}_\mathcal JR$ is an integral domain, we note that $\op{in}f,\op{in}g\ne0$ disallows the second case, so we will always have $\op{in}f\cdot\op{in}g=\op{in}(fg)$.
\end{proof}

\subsection{Tangent Cone} \todo{Figure out what is happening here}
It turns out that the initial form has a nice geometric application.
\begin{example}
	Fix $X\subseteq\AA^n(k)$ a Zariski closed set with $X=Z(J)$ such that $J\subseteq k[x_1,\ldots,x_n]=:R$ is an ideal. Taking $p\in X$ to correspond to a maximal ideal $\mf m\subseteq A(X)$, we claim that
	\[\op{gr}_IR\]
	is the ring corresponding to the ``tangent cone to $p$ at $X$.''
\end{example}
As an example, consider the curve $y^2=x^2(x+1)$, which splits at $0$. Here is the image.
\begin{center}
	\begin{asy}
		unitsize(1cm);
		import graph;
		real x(real t)
		{
			return t*t-1;
		}
		real y(real t)
		{
			return t*(t*t-1);
		}
		draw(graph(x, y,-1.521,1.521));
		draw((-1.5,0) -- (2,0)); label("$x$", (2,0), E);
		draw((0,-2) -- (0,2)); label("$y$", (0,2), N);
	\end{asy}
\end{center}
At a point which is not $(0,0)$, we will have a line and therefore will expect to get a polynomial ring.

However, let's focus on what happens at $(0,0)$. Analytically, we find that
\[\frac{y^2}{x^2}=x+1.\]
Very close to $(0,0)$, we get that
\[\left(\frac{dy}{dx}\right)^2=1\]
so that the slope is $\pm1$.

Let's try to think more algebraically. We have the following lemma.
\begin{lemma}
	Work in the context of the above example. Then
	\[\op{gr}_I(R/J)=(\op{gr}_IR)/\op{in}J.\]
\end{lemma}
\begin{proof}
	This is on the homework.
\end{proof}
The point of this lemma is that $\op{gr}_IR$ we know to be a polynomial ring. With $I=(x,y)$ as in the example we are working out, we find that $\op{in}(x)^2=\op{in}(y)^2$ because our ideal $J$ is $y^2-x^2(x+1)$. Namely, our associated ring looks like functions generated by the lines $\op{in}x=\op{in}y$ and $\op{in}x=-\op{in}y$, which is what we expected.

In contrast, the cusp $y^2=x^3-x$ will give a double point, generated only at $\op{in}(x)^2$. Here, we will be generated by $(\op{in}y)^2$, which is what our cusp looks like intuitively.

\subsection{Filtrations of Modules}
Consider the following construction.
\begin{defi}[Hilbert function, rings] \label{def:hilbfuncring}
	Fix $R$ a local Noetherian ring with maximal ideal $\mf m$. Then we define the \textit{Hilbert function of $R$} as
	\[H_R(s):=\dim_{R/\mf m}(\op{gr}_\mf mR)_s=\dim_{R/\mf m}\left(\mf m^s/\mf m^{s+1}\right).\]
	Note that this definition is well-formed because $R/I$ is a field.
\end{defi}
We note that the definition of $H_R(s)$ is well-formed: $\mf m^s/\mf m^{s+1}$ is in fact an $R/\mf m$-module by \autoref{rem:iadicgradedmodule}, which is actually an $R/\mf m$-vector space because $R/\mf m$ is a field. As for finiteness, $\mf m^s$ is a finitely generated $R$-module (because $R$ is Noetherian), so $\mf m^s/\mf m^{s+1}$ is as well, so $\mf m^s/\mf m^{s+1}$ is a finite-dimensional $R/\mf m$-vector space.

The theory of the Hilbert function was actually stated for modules, so we would like to generalize this to modules. We have the following series of definitions.
\begin{definition}[Filtration, modules]
	Given an $R$-module $M$, a \textit{filtration} is a descending chain
	\[M=M_0\supseteq M_1\supseteq M_2\supseteq\cdots.\]
	Given an ideal $I$, the above is an \textit{$I$-filtration} if and only if $IM_q\subseteq M_{q+1}$. Note that this last condition is equivalent to $I^sM_q\subseteq M_{s+q}$ by an induction.
\end{definition}
Note there is no multiplicative condition on the filtration because $M$ has no multiplication.

As before, from filtrations we can build the associated graded module.
\begin{definition}[Associated graded module]
	Fix an $R$-module $M$ with a filtration $\mathcal J$, denoted by
	\[M=M_0\supseteq M_1\supseteq M_2\supseteq\cdots.\]
	Then we define
	\[\op{gr}_\mathcal JM:=\bigoplus_{s\ge0}M_s/M_{s+1}=M/M_1\oplus M_1/M_2\oplus\cdots.\]
\end{definition}
A priori, $\op{gr}_\mathcal JM$ merely has an $R$-module structure inherited as a direct sum, but when $\mathcal J$ is an $I$-filtration, then we do get a graded structure from our graded module.
\begin{lemma}
	Fix an $R$-module and $I\subseteq R$ an ideal. If $M$ is an $R$-module with an $I$-filtration $\mathcal J$ denoted by
	\[M=M_0\supseteq M_1\supseteq M_2\supseteq\cdots,\]
	then $\op{gr}_\mathcal JM$ is a $\op{gr}_IR$-module.
\end{lemma}
\begin{proof}
	We start by describing our action. Given $[a]_{I^{s+1}}\in I^s/I^{s+1}$ and $[b]_{M_{q+1}}\in M_q/M_{q+1}$, we see that
	\[ab\in I^sM_q\subseteq M_{s+q}.\]
	In fact, if we pick up another representative $[a]=[a']$ and $[b]=[b']$, then
	\[ab-a'b'=ab-ab'+ab'-a'b'=a(b-b')+(a-a')b'\in I^sM_{q+1}+I^{s+1}M_q\subseteq M_{s+q+1}.\]
	Thus, the representative $[ab]_{M_{s+q+1}}\in M_{s+q}/M_{s+q+1}$ is unique of the exact choice of representative for $a$ and $b$. We have the following checks on this action.
	\begin{itemize}
		\item Fix $[a]_{I^{s+1}}$; then the action on $M_q$ is $R$-linear: we compute
		\[[a]_{I^{s+1}}\cdot\left(r_1[b_1]_{M_{q+1}}+r_2[b_2]_{M_{q+1}}\right)=[ar_1b_1+ar_2b_2]_{M_{q+1}}=r_1\left([a]_{I^{s+1}}\cdot[b_1]_{M_{q+1}}\right)+r_2\left([a]_{I^{s+1}}\cdot[b_2]_{M_{q+1}}\right).\]
		In particular, we see that we have defined a function
		\[(\op{gr}_IR)_s\to\op{Hom}_R\left((\op{gr}_\mathcal JM)_q,(\op{gr}_\mathcal JM)_{q+s}\right)\]
		\item The function defined in the previous point is $R$-linear. Namely, we compute
		\[\left(r_1[a_1]_{I^{s+1}}+r_2[a_2]_{I^{s+1}}\right)\cdot[b]_{M_{q+1}}=[r_1a_2b+r_2a_2b]_{I^{s+1}}=[r_1a_1+r_2a_2]_{I^{s+1}}\cdot[b]_{M_{q+1}},\]
		so it follows that the action by $r_1[a_1]_{I^{s+1}}+r_2[a_2]_{I^{s+1}}$ is equal to the action by $[r_1a_1+r_2a_2]_{I^{s+1}}$.
	\end{itemize}
	So we have an $R$-module homomorphism
	\[(\op{gr}_IR)_s\to\op{Hom}_R\left((\op{gr}_\mathcal JM)_q,(\op{gr}_\mathcal JM)_{q+s}\right)\]
	is in fact an $R$-module homomorphism. By the tensor-hom adjunction, this induces a morphism
	\[(\op{gr}_IR)_s\otimes_R(\op{gr}_\mathcal JM)_q\to(\op{gr}_\mathcal JM)_{q+s}\into\op{gr}_\mathcal JM\]
	by $[a]_{I^{s+1}}\otimes[b]_{M_{q+1}}\mapsto[ab]_{M_{q+s+1}}$. We see that we can assemble the above morphisms into a large morphism
	\[\bigoplus_{s,q\ge0}\left((\op{gr}_IR)_s\otimes_R(\op{gr}_\mathcal JM)_q\right)\to\op{gr}_\mathcal JM\]
	by $\sum_{s,q}[a_s]_{I^{s+1}}\otimes[b_q]_{M_{q+1}}\mapsto\sum_{s,q}[a_sb_q]_{M_{q+s+1}}$. Because tensor products commute with tensor products, we get a morphism
	\[(\op{gr}_IR)\otimes_R(\op{gr}_\mathcal JM)\to\op{gr}_\mathcal JM\]
	by $\left(\sum_s[a_s]_{I^{s+1}}\right)\otimes\left(\sum_q[b_q]_{M_{q+1}}\right)\mapsto\sum_{s,q}[a_sb_q]_{M_{q+s+1}}$. Using the tensor-hom adjuction once more, we get an $R$-module homomorphism
	\[\op{gr}_IR\to\op{End}_R(\op{gr}_\mathcal JM),\]
	which verifies that we have an action by
	\[\left(\sum_{s\ge0}[a_s]_{I^{s+1}}\right)\cdot\left(\sum_{q\ge0}[b_q]_{M_{q+1}}\right)=\sum_{s,q\ge0}[a_sb_q]_{M_{q+s+1}}.\]
	In particular, we see that $(\op{gr}_\mathcal IR)_s\cdot(\op{gr}_\mathcal JM)_q\subseteq\op{gr}_\mathcal JM)_{q+s}$ by construction of our action: either we can check this directly above as $[a_s]_{I^{s+1}}\cdot[b_q]_{M_{q+1}}=[a_sb_q]_{M_{q+s+1}}$, or we can see it from the original construction. So our action in fact makes a graded module, as we wanted.
\end{proof}
It is somewhat natural to expect that the ``best'' $I$-filtration for a module $M$ is the filtration
\[M\supseteq IM\supseteq I^2M\supseteq\cdots.\]
This specific filtration will turn out to be overly restrictive for our purposes, so we have the following definition.
\begin{definition}[Stable]
	An $I$-filtration of an $R$-module $M$, denoted by
	\[M=M_0\supseteq M_1\supseteq M_2\supseteq\cdots,\]
	is \textit{$I$-stable} if and only if $M_{j+1}=IM_j$ for sufficiently large $j$.
\end{definition}
As a sign that we have done something good, it turns out that stability will communicate nicely with the module structure of $\op{gr}_\mathcal JM$.
\begin{proposition}
	Fix $I\subseteq R$ an ideal. Further, take $M$ to be a finitely generated $R$-module with a stable $I$-filtration $\mathcal J$ by finitely generated modules. Then $\op{gr}_\mathcal JM$ is a finitely generated $\op{gr}_IR$-module.
\end{proposition}
\begin{proof}
	We definition-chase. Let our filtration $\mathcal J$ be
	\[M=M_0\supseteq M_1\supseteq M_2\supseteq\cdots.\]
	Because $\mathcal J$ is $I$-stable, we are promised some $N$ such that $M_{N+p}=I^pM_N$ for $p\ge0$. As such, we choose generators for $M_0,\ldots,M_n$ over $R$ to generate $\op{gr}_\mathcal JM$ as a $\op{gr}_IR$-module.

	More explicitly by extending our number of generators, we can find $m$ elements to generate each $M_i$ for $0\le i\le n$ (e.g., set $m$ to be the largest number of generators used for any $M_i$ and then add $0$s until done); observe we may find finitely any generators for each $M_i$ by hypothesis. Now, label the $m$ generators for $M_i$ by $\{x_{i1},\ldots,x_{im}\}$. We would like to use these elements to generate
	\[\op{gr}_\mathcal JM=\bigoplus_{i\ge0}M_i/M_{i+1}.\]
	We have two cases.
	\begin{itemize}
		\item Fix $0\le i\le N$ so that we claim the $\left\{[x_{ij}]_{M_{i+1}}\right\}_{j=1}^m$ will generate $M_i/M_{i+1}$. Well, fix any element $x\in M_i$, and by construction, we may write
		\[x=\sum_{j=1}^mr_jx_{ij}\]
		for some elements $r_1,\ldots,r_j\in R$. Modding out, we have
		\[[x]_{M_{i+1}}=\sum_{j=1}^m\cdot[r_jx_{ij}]_{M_{i+1}},\]
		where this is taking place in $M_i/M_{i+1}$ as an $R$-module.
		
		If $r_j\in I$, then $r_jx_{ij}\in IM_i\subseteq M_{i+1}$, so this term vanishes, and we may erase it completely. Similarly, if $x_{ij}\in M_{i+1}$, then the term vanishes, and we may erase it. So we write
		\[[x]_{M_{i+1}}=\sum_{\substack{j=1\\r_j\notin I,x_{ij}\notin M_{i+1}}}^mr_j\cdot[x_{ij}]_{M_{i+1}}.\]
		However, for each of the remaining terms, we see that $\op{in}r_j=[r_j]_I$ and $\op{in}x_{ij}=[x_{ij}]_{M_{i+1}}$ with $[r_j]_I\cdot[x_{ij}]_{M_{i+1}}=[r_jx_{ij}]_{M_{i+1}}$ by definition of our action. This tells us that
		\[[x]_{M_{i+1}}=\sum_{\substack{j=1\\r_j\notin I,x_{ij}\notin M_{i+1}}}^m[r_j]_I\cdot[x_{ij}]_{M_{i+1}},\]
		where now this equation lives in $\op{gr}_\mathcal JM$ as a $\op{gr}_IR$-module. So we are done.

		\item Now fix $N+i>N+1$ so that we claim the $\left\{[x_{Nj}]_{M_{N+1}}\right\}_{j=1}^m$ will generate $M_{i+N}/M_{i+N+1}$ in $\op{gr}_\mathcal JM$. Well, the key is that are given that $M_{N+i}=I^iM_N$ by stability, so fixing some element $x\in M_{N+i}$, we can write
		\[x=rx',\]
		where $r\in I^i$. If $r\in I^{i+1}$, then $x\in I^{i+1}M_N=M_{i+N+1}$, so $[x]_{M_{i+N+1}}=0$, and there's nothing more to say. Similarly, if $x'\in M_{N+1}$, then $x\in I^iM_{N+1}=M_{i+N+1}$, so $[x]_{M_{i+N+1}}=0$, and we are again done.

		So we may assume that $r\in I^i\setminus I^{i+1}$ and $x'\in M_N\setminus M_{N+1}$. But now
		\[\op{in}r\cdot\op{in}x'=[r]_{I^i}\cdot[x']_{M_{N+1}}=[rx']_{M_{i+N+1}}\]
		in $\op{gr}_\mathcal JM$. To finish, we know from the previous point that $\left\{[x_{Nj}]_{M_{N+1}}\right\}_{j=1}^m$ will be able to hit $[x']_{M_{N+1}}\in M_N/M_{N+1}$, so now we just need to multiply all the coefficients in the expansion by $\op{in}r$ to finish.
	\end{itemize}
	The above casework finishes the proof.
\end{proof}
Anyways, we are now allowed to define the Hilbert function for modules.
\begin{defi}[Hilbert function]
	Fix $R$ a local Noetherian ring where $\mf m$ is the maximal ideal with $M$ a finitely generated $R$-module. Then we define
	\[H_M(s)=\dim_{R/\mf m}\left(\mf m^sM/\mf m^{s+1}M\right).\]
\end{defi}
Again, $\mf m^sM/\mf m^{s+1}M$ is an $R/\mf m$-vector space because multiplication by any element $\mf m$ will zero out the element. To see that it is finite-dimensional, we note that $M$ is Noetherian (because it is finitely generated over the Noetherian ring $R$), so the submodule $\mf m^sM\subseteq M$ is finitely generated, so $\mf m^sM/\mf m^{s+1}M$ is also finitely generated.

\subsection{Blow-Up Rings}
We are finally ready to state our main result.
\begin{restatable}[Artin--Rees lemma]{theorem}{artinrees} \label{thm:artinrees}
	Fix $R$ a Noetherian ring and $I\subseteq R$ an ideal with $M$ a finitely generated $R$-module granted a stable $I$-filtration $\mathcal J$ denoted by
	\[M=M_0\supseteq M_1\supseteq M_2\supseteq\cdots.\]
	Then given a submodule $M'\subseteq M$, the induced filtration by $M_k':=M_k\cap M'$ is also a stable $I$-filtration.
\end{restatable}
\noindent For the proof, we will want to introduce the blow-up ring.
\begin{definition}[Blow-up ring]
	Fix $R$ a ring and $I\subseteq R$ an ideal. Then we define the \textit{blow-up ring} $\op B_IR$ by
	\[\op B_IR:=R\oplus I\oplus I^2\oplus\cdots.\]
\end{definition}
Concretely, think about $\op B_IR$ as getting its ring structure from $k[t]$ as ``$k[It]$,'' which also gives us our grading. We have the following checks.
\begin{lem}
	Fix $R$ a ring and $I\subseteq R$ an ideal. The ring $\op B_IR$ is an $R$-algebra and a graded ring (in the natural way).
\end{lem}
\begin{proof}
	Our main check is that $\op B_IR$ is a ring, for which we have to define our multiplication. This is defined in the natural way: given $x\in I^s$ and $y\in I^q$, then we consider the product $xy\in I^sI^q=I^{s+q}$. In particular, this gives us a map
	\[I^s\times I^q\to I^{s+q}. \tag{$*$}\label{eq:constructblowupmult}\]
	We can check that this map is $R$-bilinear: if $r_1,r_2\in R$ with $x_1,x_2\in I^s$ and $s_1,s_2\in R$ with $y_1,y_2\in I^q$, then
	\[(r_1x_1+r_2x_2)(s_1y_1+s_2y_2)=r_1s_1(x_1y_1)+r_1s_2(x_1y_2)+r_2s_1(x_2y_1)+r_2s_2(x_2y_2),\]
	by rearranging in $R$. However, this is exactly the $R$-bilinearity check, so we get a map
	\[I^s\otimes_RI^q\to I^{s+q}\into\bigoplus_{i\ge0}I^i\]
	by $x\otimes y\mapsto xy$, essentially by the universal property of the tensor product. These stitch together into a map
	\[\Bigg(\bigoplus_{s\ge0}I^s\Bigg)\otimes_R\Bigg(\bigoplus_{q\ge0}I^q\Bigg)\simeq\bigoplus_{s,q\ge0}\left(I^s\otimes_R I^q\right)\to\bigoplus_{i\ge0}I^i\]
	by $\left(\sum_sa_s\right)\otimes\left(\sum_qb_q\right)\mapsto\sum_{s,q}a_sb_q$, essentially using how tensor products play with direct sums. Going backwards, we are thus promised an $R$-bilinear map
	\[\op B_IR\times\op B_IR\to\op B_IR\]
	by
	\[\left(\sum_sa_s,\sum_qb_q\right)\mapsto\sum_{s,q}a_sb_q,\]
	which is exactly our ring multiplication. Notably, we can see that this multiplication commutes because multiplication commutes in $R$; this associates by association in $R$; this distributes by the $R$-bilinearity of the map; and our unit element is $(1,0,0,\ldots)$ because $1b_q=b_q$ for each $b_q$, and all other terms vanish.

	For the grading, we merely have to check that $(\op B_IR)_s(\op B_IR)_q=I^sI^q\subseteq I^{s+q}=(\op B_IR)_{s+q}$, which is true by \autoref{eq:constructblowupmult}. Lastly, we are an $R$-algebra because $\op B_IR$ is an $R$-module component-wise, and we merely added the ring structure on top.
\end{proof}
\begin{remark}[Nir] \label{rem:blowupnoetherian}
	In fact, if $R$ is Noetherian, then $\op B_IR$ is also Noetherian. Indeed, $I\subseteq R$ must be finitely generated, so write $I=(f_1,\ldots,f_n)$. The main claim is that $R[x_1,\ldots,x_n]\onto\op B_IR$ via extending $R\into\op B_IR$ by $x_\bullet\mapsto f_\bullet\in I=(\op B_IR)_1$.
	
	This comes down to seeing that the component $(\op B_IR)_s=I^s$ is generated by products of the form
	\[f_1^{\alpha_1}\cdots f_n^{\alpha_n}\]
	with $\alpha_1+\cdots+\alpha_n=s$, but this element is hit by $x_1^{\alpha_1}\cdots x_n^{\alpha_n}$. In fact the grading matches because each $x_i$ goes to a degree-$1$ element, so $x_1^{\alpha_1}\cdots x_n^{\alpha_n}$ goes to a degree-$s$ element in $(\op B_IR)_s$.

	To finish, we see $R[x_1,\ldots,x_n]$ is Noetherian by \autoref{prop:stabilityisfingen}, so $\op B_IR$ is Noetherian by taking the quotient (e.g., using \autoref{prop:noetherianquot}).
\end{remark}
Because the associated graded ring was supposed to be ``the'' way to create a ring out of a filtration, it is reassuring that we can relate the associated graded ring to the blow-up ring.
\begin{lemma}
	Fix $R$ a ring and $I\subseteq R$ an ideal. Then $\op B_IR/I\op B_IR\cong\op{gr}_IR$ as graded rings.
\end{lemma}
\begin{proof}
	It is not too difficult to create an isomorphism of $R$-modules. Indeed, we see that
	\[I\op B_IR=I\Bigg(\bigoplus_{s\ge0}I^s\Bigg)=\bigoplus_{s\ge0}II^s=\bigoplus_{s\ge0}I^{s+1}\]
	by definition of our $R$-action. In particular, we can compute our quotient as
	\[\varphi:\frac{\op B_IR}{I\op B_IR}=\frac{\bigoplus_{s\ge0}I^s}{\bigoplus_{s\ge0}I^{s+1}}\cong\bigoplus_{s\ge0}\frac{I^s}{I^{s+1}}=\op{gr}_IR.\]
	Technically, some care is required on $\cong$, but it amounts to stitching together the short exact sequences
	\[0\to I^{s+1}\to I^s\to I^s/I^{s+1}\to0\]
	into the short exact sequence
	\[0\to\bigoplus_{s\ge0}I^{s+1}\to\bigoplus_{s\ge0}I^s\to\bigoplus_{s\ge0}I^s/I^{s+1}\to0,\]
	which witnesses the desired isomorphism.

	It remains to show that the composite $\varphi$ is an isomorphism of graded rings. Well, we compute
	\[\varphi\left(\left[\sum_{s\ge0}a_s\right]\cdot\left[\sum_{q\ge0}b_q\right]\right)=\varphi\left(\sum_{s,q\ge0}[a_sb_q]\right)=\sum_{s,q\ge0}[a_sb_q]_{I^{s+q+1}}\]
	by keeping track of our grading. From the above, we can un-distribute back to $\varphi\left(\left[\sum_sa_s\right]\right)\varphi\left(\left[\sum_qb_q\right]\right)$, which finishes. To see that this isomorphism has degree-$0$, we note $\varphi([a_s]\cdot [b_q])=[a_sb_q]_{I^{s+q+1}}$ for $a_s\in I^s$ and $b_q\in I^q$.
\end{proof}
We briefly discuss the geometric meaning to blowing up.
\begin{exe}
	We interpret blowing up in the case of $R:=k[x,y]$ at the ``point''/maximal ideal $I=(x,y)$.
\end{exe}
\begin{proof}
	Fix $R:=k[x,y]$ and consider $(0,0)\in\AA^2(k)$ with associated maximal ideal $I:=(x,y)\subseteq R$. In this case, our blow-up ring is
	\[\op B_IR=R\oplus I\oplus I^2\oplus\cdots=k[x,y]\oplus(x,y)\oplus\left(x^2,xy,y^2\right)\oplus\cdots.\]
	Intuitively, we can think of this as $k[x,y][tx,ty]\subseteq k[x,y][t]$, where we map $I=(x,y)\mapsto(tx,ty)$ to associate the grading. A more hands-free way to rigorize $k[x,y][tx,ty]$ is to imagine the projection
	\[k[x,y][u,v]\onto k[x,y][tx,ty]\]
	by taking $u\mapsto tx$ and $v\mapsto ty$. We can verify by hand that $yu-xv$ is in the kernel of this map, and one can show that it generates the kernel, but we will not do this.

	Now we proceed with our discussion, in two ways.
	\begin{itemize}
		\item Look at $Z\subseteq\AA^2(k)\times\PP^1(k)$ to be points $(p,\ell)$ such that $p\in\ell$. Intuitively, what we have done is to replace the point $(0,0)\in\AA^2(k)$ with a copy of $\PP^1(k)$, which looks more like a $2$-sphere, hence the name ``blowing up.'' This looks like the following.
		\begin{center}
			\begin{asy}
				import three;
				unitsize(0.35cm);
				currentprojection=perspective(1,5/4,7/4);
				draw((-6,0,0)--(6,0,0), EndArrow3);
				label("$x$", (6,0,0), (2,0,0));
				draw((0,-6,0)--(0,6,0), EndArrow3);
				label("$y$", (0,6,0), (0,2,0));
	
				draw(surface((6,-6,0)--(6,6,0)--(-6,6,0)--(-6,-6,0)--cycle), blue+opacity(0.4));
				draw(unitsphere, opacity(1)+rgb(1,0,1));
			\end{asy}
		\end{center}
		We can project $Z\onto\AA^2(k)$ in the natural way by $(p,\ell)\mapsto p$. As long as $p\ne0$, there is exactly one pre-image. But if $p=0$, then our pre-image contains all the lines in $\PP^1(k)$! So we have created some ``blowing up'' at the origin.

		To make our blow-up ring, we compute $A(Z)$. This will be a quotient of $k[x,y][u,v]$, where the $x$ and $y$ come from $\AA^2(k)$, and the $u$ and $v$ come from $\PP^1(k)$. Now, $((x,y),(u:v))\in Z$ if and only if $(x,y)\in(u:v)$ if and only if there exists some $t$ such that $(x,y)=t(u,v)$ if and only if $yu-xv=0$.\footnote{For this last equivalence, note $(x,y)=t(u,v)$ with $(u,v)\ne0$ is equivalent to $(x,y)$ and $(u,v)$ being linearly dependent is equivalent to their determinant vanishing.} So we have
		\[A(Z)=\frac{(k[x,y])[u,v]}{(yu-xv)},\]
		where we can verify that $yu-xv\in k[x,y][u,v]$ is indeed a homogeneous polynomial. But the above is our blow-up ring! So we verify that $A(Z)\cong\op B_IR$.
		\item Alternatively, focus on the ring
		\[\op B_IR\cong\frac{k[x,y,u,w]}{(xw-yv)},\]
		and think about the right-hand side as the coordinate ring over the variety $2\times2$ singular matrices embedded into $\AA^4(k)$. To make our blowing up appear, we imagine taking the quotient by the action of the matrices
		\[\begin{bmatrix}
			1 & 0 \\
			0 & \lambda
		\end{bmatrix}.\]
		More explicitly, our action is by
		\[\begin{bmatrix}
			x & u \\
			y & v
		\end{bmatrix}\begin{bmatrix}
			1 & 0 \\
			0 & \lambda
		\end{bmatrix}=\begin{bmatrix}
			x & \lambda u \\
			y & \lambda v
		\end{bmatrix},\]
		which we can see a poor man's way to create $\PP^1(\CC)$ in the second vector. Now, when $(x,y)\ne(0,0)$, the orbit of $(u,v)$ will make a one-dimensional line. However, at $(x,y)=(0,0)$, we see that $(u,v)$ can be whatever we want, so modding out by this action recovers all of $\PP^1(\CC)$ (as $(u,v)=(0,0)$). Visually, this will look like the blowing up we discussed in the previous point.
	\end{itemize}
	So we see that, geometrically, blowing up is intended to match the idea of expanding a single point with projective space.
\end{proof}

\subsection{Blow-Up Modules}
We remark that there is also a notion of the blow-up module.
\begin{definition}[Blow-up module]
	Fix $R$ a ring and $I\subseteq R$ an ideal. Further, fix a module $M$ with an $I$-filtration $\mathcal J$ denoted
	\[M=M_0\supseteq M_1\supseteq M_2\supseteq\cdots.\]
	Then we define the \textit{blow-up module} $\op B_I\mathcal JM$ by
	\[\op B_IM:=M_0\oplus M_1\oplus M_2\oplus\cdots.\]
\end{definition}
\begin{example}
	Fix $M=R$ and $\mathcal J$ by the $I$-stable filtration
	\[R\supseteq I\supseteq I^2\supseteq\cdots.\]
	Then $\op B_\mathcal JM=\op B_IR$. For example, $\op B_\mathcal JM$ is finitely generated as a $\op B_IR$-module, for free.
\end{example}
As usual, a priori we only know that $\op B_\mathcal JM$ is a large $R$-module, but in fact it's a graded $\op B_IR$-module.
\begin{lemma}
	Fix $R$ a ring and $I\subseteq R$ an ideal. Further, fix $M$ an $R$-module and $\mathcal J$ an $I$-filtration denoted by
	\[M=M_0\supseteq M_1\supseteq M_2\supseteq\cdots.\]
	We check that $\op B_\mathcal JM$ is a graded $\op B_IR$-module.
\end{lemma}
\begin{proof}
	As usual, the main point is to define the action on the components $(\op B_IR)_s=I^s$ and $(\op B_\mathcal JM)_q=M_q$. Well, if we have $r\in I^s$ and $x\in M_q$, then because we have an $I$-filtration, we see $rx\in M_{q+s}$. In fact, this defines an $R$-bilinear map
	\[I^s\times M_q\to M_{s+q}.\]
	To see that this is $R$-bilinear, we pick up $r_1,r_2\in R$ with $y_1,y_2\in I^s$ and $s_1,s_2\in R$ with $x_1,x_2\in M_q$ so that
	\[(r_1y_1+r_2y_2)(s_1x_1+s_2x_2)=r_1s_1(y_1x_1)+r_1s_2(y_1x_2)+r_2s_1(y_2x_1)+r_2s_2(y_2x_2)\]
	by distributing, which is exactly our $R$-bilinearity check. We note that, if we can extend this map $I^s\times M_q\to M_{s+q}$ to an $R$-action of $\op B_IR$ on $\op B_\mathcal JM$, then it will automatically be graded because we will have
	\[(\op B_IR)_s(\op B_\mathcal JM)_q=I^sM_q\subseteq M_{s+q}=(\op B_\mathcal JM)_{s+q}\]
	So it remains to assemble our action. By universal property, we have an $R$-linear map
	\[I^s\otimes_RM_q\to M_{s+q}\into\op B_\mathcal JM\]
	by $r\otimes x\mapsto rx$. Now, taking the direct sum over $s$ and $q$, we see we have a map
	\[\op B_IR\otimes_R\op B_\mathcal JM=\Bigg(\bigoplus_{s\ge0}I^s\Bigg)\otimes_R\Bigg(\bigoplus_{q\ge0}M_q\Bigg)\simeq\bigoplus_{s,q\ge0}\left(I^s\otimes_RM_q\right)\to\op B_\mathcal JM\]
	by $\left(\sum_sr_s\right)\otimes\left(\sum_qx_q\right)\mapsto\sum_{s,q}r_sx_q$. Thus, by the tensor-hom adjunction, we have an $R$-module homomorphism
	\[\varphi:\op B_IR\to\op{End}_R(\op B_\mathcal JM).\]
	It remains to show that $\varphi$ is a homomorphism of rings. Well, $1\in\op B_IR$ is $(1,0,0,\ldots)$ gets sent to the action taking
	\[\sum_{q\ge0}x_q\mapsto\sum_{s,q\ge0}1_{s=0}x_q=\sum_{q\ge0}x_q.\]
	It remains to show that $\varphi$ is multiplicative. Well, we compute
	\[\varphi\Bigg(\Bigg(\sum_{s\ge0}r_s\Bigg)\Bigg(\sum_{s'\ge0}r'_{s'}\Bigg)\Bigg)=\sum_{s,s'}\varphi(r_sr'_{s'})\]
	by distributing. Now, we could distribute this back so long as we know that $\varphi(r_sr'_{s'})=\varphi(r_s)\varphi(r'_{s'})$. Well, picking up some $\sum_{q\ge0}x_q$, we compute
	\[\varphi(r_s)\varphi(r'_{s'})\Bigg(\sum_{q\ge0}x_q\Bigg)=\sum_{q\ge0}r_sr'_{s'}x_q=\varphi(r_sr'_{s'})\Bigg(\sum_{q\ge0}x_q\Bigg),\]
	which is what we wanted.
\end{proof}
Now, the reason we are introducing blow-ups right now is that blowing up turns stability of filtrations into a more comfortable ring-theoretic condition.
\begin{proposition} \label{prop:stabilityisfingen}
	Fix $R$ a Noetherian ring and $I\subseteq R$ an ideal with $M$ a finitely generated $R$-module granted an $I$-filtration $\mathcal J$ denoted by
	\[M=M_0\supseteq M_1\supseteq M_2\supseteq\cdots.\]
	Then $\op B_\mathcal JM$ is finitely generated as a $\op B_IR$-module if and only if $\mathcal J$ is $I$-stable.
\end{proposition}
\begin{proof}
	We show the directions independently.
	\begin{itemize}
		\item Suppose that $\op B_\mathcal JM$ is finitely generated. By decomposing the generators into their (finitely many) homogeneous parts, we may assume that all the generators are homogeneous. Explicitly, denote our generators by $x_1,\ldots,x_n$ such that $x_i\in(\op B_\mathcal JM)_{d_i}=M_{d_i}$ for each $i$.
		
		Without much better to do, we set $N=\max_i\{d_i\}$ to be the maximum degree of a generator. We claim that $\mathcal J$ stabilizes after $N$.

		Indeed, pick some $q+N>N$, and we need to show $M_{q+N}=I^qM_N$. Certainly $I^qM_N\subseteq M_{q+N}$ because $\mathcal J$ is an $I$-filtartion. In the other direction, pick up some $x\in M_{q+N}$ and embed it into $\op B_\mathcal JM$. But now $\op B_\mathcal JM$ is finitely generated by the $x_i$, so we may write
		\[x=\sum_{i=1}^n\Bigg(\sum_{s\ge0}r_{is}x_i\Bigg)\]
		for some elements $\sum_{s\ge0}r_{is}\in\op B_IR$. Now, if we only pay attention to the terms of degree $q+N$, we see that we get the equality
		\[x=\sum_{i=1}^nr_{i,q+N-d_i}x_i.\]
		In particular, we note that $r_{i,q+N-d_i}x_i\in I^{q+N-d_i}M_{d_i}=I^q\cdot I^{N-d_i}M_{d_i}=I^qM_N$, so the entire sum lives in $I^qM_N$, and we are done.

		\item Conversely, suppose that $\mathcal J$ is $I$-stable so that $M_{q+N}=I^qM_N$ for some large $N$ and any $q$. Taking a hint from the above, we choose our generators for $\op B_\mathcal JM$ to be the (embedded) generators of $M_0,\ldots,M_N$, which will work.

		Explicitly, note that $M$ is Noetherian because it is finitely generated over a Noetherian ring, so each of the $M_i$ are also finitely generated. So suppose that we can generate $M_i$ by the elements $\{x_{i1},\ldots,x_{im_i}\}$. We claim that the (finite!) set
		\[\bigcup_{i=1}^N\{x_{i1},\ldots,x_{im_i}\}\]
		will generate $\op B_{\mathcal J}M$ as a $\op B_IR$-module.

		Fixing some element $x\in\op B_\mathcal JM$, we note that it suffices to show that the homogeneous components of $x$ can be generated by out set, so without loss of generality, take $x$ homogeneous with $x\in M_q$ for some $q$. If $q\le N$, then we simply use the generators of $M_q$ to write
		\[x=\sum_{j=1}^{m_q}r_jx_{qj}\]
		for some $r_1,\ldots,r_{m_i}\in R$. The above equation lifts to a multiplication of elements $r_j\in R=(\op B_IR)_0$ by elements $x_{qj}\in M_q=(\op B_\mathcal JR)_q$. Notably, each product $r_jx_{qj}$ will live in $(\op B_IR)_0(\op B_\mathcal JR)_q=(\op B_\mathcal JR)_q$ by the grading.

		Otherwise, $q>N$. Thus, we may write $M_q=I^{q-N}M_N$, so $x=rx'$ with $r\in I^{q-N}$ and $x'\in M_N$. Now, we know that we can generate $M_N=(\op B_\mathcal JM)_N$ from the above argument, so write
		\[x'=\sum_{j=1}^{m_N}r_jx_{Nj}'.\]
		Multiplying this equation by $r$ pushes $rr_j\in I^{q-N}=(\op B_IR)_{q-N}$, so in total we will have components $rr_jx_{Nj}\in I^{q-N}M_N=M_q=(\op B_\mathcal JM)_q$. So the grading here matches, and we can indeed lift this equation into $(\op B_\mathcal JM)_q$, showing that we are able to generate $(\op B_\mathcal JM)_q$.
	\end{itemize}
	The above two directions finish the proof.
\end{proof}

\subsection{The Artin--Rees Lemma}
We are now ready to attack the proof of the Artin--Rees lemma. Recall the statement.
\artinrees*
\begin{proof}
	The idea is to use \autoref{prop:stabilityisfingen} to turn stability into finite generation. Namely, let $\mathcal J'$ be the induced filtration for $M'$, notated by
	\[M'=M'\cap M_0\supseteq M'\cap M_1\supseteq M'\cap M_2\supseteq\cdots.\]
	Now, because $\mathcal J$ is $I$-stable, \autoref{prop:stabilityisfingen} implies that $\op B_\mathcal JM$ is finitely generated as a $\op B_IR$-module.

	But now \autoref{rem:blowupnoetherian} tells us that $\op B_IR$ is Noetherian! Thus, $\op B_\mathcal JM$ being finitely generated makes $\op B_\mathcal JM$ Noetherian. So we note the inclusions $M_i\cap M'\into M_i$ glue together to an inclusion
	\[\op B_{\mathcal J'}M'\into\op B_\mathcal JM,\]
	so $\op B_{\mathcal J'}M'$ is a $\op B_IR$-submodule,\footnote{Yes, the $\op B_IR$-action behaves on restriction, essentially by just looking at it. In fact, the inclusion $\op B_{\mathcal J'}M'\into\op B_\mathcal JM$ is set-theoretic.} so $\op B_{\mathcal J'}M'$ is finitely generated. So \autoref{prop:stabilityisfingen} tells us that $\mathcal J'$ is $I$-stable.
\end{proof}
Here is a nice application.
\begin{restatable}[Krull intersection]{theorem}{krullintersect} \label{thm:krullintersect}
	Fix $R$ a Noetherian ring with an ideal $I\subseteq $ and finitely generated $R$-module $M$. Further, set
	\[M':=\bigcap_{s\ge0}I^sM.\]
	Then there is some $r\in I$ such that $(1-r)M'=0$.
\end{restatable}
\begin{proof}
	The point is to recall we had a lemma to Nakayama's lemma \autoref{lem:nakayamalemlem}, which we will want to use here. In particular, it will suffice to show that $IM'=M'$, which is intuitively pretty clear from the definition of $M'$.

	The trick to rigorize our intuition is to use \autoref{thm:artinrees} on $M'\subseteq M$, where we give $M$ the $I$-stable filtration
	\[M\supseteq IM\supseteq I^2M\supseteq\cdots.\]
	In particular, we are told by \autoref{thm:artinrees} that the filtration
	\[M'\supseteq M'\cap IM\supseteq M'\cap I^2M\supseteq\cdots\]
	will stabilize, so there exists some large $N$ so that
	\[M'\cap I^{N+1}M=I\left(M'\cap I^NM\right).\]
	But of course, for any $q$, we have $M'\subseteq I^qM$ by definition of $M'$, so we see that the above tells us $M'=IM'$, finishing.
\end{proof}
\begin{remark}[Nir]
	Here is one reason to believe \autoref{thm:krullintersect}: certainly if we can write $(1-r)M'=0$ for some $r\in I$, then $M'=rM'$, so $M'=rM'=r^2M'=\cdots$ inductively. In particular, $M'\subseteq I^qM'\subseteq I^qM$ for any $q$.
\end{remark}
\begin{corollary} \label{cor:krullintersect}
	Fix $R$ a Noetherian ring with a proper ideal $I$. If $R$ is local or a domain, then
	\[\bigcap_{s\ge0}I^s=0.\]
\end{corollary}
\begin{proof}
	Set
	\[J:=\bigcap_{s\ge0}I^s.\]
	We would like to show that $J=0$, for which we use \autoref{thm:krullintersect}. We show our two cases separately.
	\begin{itemize}
		\item Take $R$ local. Back in the proof of \autoref{thm:krullintersect}, we showed that $IJ=J$. Now, because $I$ is proper, $I$ is contained in the unique maximal ideal of $R$, which is the Jacobson radical of $R$. So \autoref{thm:nakayama} tells us that $J=0$.
		\item Take $R$ a domain. Using \autoref{thm:krullintersect} more directly, we are promised $r\in I$ such that $(1-r)J=0$. Now, $1\notin I$ because $I$ is proper, so $(1-r)\ne0$. However, for any $x\in J$, we have $(1-r)x=0$, so $x=0$ is forced because $R$ is a domain. Thus, $J=0$.
	\end{itemize}
	The above two cases finish the proof.
\end{proof}
\begin{remark}
	The condition that $R$ is Noetherian is necessary. We will give an example next class.
\end{remark}
We close with an exercise.
\begin{exe}
	Fix $R$ a local Noetherian ring and $I\subseteq R$ a proper ideal. If $\op{gr}_IR$ is a domain, then $R$ is a domain.
\end{exe}
\begin{proof}
	The main idea is to show that $\op{in}f=0$ if and only if $f=0$ via \autoref{cor:krullintersect}. Indeed, if $f=0$, then $\op{in}f=0$ by definition because $f\in I^s$ for all $s$. Conversely, if $\op{in}f=0$, then $f\in I^s$ for all $s$, so
	\[f\in\bigcap_{s\ge0}I^s,\]
	so $f=0$ follows from \autoref{cor:krullintersect}.

	We now finish. Suppose that $fg=0$ in $R$, and we show $f=0$ or $g=0$. By \autoref{prop:multinitialform}, we see that
	\[\op{in}f\cdot\op{in}(g)=\op{in}(fg)=0,\]
	so $\op{in}f=0$ or $\op{in}g=0$ because $\op{gr}_IR$ is an integral domain. But by our work above, we see that $\op{in}f=0$ implies $f=0$, and $\op{in}g=0$ implies $g=0$, so we are done.
\end{proof}