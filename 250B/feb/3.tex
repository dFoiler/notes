% !TEX root = ../notes.tex

Today we are talking associated primes.

\subsection{Associated Primes}
Fix $M$ an $R$-module. Then given $m\in M$, recall that we can look at
\[\op{Ann}m=\{r\in R:rm=0\}.\]
Observe that $m\ne0$ promises $\op{Ann}m\ne R$ because $1_Rm\ne0$. In particular, these ideals are proper most of the time.

It will turn out to be productive to give require some structure out of these annihilators.
\begin{definition}[Associated primes]
	Fix $M$ an $R$-module. Then a prime ideal $\mf p\in\op{Spec}R$ is \textit{associated to $M$} if and only if $\mf p=\op{Ann}m$ for some $m\in M$. We denote $\op{Ass}M\subseteq\op{Spec}R$ to be the set of all associated primes to $M$.
\end{definition}
As usual, let's see some examples.
\begin{example}
	We have that $\op{Ass}(0)=\emp$ because the annihilator of any element in $(0)$ is $R$ (because all elements are $0$), which is not a prime ideal.
\end{example}
\begin{exe} \label{exe:cyclicassociated}
	Let $n$ be a nonzero integer. Fix $M:=\ZZ/n\ZZ$ as a $\ZZ$-module. Then $\op{Ass}M=\{(p):\text{prime }p\mid n\}$.
\end{exe}
\begin{proof}
	Let $(p)$ be a prime. Then $(p)$ is associated to $M$ if and only if there exists some $m\in M$ such that
	\[\op{Ann}m=(p).\]
	If $p\mid n$, then we note that $\op{Ann}\left[\frac np\right]_n=(p)$ because $n\mid\frac np\cdot k$ if and only if $p\mid k$. Thus, $\{(p):\text{prime }p\mid n\}\subseteq\op{Ass}M$.
	
	Conversely, if $\op{Ann}m=:(p)$ is prime, then we see that we have a $\ZZ$-module map $\varphi:\ZZ\to\ZZ/n\ZZ$ by $r\mapsto rm$, which has kernel $\op{Ann}m=(p)$. Namely, we have an injection
	\[\ZZ/p\ZZ\into\ZZ/n\ZZ,\]
	so $p\mid n$ by Lagrange's theorem on groups.
\end{proof}
We can generalize the trick at the end of the proof to give the following characterization of associated primes; this characterization will be easier to use for more element-free proofs.
\begin{lemma} \label{lem:betterassociated}
	Fix $M$ an $R$-module. Then a prime $\mf p\in\op{Spec}R$ is associated to $M$ if and only if there is an injective $R$-module homomorphism $R/\mf p\into M$. In fact, if $\mf p=\op{Ass}m$, then the injection provides an isomorphism $R/\mf p\to Rm$.
\end{lemma}
\begin{proof}
	We take the directions separately.
	\begin{itemize}
		\item Suppose that $\mf p$ is associated to $M$. Then there exists $m\in M$ such that $\mf p=\op{Ann}m$, so we consider the map $\varphi:R\to M$ by
		\[\varphi:r\mapsto rm\]
		If $r_1,r_2\in R$ and $x_1,x_2\in R$, then $\varphi(r_1x_1+r_2x_2)=r_1x_1m+r_2x_2m=r_1\varphi(x_1)+r_2\varphi(x_2)$, so $\varphi$ is indeed an $R$-linear map. Then, by definition of $\op{Ann}m$ we see that $\mf p=\op{Ann}m=\ker\varphi$, so there is an induced injection
		\[\overline\varphi:R/\mf p\into M,\]
		which is what we wanted.

		To finish, we note that $\varphi$ is surjective onto $Rm$, so $\varphi:R/\mf p\to Rm$ is an isomorphism.
		\item Suppose that there is an embedding $\varphi:R/\mf p\into M$. Then define $m:=\varphi([1]_\mf p)$. Now, $rm=0$ if and only if $r\varphi([1]_\mf p)=\varphi([r]_\mf p)$ is equal to $0=\varphi([0]_\mf p)$, so $rm=0$ is equivalent to $r\in\mf p$. Thus, $\op{Ann}m=\mf p$, as desired.

		Lastly, we note $\varphi$ is again surjective onto $Rm$, so $\varphi:R/\mf p\to Rm$ is an isomorphism.
		\qedhere
	\end{itemize}
\end{proof}
\begin{remark}[Nir]
	The embedding
	\[\frac{\QQ[x]}{(x-2)}\cong\QQ\cong\frac{\QQ[x]}{(x)}\]
	does not mean that $(x-2)$ is an associated prime of $\QQ[x]/(x)$ because the above embedding is of $\QQ$-modules, not $\QQ[x]$-modules. Explicitly, $[x]_{(x-2)}$ goes to $2$ goes to $[2]_{(x)}$, but $x\cdot[1]_{(x-2)}$ goes to $x\cdot1$ goes to $x\cdot[1]_{(x)}=[0]_{(x)}$.
\end{remark}
We close our introduction with another example.
\begin{example} \label{ex:assrmodp}
	Fix $\mf p\subseteq R$ a prime ideal and fix $M:=R/\mf p$. Certainly $\mf p\in\op{Ass}M$ because $\op{Ann}[1]_\mf p=\mf p$. (Alternatively, use \autoref{lem:betterassociated} and note $R/\mf p\into R/\mf p=M$.) Conversely, fix some $b\in R\setminus\mf p$, and we want to know what primes can arise as
	\[\op{Ann}([b]_\mf p)=\{a\in R:ab\in\mf p\}.\]
	But with $b\notin\mf p$, the primality of $\mf p$ means that $ab\in\mf p$ implies $a\in\mf p$. (And conversely, $a\in\mf p$ implies $ab\in\mf p$.) So $\op{Ann}([b]_\mf p)=\mf p$ for any $b\notin\mf p$, so $\op{Ass}M=\{\mf p\}$.
	% (Alternatively, the kernel of a map $R\to R/\mf p$ is either $R$ or $1\mapsto[a]_\mf p$ for some $a\notin\mf p$. Then $r\mapsto[ra]_\mf p$ is in the kernel if and only if $ra\in\mf p$ if and only if $r\mf p$, so this map is actually $R/\mf p\into R/\mf p$.)
\end{example}
So indeed, any prime of $R$ can arise as an associated prime.

\subsection{Associated Primes in Localization}
In the spirit of the above example, we have the following proposition.
\begin{proposition} \label{prop:generateass}
	Fix $M$ an $R$-module. Suppose $\mf p\subseteq R$ is an ideal maximal in
	\[\mathcal P:=\{\op{Ann}m:m\in M\setminus\{0\}\}.\]
	Then we claim $\mf p$ is prime.
\end{proposition}
\begin{proof}
	% Because $\mf p\in\mathcal P$, we can say $\mf p=\op{Ann}m$, so we have a natural map
	% \[\varphi:R/\mf p\into M\]
	% by $\varphi:[r]_\mf p\mapsto rm$. (This is the same map that appears in \autoref{lem:betterassociated}.)
	Now take $ab\in\mf p$ and $a\notin\mf p$, and we show that $b\in\mf p$. Well, $ab\in\mf p$ implies that $a(bm)=(ab)m=0$, so $a\in\op{Ann}bm$. But certainly any $x\in\mf p$ will have
	\[x(bm)=b(xm)=0,\]
	so $x\in\op{Ann}bm$, so $\mf p\subseteq\op{Ann}bm$. However, we now see that $\op{Ann}bm$ is an annihilator strictly containing $\mf p$ (because $a\in\op{Ann}bm\setminus\mf p$). This looks like a contradiction, but it is not: instead we merely must have $bm=0$, which means $b\in\mf p$.
\end{proof}
We have the following corollary.
\begin{corollary} \label{cor:hasass}
	Fix $R$ a Noetherian ring and $M$ a nonzero $R$-module. Then $\op{Ass}M$ is nonempty.
\end{corollary}
\begin{proof}
	As in \autoref{prop:generateass}, set
	\[\mathcal P:=\{\op{Ann}m:m\in M\setminus\{0\}\}.\]
	Because $R$ is Noetherian, $\mathcal P$ will contain a maximal element, which will be a prime $\mf p=\op{Ann}m$ for some $m\in M$. So $\mf p\in\op{Ass}M$, meaning $\op{Ass}M\ne\emp$.
\end{proof}
\begin{remark}[Nir]
	It is possible to have a nonzero module with no associated primes; we follow the example given in \href{https://math.stackexchange.com/a/3365952/869257}{sx2931719}. Consider $R:=C(\RR,\RR)$ the ring of continuous functions $\RR\to\RR$ as a module over itself. Fix any $f\in R\setminus\{0\}$, and we show $\op{Ann}f$ is not prime.

	Because $f\ne0$, find $a\in\RR$ such that $f(a)\ne0$, and by continuity some $b>a$ close to $a$ also has $f(b)\ne0$. (Here we use continuity of $f$.) Then set $m:=\frac{a+b}2$ and
	\[g(x)=\begin{cases}
		(x-m)^2 & x \le m, \\
		0 & x \ge m,
	\end{cases}\qquad\text{and}\qquad h(x)=\begin{cases}
		0 & x \le m, \\
		(x-m)^2 & x \ge m.
	\end{cases}\]
	Then $g,h\in C(\RR,\RR)$ and $gh=0\in\op{Ann}f$. However, $(gf)(a)\ne0$ an $(hf)(b)\ne0$, so $g,h\notin\op{Ann}f$.
\end{remark}

\begin{remark}
	For the sake of comparison, let's compare $\op{Supp}M$ with $\op{Ass}M$. For example, when $R$ is a domain, then $\op{Ass}_RR=\{(0)\}$ by the integral domain condition. However, the support $\op{Supp}R=\op{Spec}R$, so the associated primes appear smaller.

	More generally, for $R$ any ring, if $\mf p\in\op{Ass}M$, then set $\mf p=\op{Ann}m$. Thus, in $M_\mf p$, we have $\frac m1\ne\frac01$, for this would imply there is $u\in R\setminus\mf p$ such that $um=0$, which cannot be because $\op{Ann}m\subseteq\mf p$. It follows $M_\mf p\ne0$, so $\mf p\in\op{Supp}M$. We conclude $\op{Ass}M\subseteq\op{Supp}M$.
\end{remark}
Indeed, we will find that the associated primes will be smaller than $\op{Supp}M$.

Localization was able to tell us about maps by looking locally everywhere: an element was $0$ if and only if zero on all localizations. However, it turns out that we can limit what we have to focus on.
\begin{proposition} \label{prop:localassprimes}
	Fix $R$ Noetherian and $M$ an $R$-module. Then, given $m\in M$, we have $m=0$ if and only if $\frac m1=0$ in $M_\mf p$ for each $\mf p\in\op{Ass}M$.
\end{proposition}	
\begin{proof}
	The forwards direction here is easy: if $m=0$, then $\frac m1=\frac01=0$ in $M_\mf p$ for any prime $\mf p$ and therefore for any prime $\mf p\in\op{Ass}M$.

	In the other direction, suppose $m\ne0$, and we need to find an associated prime $\mf p\in\op{Ass}M$ for which $\frac m1\ne0$ in $M_\mf p$. But we note that $\frac m1=\frac01$ in $M_\mf p$ if and only if there exists $u\in M\setminus\mf p$ such that $um=0$ if and only if $(M\setminus\mf p)\cap\op{Ann}m\ne\emp$ if and only if
	\[\op{Ann}m\not\subseteq\mf p.\]
	So our goal is to construct an associated prime $\mf p$ such that $\op{Ann}m\subseteq\mf p$.
	
	The main idea is to use \autoref{prop:generateass} to give us our prime. We set
	\[\mathcal P_m:=\{\op{Ann}m':\op{Ann}m'\supseteq\op{Ann}m\text{ and }m'\ne0\}.\]
	Note that $\mathcal P_m$ is nonempty because $\op{Ann}m\in\mathcal P_m$, so $\mathcal P_m$ will have a maximal element named $\mf p$. (Here we are using the condition that $R$ is Noetherian.) We now note that $\mf p$ is also maximal in
	\[\mathcal P:=\{\op{Ann}m':m'\ne0\}.\]
	Indeed, if $\mf p\subseteq\op{Ann}m'$, then $\op{Ann}m\subseteq\op{Ann}m'$, so $\op{Ann}m'\in\mathcal P_m$, so $\mf p=\op{Ann}m'$ by maximality of $\mf p$. It follows from \autoref{prop:generateass} that $\mf p$ is indeed prime, so it is an associated prime containing $\op{Ann}m$.
\end{proof}
Here are some corollaries.
\begin{corollary} \label{cor:localasssubmod}
	Fix $R$ Noetherian and $M$ an $R$-module. Then a submodule $N\subseteq M$ has $N=0$ if and only if $N_\mf p=0$ for each $\mf p\in\op{Ass}M$.
\end{corollary}
\begin{proof}
	Again, in the forwards direction, note that $N=0$ implies $N_\mf p=0$ for each prime $\mf p$.

	In the reverse direction, suppose that $N_\mf p=0$ for each $\mf p\in\op{Ass}M$. Then any $m\in N$ has $\frac m1=0$ in $N_\mf p$ for each $\mf p\in\op{Ass}M$, but this means that there exists $u\in R\setminus\mf p$ such that $um=0$, which also holds in $M_\mf p$. This is to say that $\frac m1=0$ in $M_\mf p$ for each $\mf p\in\op{Ass}M$, so $m=0$ by \autoref{prop:localassprimes}.
\end{proof}
\begin{corollary}
	Fix $R$ Noetherian and $M,N$ as $R$-modules. Then a map $\varphi:M\to N$ is injective if and only if $\varphi:M_\mf p\to N_\mf p$ is injective for each $\mf p\in\op{Ass}M$.
\end{corollary}
\begin{proof}
	By \autoref{cor:localasssubmod}, $\ker\varphi\subseteq M$ vanishes if and only if $(\ker\varphi)_\mf p=0$ for each $\mf p\in\op{Ass}M$. But $(\ker\varphi)_\mf p=\ker\varphi_\mf p$ by \autoref{cor:localizekercoker}, so $\ker\varphi=0$ if and only if $\ker\varphi_\mf p$ for each $\mf p\in\op{Ass}M$, which is what we wanted.
\end{proof}

\subsection{Associated Primes in Short Exact Sequences}
We note that associated primes also behave in short exact sequences, somewhat.
\begin{lemma} \label{lem:assses}
	Suppose
	\[0\to A\to B\to C\to 0\]
	is a short exact sequence of $R$-modules. Then $\op{Ass}A\subseteq\op{Ass}B\subseteq\op{Ass}A\cup\op{Ass}C$.
\end{lemma}
\begin{proof}
	Denote our morphisms by
	\[0\to A\stackrel\iota\to B\stackrel\pi\to C\to 0.\]
	We have that $\op{Ass}A\subseteq\op{Ass}B$ because any annihilator in $A$ will end up being any annihilator in $B$ as well. We note that any $a\in A$ has
	\[\op{Ann}\iota(a)=\{r\in R:r\iota(a)=0\}=\{r\in R:\iota(ra)=0\}\stackrel*=\{r\in R:ra=0\}=\op{Ann}a,\]
	where in $\stackrel*=$ we have used the injectivity of $\iota$. So any associated prime $\mf p=\op{Ann}a$ of $A$ will also be an associated prime $\mf p=\op{Ann}\iota(a)$ of $B$.
	\begin{remark}[Nir]
		Alternatively, any associated prime $\mf p\in\op{Ass}A$ induces an $R$-embedding $R/\mf p\into A$ (by \autoref{lem:betterassociated}). Post-composing with $\iota$ gives an $R$-embedding $R/\mf p\into B$, so \autoref{lem:betterassociated} gives $\mf p\in\op{Ass}B$.
	\end{remark}

	It remains to show $\op{Ass}B\subseteq\op{Ass}A\cup\op{Ass}C$. Well, suppose $\mf p\in\op{Ass}B\setminus\op{Ass}A$, and we show that $\mf p\in\op{Ass}C$. Namely, we can find $b\in B$ such that
	\[\op{Ann}b=\mf p.\]
	To make some of our language easier, we note that this $b\in B$ induces $f:R/\mf p\into B$ by $f:[r]_\mf p\mapsto rb$ (as in \autoref{lem:betterassociated}); note $\im f=Rb$. It will be enough to show that $\pi f:R/\mf p\to C$ is injective to show that $\mf p\in\op{Ass}C$ by \autoref{lem:betterassociated}.
	
	We compute
	\[\ker(\pi f)=\{[r]_\mf p\in R/\mf p:\pi f([r]_\mf p)=0\}=\{[r]_\mf p\in R/\mf p:rb\in\ker\pi=\im\iota\}.\]
	In particular, because $f:R/\mf p\to Rb$ is an isomorphism, $\ker(\pi f)$ will vanish if and only if each $rb\in Rb$ with $rb\in\im\iota$ has $rb=0$. That is, we want to show that
	\[Rb\cap\im\iota\stackrel?=\{0\}.\]
	Indeed, each $rb\in Rb\setminus\{0\}$ (so that $r\notin\mf p$) has $s\in\op{Ann}rb$ if and only if $sr\in\mf p$ if and only if $s\in\mf p$, so any nontrivial intersection above would induce an annihilator $\mf p\in\op{Ass}A$, which we assumed is not the case.
\end{proof}
\begin{corollary} \label{cor:dirsumass}
	Suppose $B=A\oplus C$ as $R$-modules. Then $\op{Ass}B=\op{Ass}A\cup\op{Ass}C$.
\end{corollary}
\begin{proof}
	Note the split short exact sequences
	\[0\to A\to B\to C\to 0\]
	and
	\[0\to C\to B\to A\to 0\]
	give that $\op{Ass}A,\op{Ass}C\subseteq\op{Ass}B$ by \autoref{lem:assses}. In particular, $\op{Ass}A\cup\op{Ass}C\subseteq\op{Ass}B$, but \autoref{lem:assses} implies $\op{Ass}B\subseteq\op{Ass}A\cup\op{Ass}C$ already, so equality follows.
\end{proof}
Here's a quick example of our theory at work, actually able to classify associated primes.
\begin{ex}
	We work with $\ZZ$-modules. Indeed, fix any finitely generated abelian group
	\[M\cong\bigoplus_{k=1}^n\ZZ/p_k^{\alpha_k}\ZZ,\]
	where the $p_k$ are primes (possible equal to $0$) and $\alpha_k$ positive integers. Then By \autoref{cor:dirsumass}, we have that
	\[\op{Ass}M=\bigcup_{k=1}^n\op{Ass}\ZZ/p_k^{\alpha_k}\ZZ.\]
	So it remains to compute $\op{Ass}\ZZ/p^\alpha\ZZ$ where $p$ is a prime (possibly equal to $0$) and $\alpha$ is a positive integer. But we note $\op{Ass}\ZZ/0\ZZ=\op{Ass}\ZZ=\{(0)\}$ because $\ZZ$ is an integral domain. And for nonzero primes, \autoref{exe:cyclicassociated} tells us that $\op{Ass}\ZZ/p^\alpha\ZZ=\{(p)\}$, so we find $\op{Ass}M=\{(p_k)\}_{k=1}^n$.
\end{ex}

\subsection{Finding All Associated Primes}
Let's try as hard as we can to find all associated primes. To start, we show there are finitely many. Here is our main lemma in the proof that there are finitely many associated primes.
\begin{lemma} \label{lem:fingenfiltration}
	Fix $M$ a finitely generated module over a Noetherian ring $R$. Then $M$ has a finite filtration
	\[0=:M_0\subseteq M_1\subseteq\cdots\subseteq M_n=M\]
	such that each quotient $M_{k+1}/M_k\cong R/\mf p_k$ for some prime ideals $\{\mf p_k\}_{k=0}^{n-1}$.
\end{lemma}
\begin{proof}
	If $M=0$, then our filtration is just ``$M_0=M$.''
	
	If $M\ne0$, then because $R$ is Noetherian, $\op{Ass}M$ is nonempty. So find some $\mf p_0=\op{Ann}m_0$ for $m_0\in M/M_0=M$, and (using \autoref{lem:betterassociated}) set $M_1:=Rm_1\cong R/\mf p_1$. If $M/M_1=(0)$, then we get the filtration series
	\[M_0\subseteq M_1.\]
	More generally, suppose that, for some $\ell\in\NN$, we have built a strictly ascending chain
	\[M_0\subseteq M_1\subseteq\cdots\subseteq M_\ell\]
	such that $M_{k+1}/M_k\cong R/\mf p_k$ for each $0\le k<\ell$. If $M/M_\ell=0$, then this filtration satisfies the conclusion.
	
	Otherwise, $R$ is Noetherian, so $\op{Ass}M/M_\ell$ is nonempty, so find $\mf p_\ell\in\op{Ass}M/M_\ell$. Then (by \autoref{lem:betterassociated}), we get to say $\mf p_\ell=\op{Ann}[m]_{M_\ell}$ so that $R/\mf p_\ell\cong R[m]_{M_\ell}$. So define $M_{\ell+1}:=M_\ell+Rm$. Then
	\[\frac{M_{\ell+1}}{M_\ell}=\frac{M_\ell+Rm}{M_\ell}\cong R[m]_{M_\ell},\]
	where the last isomorphism is by $[x+rm]_{M_\ell}=[rm]_{M_\ell}\mapsto r[m]_{M_{\ell}}$. But then $M_{\ell+1}/M_\ell\cong R/\mf p_\ell$, so we get to continue our filtration.
	
	However, this filtration-creating process gives us an ascending chain of $R$-submodules
	\[M_0\subseteq M_1\subseteq\cdots,\]
	which must eventually terminate because $M$ is Noetherian---$M$ is finitely generated over the Noetherian ring $R$. But the only way for our process to terminate is when we find some $M_n$ such that $M/M_n=(0)$, or equivalently $M=M_n$, so the filtration is completed.
\end{proof}
And here is our result.
\begin{theorem} \label{thm:finass}
	Fix $M$ a finitely generated module over a Noetherian ring $R$. Then $\op{Ass}M$ is finite.
\end{theorem}
\begin{proof}
	By \autoref{lem:fingenfiltration}, we are promised a filtration
	\[0=:M_0\subseteq M_1\subseteq\cdots\subseteq M_n=M\]
	such that each quotient $M_{k+1}/M_k\cong R/\mf p_k$ for some primes $\{\mf p_k\}_{k=0}^{n-1}$. In particular, we get the short exact sequences
	\[0\to M_k\to M_{k+1}\to M_{k+1}/M_k\to0,\]
	which tell us that $\op{Ass}M_{k+1}\subseteq\op{Ass}M_k\cup\op{Ass}M_{k+1}/M_k$ by \autoref{lem:assses}. But $\op{Ass}M_{k+1}/M_k=\op{Ass}R/\mf p_k=\{\mf p_k\}$ by \autoref{ex:assrmodp}. So, inductively, we get that
	\[\op{Ass}M_k\subseteq\bigcup_{\ell=0}^{k-1}\{\mf p_\ell\},\]
	where the induction starts with $\op{Ass}M_0=\op{Ass}(0)=\emp$. Now, setting $k=n$ recovers the result.
\end{proof}
\begin{remark}[Nir]
	The above theorem is ``effective'' in the sense that, if we could compute the filtration \autoref{lem:fingenfiltration}, we would have an effective upper bound on $\op{Ass}M$. However, making the filtration required using the non-effective \autoref{prop:generateass}.
\end{remark}
Let's also discuss some other ways we can access associated primes; just like support, associated primes commute with localization.
\begin{proposition} \label{prop:localizeass}
	Fix $M$ a finitely generated module over a Noetherian ring $R$. Further, fix $U\subseteq R$ a multiplicatively closed subset. Then we have that
	\[\op{Ass}_{R\left[U^{-1}\right]}M\left[U^{-1}\right]=\{\mf p\left[U^{-1}\right]:\mf p\in\op{Ass}M,\mf p\cap U=\emp\}.\]
\end{proposition}
\begin{proof}
	Recall from \autoref{thm:localizedprimes} that
	\[\op{Spec}R\left[U^{-1}\right]=\{\mf p\left[U^{-1}\right]:\mf p\in\op{Spec}R\text{ and }\mf p\cap U=\emp\},\]
	so these are all the primes we have to consider.
	
	In one direction, suppose that $\mf p\in\op{Ass}M$ and $\mf p\cap U=\emp$ so that $\mf p\left[U^{-1}\right]\in\op{Spec}R\left[U^{-1}\right]$. Because $\mf p\in\op{Ass}M$, \autoref{lem:betterassociated} gives us an embedding
	\[R/\mf p\into M.\]
	But localization preserves injections, so this induces an injection
	\[R\left[U^{-1}\right]/\mf p\left[U^{-1}\right]\into M\left[U^{-1}\right],\]
	from which \autoref{lem:betterassociated} promises $\mf p\left[U^{-1}\right]\in\op{Ass}M\left[U^{-1}\right]$.

	The other direction is harder. Suppose that $\mf p\left[U^{-1}\right]\in\op{Ass}_{R\left[U^{-1}\right]}M\left[U^{-1}\right]$, so we are promised some injection
	\[R\left[U^{-1}\right]/\mf p\left[U^{-1}\right]\into M\left[U^{-1}\right].\]
	We need to turn this into an injection $R/\mf p\into M$. As a first step, we note that, because $R\left[U^{-1}\right]$, we can let $\varphi$ be the composite
	\[(R/\mf p)\otimes_RR\left[U^{-1}\right]\cong\frac{R\otimes_RR\left[U^{-1}\right]}{\mf p\otimes_RR\left[U^{-1}\right]}\cong\frac{R\left[U^{-1}\right]}{\mf p\left[U^{-1}\right]}\into M\left[U^{-1}\right]\cong M\otimes_RR\left[U^{-1}\right].\]
	The key trick is to apply \autoref{lem:basechange}, which gives a functorial morphism
	\[\alpha:\op{Hom}_R(R/\mf p,M)\otimes_RR\left[U^{-1}\right]\cong\op{Hom}_{R\left[U^{-1}\right]}\left((R/\mf p)\otimes_RR\left[U^{-1}\right],M\otimes_RR\left[U^{-1}\right]\right).\]
	But now we see $M$ is finitely generated, so there is some projection $R^n\onto M$. With $R$ Noetherian, all submodules of $R^n$ will be finitely generated, so the kernel of $R^n\onto M$ is finitely generated, so $M$ is in fact finitely presented.
	
	Thus, \autoref{prop:basechange} promises our $\alpha$ is an isomorphism. Namely, we have some morphism $\psi:R/\mf p\to M$ such that $\alpha(s/u\otimes\psi)=\varphi$ in the sense that (tracking \autoref{lem:basechange} through)
	\[\alpha(\psi\otimes s/u)([r]_\mf p\otimes s'/u')=\psi([r]_\mf p)\otimes(ss')/(uu')=\varphi([r]_\mf p\otimes s'/u').\]
	We now check that $\psi$ is an injection, which will finish by \autoref{lem:betterassociated}.
	
	Indeed, if $\psi([r]_\mf p)=0$, then $\psi([r]_\mf p)\otimes1/1=\varphi([r]_\mf p\otimes1/1)=0$, so the injectivity of $\varphi$ implies $[r]_\mf p\otimes1/1=0$. Viewing this in $(R/\mf p)\left[U^{-1}\right]$, we see we're saying
	\[\frac{[r]_\mf p}1=\frac{[0]_\mf p}1,\]
	which implies there is some $u\in U$ such that $u[r]_\mf p=u[0]_\mf p=[0]_\mf p$ so that $ur\in\mf p$. But $U\cap\mf p=\emp$, so $u\notin\mf p$, so this requires $r\in\mf p$, so $[r]_\mf p=[0]_\mf p$. Thus, $\ker\psi$ is trivial, and $\psi$ is indeed injective.
\end{proof}
Amusingly, we can also look at associated primes by their union.
\begin{proposition} \label{prop:unionass}
	Fix $M$ a module over a Noetherian ring $R$. Then
	\[\bigcup_{\mf p\in\op{Ass}M}\mf p=\bigcup_{m\in M\setminus\{0\}}\op{Ann}m.\]
\end{proposition}
\begin{proof}
	Note that each $\mf p\in\op{Ass}m$ is an annihilator of a nonzero element $m\in M\setminus\{0\}$, so we get
	\[\bigcup_{\mf p\in\op{Ass}M}\mf p\subseteq\bigcup_{m\in M\setminus\{0\}}\op{Ann}m.\]
	For the other direction, pick up any $\op{Ann}m$ for $m\ne0$. By \autoref{prop:localassprimes}, there exists $\mf p\in\op{Ass}M$ such that $\frac m1\ne\frac01$, so there exists no $u\in R\setminus\mf p$ such that $um=0$. In other words, $(R\setminus\mf p)\cap\op{Ann}m=\emp$, so
	\[\op{Ann}m\subseteq\mf p.\]
	Looping all over $\op{Ann}m$ gives the needed inclusion.
	% Then, as in \autoref{prop:localassprimes}, we choose $\mf p$ to be maximal among annihilators containing $\op{Ann}m$ (using that $R$ is Noetherian), and then $\mf p$ will still be maximal among all annihilators. So \autoref{prop:generateass} tells us that $\mf p$ is a prime
\end{proof}
\begin{remark}[Serganova]
	One could also proceed more directly, without using \autoref{prop:localassprimes}, by choosing $\mf p$ to be maximal among annihilators containing $\op{Ann}m$ as in the proof of \autoref{prop:localassprimes}.
\end{remark}
\begin{corollary}
	Fix $M$ a finitely generated module over a Noetherian ring $R$, and fix any ideal $J\subseteq R$. Then one of the following is true.
	\begin{listroman}
		\item We have $J\subseteq\op{Ann}m$ for some $m\in M$
		\item There exists $a\in J$ such that $am=0$ implies $m=0$ for each $m\in M$.
	\end{listroman}
\end{corollary}
\begin{proof}
	The idea is to use \autoref{prop:unionass}. Suppose (ii) is false so that every $a\in J$ annihilates some nonzero element of $M$. Then
	\[J\subseteq\bigcup_{m\in M\setminus\{0\}}\op{Ann}m=\bigcup_{\mf p\in\op{Ass}M}\mf p.\]
	We claim that $J\subseteq\mf p$ for some $\mf p\in\op{Ass}M$, which will show $J$ satisfies (i). For concreteness, label
	\[\{\mf p_1,\ldots,\mf p_n\}\]
	as the primes of $\op{Ass}M$ maximal among the other primes of $\op{Ass}M$; this labeling is finite because of \autoref{thm:finass}. Note that only working with these maximal primes will not hurt us because each $\mf p\in\op{Ass}M$ lives inside some prime maximal in $\op{Ass}M$ so that
	\[J\subseteq\bigcup_{\mf p\in\op{Ass}M}\mf p\subseteq\bigcup_{k=1}^n\mf p_k.\]
	The reason that we are using these maximal primes is to be promised some $x_{k,\ell}\in\mf p_\ell\setminus\mf p_k$ for $k\ne\ell$.
	
	Now, suppose that $J\not\subseteq\mf p_k$ for each $\mf p_k$, and we will show $J$ is not a subset of the union of the $\mf p_k$s. For this, we appeal to the following lemma.
	\begin{lemma} \label{lem:primeavoidance}
		Fix a ring $R$ and prime ideals $\mf p_1,\ldots,\mf p_n$ of $R$. If an ideal $J\not\subseteq\mf p_k$ for each $\mf p_k$, then $J$ contains an element not in any of the $\mf p_k$.
	\end{lemma}
	\begin{proof}
		Well, $J\not\subseteq\mf p_k$ grants us some $y_k\in J\setminus\mf p_k$, from which we set
		\[x_k:=y_k\prod_{\substack{1\le k\le n\\k\ne\ell}}x_{k,\ell}.\]
		None of the factors here live in $\mf p_k$, so $x_k\notin\mf p_k$. However, $x_k$ contains a factor in $J$ and in $\mf p_\ell$ for each $\ell\ne k$, so $x_k$ lives in each of those ideals. To finish, we note
		\[x:=\sum_{k=1}^nx_k\]
		will live in $J$ because each $x_k\in J$, but for each $\mf p_k$, $x_k\notin\mf p_k$ while $x_\ell\in\mf p_\ell$ for each $\ell\ne k$, so $x\notin\mf p_k$. Thus, $x\in J$ but not in any of the primes $\mf p_k$, finishing.
	\end{proof}
	The above lemma immediately finishes the proof.
\end{proof}
Lastly, we provide another way to generated associated primes, to close out our discussion.
\begin{prop} \label{prop:minassprimes}
	Fix $M$ a finitely generated module over a Noetherian ring $R$. If $\mf p$ is a minimal prime ideal containing $\op{Ann}M$, then $\mf p\in\op{Ass}M$.
\end{prop}
\begin{proof}
	The main idea is to localize at $\mf p$ so that $\op{Ass}M_\mf p$ should be $\{\mf pR_\mf p\}$. Because $M$ is finitely generated, \autoref{prop:fingensupport} tells us that $\mf p\supseteq\op{Ann}M$ implies $M_\mf p\ne0$. In particular, \autoref{cor:hasass} tells us that
	\[\op{Ass}_{R_\mf p}M_\mf p\ne\emp.\]
	However, \autoref{prop:localizeass} tells us that
	\[\op{Ass}_{R_\mf p}M_\mf p=\{\mf qR_\mf p:\mf q\in\op{Ass}M,\mf q\cap(R\setminus\mf p)=\emp\},\]
	which must be nonempty. So we are given some associated prime $\mf q\in\op{Ass}M$ with $\mf q\cap(R\setminus\mf p)=\emp$. But $\mf q\in\op{Ass}M$ implies that $\mf q\supseteq\op{Ann}M$ ($\mf q$ is an annihilator) while $\mf q\cap(R\setminus\mf p)=\emp$ implies that $\mf q\subseteq\mf p$. So minimality of $\mf p$ (!) tells us $\mf p=\mf q\in\op{Ass}M$, finishing.
\end{proof}
\begin{quot}
	I hope you see how powerful this idea is, of localization.
\end{quot}

\subsection{Motivating Primary Decomposition}
Let's give some motivational remarks for the primary decomposition. As an example, we consider $\ZZ$, where it happens that
\[(m)\cap(n)=(mn)=(m)(n).\]
This is a very nice property to have, with respect to proving unique prime factorization and such. Namely, to state unique prime factorization, we call an ideal ``primary'' if it is the power of some prime ideal. Then we see existence of prime factorization is saying that any ideal $(n)$ is the intersection of finitely many ``primary'' ideals.

We will try to generalize this. Here is our definition of ``primary.''
\begin{restatable}[Primary]{defihelper}{primarydefi} \nirindex{Primary}
	Fix $\mf p\in\op{Spec}R$ a prime ideal and $R$-modules $N\subseteq M$. Then $N$ is a \textit{$\mf p$-primary} submodule of $M$ if and only if
	\[\op{Ass}M/N=\{\mf p\}.\]
\end{restatable}
\begin{example}
	For a prime $p\in\ZZ$, the ideals $\left(p^k\right)$ are $p$-primary in $\ZZ$ by \autoref{exe:cyclicassociated}.
\end{example}
\begin{example}
	Any prime ideal $\mf p$ is $\mf p$-primary in $R$ because $\op{Ass}(R/\mf p)=\{\mf p\}$ by \autoref{ex:assrmodp}.
\end{example}
Let's prove one nice lemma to finish off today.
\begin{lemma} \label{lem:intersectprimary}
	Fix $M$ a module over a Noetherian ring $R$. Fix $N_1,\ldots,N_m$ a finite collection of $\mf p$-primary submodules of an $R$-module $M$. Then
	\[\bigcap_{k=1}^nN_k\]
	is also $\mf p$-primary.
\end{lemma}
\begin{proof}
	By induction, it suffices to show the result for $m=2$ so that we want to show $N_1\cap N_2$ is $\mf p$-primary. Now, we have the right-exact sequence
	\[0\to N_1\cap N_2\to M\to\frac M{N_1}\oplus\frac M{N_2},\]
	which tells us that we have an embedding $\frac M{N_1\cap N_2}\into\frac M{N_1}\oplus\frac M{N_2}$. But then \autoref{lem:assses} gives
	\[\op{Ass}\frac M{N_1\cap N_2}\subseteq\op{Ass}M/N_1\cup\op{Ass}M/N_2=\{\mf p\},\]
	so we are done. In particular, $\op{Ass}\frac M{N_1\cap N_2}\ne\emp$ by \autoref{cor:hasass} because $R$ is Noetherian and $N_1\cap N_2\subseteq N_1\subsetneq M$.
\end{proof}
And we close by stating the theorem.
\begin{theorem}[Primary Decomposition]
	Fix a finitely generated module $M$ over a Noetherian ring $R$. Then any submodule $M'\subseteq M$ is an intersection of finitely many primary submodules of $M$.
\end{theorem}