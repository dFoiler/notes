% !TEX root = ../notes.tex

\documentclass[../notes.tex]{subfiles}

\begin{document}

We completed a proof from last class.

\subsection{Serre Duality on \texorpdfstring{$\PP^n_k$}{ Pr}}
We now move towards a discussion of Serre duality, which is our version of Poincar\'e duality.
\begin{definition}[canonical sheaf]
	Fix a regular $k$-variety $X$. Then the \textit{canonical sheaf} is $\omega_X\coloneqq\land^n\Omega_{X/k}$, where $n\coloneqq\dim X$ and $\Omega_{X/k}$ is the sheaf of differentials (or equivalently, the cotangent sheaf) on $X$. Recall that $\Omega_{X/k}$ is locally free of rank $n$, so $\omega_X$ is a line bundle.
\end{definition}
\begin{example} \label{ex:omega-on-proj-space}
	When $X=\PP^r_A$, one has that $\omega_X=\OO_X(-n-1)$. This is a rather long computation, which we will take for granted for now.
\end{example}
Now, here is our Serre duality on projective space.
\begin{theorem}
	Fix a field $k$, and let $X\coloneqq\PP^n_k$ with $n>0$. Then the following hold.
	\begin{listalph}
		\item We have a non-canonical isomorphism $t\colon H^n(X,\omega_X)\cong k$.
		\item For any coherent sheaf $\mc F$ on $X$, the natural $k$-bilinear map
		\[\op{Hom}(\mc F,\omega_X)\otimes H^n(X,\mc F)\to H^n(X,\omega_X)\stackrel t\to k\]
		is a perfect pairing of finite-dimensional $k$-vector spaces. Here, the left map is given by $(\varphi,c)\mapsto H^n(\varphi)(c)$.
		\item For every $i\ge0$, there is a natural functorial isomorphism
		\[\op{Ext}^i(\mc F,\omega_X)\to\op{Hom}\left(H^{n-i}(X,\mc F),H^n(X,\omega_X)\right).\]
		When $i=0$, this recovers the perfect pairing of (b).
	\end{listalph}
\end{theorem}
\begin{remark} \label{rem:naturality-of-serre-pairing}
	Perhaps we should be more explicit about hat is meant by our pairing and isomorphism being ``natural.'' For (b), we are stating that the following diagram commutes (by functoriality) for any sheaf morphism $\varphi\colon\mc F\to\mc G$.
	% https://q.uiver.app/#q=WzAsOCxbMCwwLCJcXG9we0hvbX0oXFxtYyBGLFxcb21lZ2FfWCkiXSxbMCwxLCJcXG9we0hvbX0oXFxtYyBHLFxcb21lZ2FfWCkiXSxbMSwwLCJIXm4oWCxcXG1jIEYpIl0sWzEsMSwiSF5uKFgsXFxtYyBHKSJdLFsyLDEsIkhebihYLFxcb21lZ2FfWCkiXSxbMywwLCIoZ1xcdmFycGhpLGMpIl0sWzMsMSwiKGcsXFx2YXJwaGkoYykpIl0sWzQsMSwiSF5uKGdcXHZhcnBoaSkoYykiXSxbMSwwLCItXFxjaXJjXFx2YXJwaGkiXSxbMiw0LCJcXG9we2V2fV9cXG1jIEYiXSxbMyw0LCJcXG9we2V2fV9cXG1jIEciLDJdLFsyLDMsIkhebihcXHZhcnBoaSkiLDJdLFswLDIsIlxcdGltZXMiLDEseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJub25lIn0sImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMSwzLCJcXHRpbWVzIiwxLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoibm9uZSJ9LCJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzUsNiwiIiwxLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dLFs2LDcsIiIsMSx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XSxbNSw3LCIiLDEseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtYXBzIHRvIn19fV1d&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}
		{\op{Hom}(\mc F,\omega_X)} & {H^n(X,\mc F)} && {(g\varphi,c)} \\
		{\op{Hom}(\mc G,\omega_X)} & {H^n(X,\mc G)} & {H^n(X,\omega_X)} & {(g,\varphi(c))} & {H^n(g\varphi)(c)}
		\arrow["{-\circ\varphi}", from=2-1, to=1-1]
		\arrow["{\op{ev}_\mc F}", from=1-2, to=2-3]
		\arrow["{\op{ev}_\mc G}"', from=2-2, to=2-3]
		\arrow["{H^n(\varphi)}"', from=1-2, to=2-2]
		\arrow["\times"{description}, draw=none, from=1-1, to=1-2]
		\arrow["\times"{description}, draw=none, from=2-1, to=2-2]
		\arrow[maps to, from=1-4, to=2-4]
		\arrow[maps to, from=2-4, to=2-5]
		\arrow[maps to, from=1-4, to=2-5]
	\end{tikzcd}\]
\end{remark}
\begin{proof}
	Here we go. We quickly dispense of (a) and (b).
	\begin{listalph}
		\item This is immediate from combining \Cref{thm:cohom-proj-space} and \Cref{ex:omega-on-proj-space}.
		\item As a special case, first suppose that $\mc F$ is some sum of line bundles of the form $\OO_X(q)$. By summation, we can actually just handle $\mc F=\OO_X(q)$, and then the canonical isomorphisms
		\[\op{Hom}(\mc F,\omega_X)=\op{Hom}(\OO_X(q),\OO_X(-n-1))=\Gamma(X,\OO_X(-q-1-n)),\]
		and $H^n(X,\mc F)=\Gamma(X,\OO_X(q))$, so we again get this from \Cref{thm:coh-cohom-proj-space}.

		It remains to handle the general case, for which we use \Cref{rem:naturality-of-serre-pairing}. Note \cite[Corollary~II.5.18]{hartshorne} provides an exact sequence of the form
		\[\mc E_1\to\mc E_0\to\mc F\to0,\]
		where $\mc E_1$ and $\mc E_0$ are sums of $\OO_X(q)$s. This produces a commutative diagram of the following form.
		% https://q.uiver.app/#q=WzAsOCxbMCwwLCIwIl0sWzEsMCwiXFxvcHtIb219KFxcbWMgRixcXG9tZWdhX1gpIl0sWzIsMCwiXFxvcHtIb219KFxcbWMgRV8wLFxcb21lZ2FfWCkiXSxbMywwLCJcXG9we0hvbX0oXFxtYyBFXzEsXFxvbWVnYV9YKSJdLFsxLDEsIkhebihYLFxcbWMgRileXFxsb3IiXSxbMiwxLCJIXm4oWCxcXG1jIEVfMCleXFxsb3IiXSxbMywxLCJIXm4oWCxcXG1jIEVfMSleXFxsb3IiXSxbMCwxLCIwIl0sWzIsNV0sWzMsNl0sWzcsNF0sWzQsNV0sWzUsNl0sWzAsMV0sWzEsMl0sWzIsM10sWzEsNF1d&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
		\[\begin{tikzcd}
			0 & {\op{Hom}(\mc F,\omega_X)} & {\op{Hom}(\mc E_0,\omega_X)} & {\op{Hom}(\mc E_1,\omega_X)} \\
			0 & {H^n(X,\mc F)^\lor} & {H^n(X,\mc E_0)^\lor} & {H^n(X,\mc E_1)^\lor}
			\arrow[from=1-3, to=2-3]
			\arrow[from=1-4, to=2-4]
			\arrow[from=2-1, to=2-2]
			\arrow[from=2-2, to=2-3]
			\arrow[from=2-3, to=2-4]
			\arrow[from=1-1, to=1-2]
			\arrow[from=1-2, to=1-3]
			\arrow[from=1-3, to=1-4]
			\arrow[from=1-2, to=2-2]
		\end{tikzcd}\]
		Here, the commutativity is by using \Cref{rem:naturality-of-serre-pairing} to turn a morphism from a tensor product to a morphism into the dual. The top row is exact by left-exactness of $\op{Hom}$, and the bottom row is exact because it is the dual of the end of the long exact sequence for $\PP^n_k$. We will complete the proof next class.
	\end{listalph}
\end{proof}

\end{document}