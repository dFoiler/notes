% !TEX root = ../notes.tex

\documentclass[../notes.tex]{subfiles}

\begin{document}

We began class by completing the proof of \Cref{prop:compare-cartier-weil}.

\subsection{Even More on Cartier Divisors}
Have some miscellaneous remarks to \Cref{prop:compare-cartier-weil}.
\begin{remark}
	Let $A$ be the localization at the element $x^2-1$ of the subring of $k[x,y]$ generated by the homogeneous polynomials of degree not equal to $1$. Then set $X\coloneqq\Spec A$, which one can see is an integral smoothish scheme, but $X$ is nor normal. In fact, $\op{div}(x-1)$ vanishes as a Weil divisor (there is no height one prime to witness this being nonzero), but $x-1$ is not a regular function of $X$, so $\op{div}(x-1)$ is nonzero as a Cartier divisor.
\end{remark}
\begin{example}
	The scheme
	\[X\coloneqq\Spec\frac{\CC[x,y,z]}{\left(xy-z^2\right)}\]
	is normal, but it fails to be locally factorial: indeed, it is singular at $(0,0,0)$, and the prime divisor cut out by $y=z=0$ fails to be principal.
\end{example}
We now take the following definition in order to relate Cartier divisors back to line bundles.
\begin{definition}
	Fix an integral scheme $X$. Given a Cartier divisor $D$ on $X$ represented by $\{f_U\}_{U\in\mc U}$, we let $\OO_X(D)$ be the subsheaf of $\mc K_X$ by
	\[\OO_X(D)|_U\coloneqq f_U^{-1}\OO_U.\]
	Given an $\mathcal O_X$-module $\mc F$, we set $\mc F(D)\coloneqq\mc F\otimes_{\OO_X}\OO_X(D)$.
\end{definition}
Here are some sanity checks.
\begin{remark}
	Note that $\OO_X(D)$ does in fact assemble into a quasicoherent sheaf because $f_U/f_V\in\OO_X(U\cap V)^\times$ whenever $U,V\in\mc U$; in fact, $\OO_X(D)$ is  a line bundle because any $U\in\mc U$ has an isomorphism
	\[\OO_X(D)|_U\to\OO_U\]
	given by $f/f_U\mapsto f$.
	
	Also, we note that $\OO_X(D)$ is independent of the choice of representative $\{f_U\}_{U\in\mc U}$ for basically the same reason: if $\{g_V\}_{V\in\mc V}$ also represents $D$, then we note that the union of the two lists of rational sections also represents $D$, and the resulting $\OO_X(D)$ must agree in all three cases.
\end{remark}
\begin{remark} \label{rem:form-line-bundle-homomorphism}
	A direct computation shows that $\OO_X(D_1+D_2)\cong\OO_X(D_1)\otimes\OO_X(D_2)$. Explicitly, by refining open covers, we may assume that $D_1=\{f_U\}_{U\in\mc U}$ and $D_2=\{g_U\}_{U\in\mc U}$, and we have local isomorphisms
	% https://q.uiver.app/#q=WzAsOCxbMCwwLCJcXE9PX1goRF8xKXxfVVxcb3RpbWVzXFxPT19YKERfMil8X1UiXSxbMSwwLCJcXE9PX1goRF8xK0RfMil8X1UiXSxbMCwxLCJcXE9PX1VcXG90aW1lc1xcT09fVSJdLFsxLDEsIlxcT09fVSJdLFsyLDAsImZcXG90aW1lcyBnIl0sWzIsMSwiZl9VZlxcb3RpbWVzIGdfVWciXSxbMywwLCJmZyJdLFszLDEsImZfVWdfVWZnIl0sWzIsM10sWzAsMl0sWzEsM10sWzAsMSwiIiwwLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn19fV0sWzQsNiwiIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dLFs2LDcsIiIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XSxbNSw3LCIiLDIseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtYXBzIHRvIn19fV0sWzQsNSwiIiwyLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dXQ==&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}
		{\OO_X(D_1)|_U\otimes\OO_X(D_2)|_U} & {\OO_X(D_1+D_2)|_U} & {f\otimes g} & fg \\
		{\OO_U\otimes\OO_U} & {\OO_U} & {f_Uf\otimes g_Ug} & {f_Ug_Ufg}
		\arrow[from=2-1, to=2-2]
		\arrow[from=1-1, to=2-1]
		\arrow[from=1-2, to=2-2]
		\arrow[dashed, from=1-1, to=1-2]
		\arrow[maps to, from=1-3, to=1-4]
		\arrow[maps to, from=1-4, to=2-4]
		\arrow[maps to, from=2-3, to=2-4]
		\arrow[maps to, from=1-3, to=2-3]
	\end{tikzcd}\]
	which we can see glue together on the overlaps.
\end{remark}
Here is a more nontrivial check.
\begin{proposition}
	Fix Cartier divisors $D_1$ and $D_2$ of an integral scheme $X$. Then $\OO_X(D_1)\cong\OO_X(D_2)$ if and only if $D_1\sim D_2$.
\end{proposition}
\begin{proof}
	\Cref{rem:form-line-bundle-homomorphism} tells us that it suffices to show that $\OO_X(D)$ is trivial if and only if $D$ is principal. If $D$ is principal, then we see that $\OO_X(D)$ is trivial by construction because $D$ can be represented globally by a section.

	Conversely, suppose $\OO_X(D)$ is isomorphic to $\OO_X$. Then write $D=\{f_U\}_{U\in\mc U}$, and let $\varphi\colon\OO_X\to\OO_X(D)$ be the isomorphism, so we are told that $f\coloneqq\varphi(1)$ is a global section with $ff_U\in\OO_X(U)^\times$ for each $U$ (invertibility follows because $\varphi$ must be invertible), so $D=\op{div}(f)$.
\end{proof}

\end{document}