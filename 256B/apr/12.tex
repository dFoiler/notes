% !TEX root = ../notes.tex

\documentclass[../notes.tex]{subfiles}

\begin{document}

We continue discussing dualizing sheaves.

\subsection{More on Dualizing Sheaves}
We begin today with an aside.
\begin{proposition}
	One can upgrade \Cref{rem:yoneda-for-dualizing} as follows. Let $\mc C_1$ be the category of pairs $(\omega,t)$ where $\omega$ is coherent on $X$ and $t\colon H^n(X,\omega)\to k$; a morphism of such pairs is a morphism of the coherent sheaves commuting with the data of $t$. Then let $\mc C_2$ be the category of pairs $(\omega,\Psi)$ where $\omega$ is coherent on $X$ and $\Psi$ is a natural transformation $\op{Hom}(-,\omega)\to H^n(X,-)^\lor$; a morphism is again a morphism of the coherent sheaves commuting with the data of $\Psi$. Then these categories are equivalent.
\end{proposition}
\begin{proof}
	The point is to upgrade the constructions of \Cref{rem:yoneda-for-dualizing} into full functors, and we can check that these functors are inverses. Here are our constructions.
	\begin{itemize}
		\item Define $F\colon\mc C_1\to\mc C-2$ by sending the pair $(\omega,t)$ to the natural transformation $(\omega,\Psi)$, where we define $\Psi_\mc F\colon\op{Hom}(\mc F,\omega)\to H^n(X,\mc F)^\lor$ is defined by the pairing
		\[\Psi_\mc F(\varphi)(c)\coloneqq t\left(H^n(\varphi)c\right).\]
		Note that this is a natural transformation: for any $\alpha\colon\mc F\to\mc G$, the diagram
		% https://q.uiver.app/#q=WzAsOCxbMCwwLCJcXG9we0hvbX0oXFxtYyBHLFxcb21lZ2EpIl0sWzAsMSwiXFxvcHtIb219KFxcbWMgRixcXG9tZWdhKSJdLFsxLDAsIkhebihYLFxcbWMgRyleXFxsb3IiXSxbMSwxLCJIXm4oWCxcXG1jIEYpXlxcbG9yIl0sWzIsMCwiXFx2YXJwaGkiXSxbMiwxLCIoXFx2YXJwaGlcXGNpcmNcXGFscGhhKSJdLFszLDAsIlxcbGVmdChjXFxtYXBzdG8gdFxcbGVmdChIXm4oXFx2YXJwaGkpY1xccmlnaHQpXFxyaWdodCkiXSxbMywxLCJcXGxlZnQoY1xcbWFwc3RvIHRcXGxlZnQoSF5uKFxcdmFycGhpKUhebihcXGFscGhhKWNcXHJpZ2h0KVxccmlnaHQpIl0sWzAsMSwiXFxhbHBoYSIsMl0sWzAsMiwiXFxQc2lfXFxtYyBHIl0sWzEsMywiXFxQc2lfXFxtYyBGIl0sWzIsMywiXFxhbHBoYSJdLFs0LDUsIiIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XSxbNSw3LCIiLDAseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtYXBzIHRvIn19fV0sWzYsNywiIiwyLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dLFs0LDYsIiIsMix7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XV0=&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
		\[\begin{tikzcd}
			{\op{Hom}(\mc G,\omega)} & {H^n(X,\mc G)^\lor} & \varphi & {\left(c\mapsto t\left(H^n(\varphi)c\right)\right)} \\
			{\op{Hom}(\mc F,\omega)} & {H^n(X,\mc F)^\lor} & {(\varphi\circ\alpha)} & {\left(c\mapsto t\left(H^n(\varphi)H^n(\alpha)c\right)\right)}
			\arrow["\alpha"', from=1-1, to=2-1]
			\arrow["{\Psi_\mc G}", from=1-1, to=1-2]
			\arrow["{\Psi_\mc F}", from=2-1, to=2-2]
			\arrow["\alpha", from=1-2, to=2-2]
			\arrow[maps to, from=1-3, to=2-3]
			\arrow[maps to, from=2-3, to=2-4]
			\arrow[maps to, from=1-4, to=2-4]
			\arrow[maps to, from=1-3, to=1-4]
		\end{tikzcd}\]
		commutes.

		On morphisms, suppose we have some morphism $\beta\colon(\omega,t)\to(\omega',t')$. Then we define $F_1\beta\colon(\omega,\Psi)\to(\omega',\Psi')$ using the same underlying morphism of sheaves $\omega\to\omega'$. To see that this commutes with the data of the natural transformation, we note that the diagram
		% https://q.uiver.app/#q=WzAsOCxbMCwwLCJcXG9we0hvbX0oXFxtYyBGLFxcb21lZ2FfMSkiXSxbMCwxLCJcXG9we0hvbX0oXFxtYyBGLFxcb21lZ2FfMikiXSxbMSwxLCJIXm4oWCxcXG1jIEYpXlxcbG9yIl0sWzEsMCwiSF5uKFgsXFxtYyBGKV5cXGxvciJdLFsyLDAsIlxcdmFycGhpIl0sWzIsMSwiKFxcdmFycGhpXFxjaXJjXFxiZXRhKSJdLFszLDAsIlxcbGVmdChjXFxtYXBzdG8gdFxcbGVmdChIXm4oXFx2YXJwaGkpY1xccmlnaHQpXFxyaWdodCkiXSxbMywxLCJcXGxlZnQoY1xcbWFwc3RvIHQnXFxsZWZ0KEhebihcXHZhcnBoaVxcY2lyY1xcYmV0YSljXFxyaWdodClcXHJpZ2h0KSJdLFswLDMsIlxcUHNpXzEoXFxtYyBGKSJdLFsxLDIsIlxcUHNpXzIoXFxtYyBGKSJdLFswLDEsIi1cXGNpcmNcXGJldGEiLDJdLFszLDIsIiIsMSx7ImxldmVsIjoyLCJzdHlsZSI6eyJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzQsNSwiIiwyLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dLFs1LDcsIiIsMix7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1hcHMgdG8ifX19XSxbNiw3LCIiLDAseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtYXBzIHRvIn19fV0sWzQsNiwiIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibWFwcyB0byJ9fX1dXQ==&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
		\[\begin{tikzcd}
			{\op{Hom}(\mc F,\omega_1)} & {H^n(X,\mc F)^\lor} & \varphi & {\left(c\mapsto t\left(H^n(\varphi)c\right)\right)} \\
			{\op{Hom}(\mc F,\omega_2)} & {H^n(X,\mc F)^\lor} & {(\varphi\circ\beta)} & {\left(c\mapsto t'\left(H^n(\varphi\circ\beta)c\right)\right)}
			\arrow["{\Psi_1(\mc F)}", from=1-1, to=1-2]
			\arrow["{\Psi_2(\mc F)}", from=2-1, to=2-2]
			\arrow["{-\circ\beta}"', from=1-1, to=2-1]
			\arrow[Rightarrow, no head, from=1-2, to=2-2]
			\arrow[maps to, from=1-3, to=2-3]
			\arrow[maps to, from=2-3, to=2-4]
			\arrow[maps to, from=1-4, to=2-4]
			\arrow[maps to, from=1-3, to=1-4]
		\end{tikzcd}\]
		commutes because $\beta\colon(\omega,t)\to(\omega',t')$ is already a morphism.

		We omit the functoriality checks.

		\item Define $G\colon\mc C_2\to\mc C_1$ by sending the pair $(\omega,\Psi)$ to the pair $(\omega,t)$, where $t$ is defined by $\Psi_\omega({\id_\omega})$. We will omit the remaining checks for this functor because they are all similar to the previous functor.
	\end{itemize}
	We omit the checks that these functors are inverse, though it is not too hard to check by hand.
\end{proof}
\begin{remark}
	Take $X=\PP^n_k$, and set $\omega\coloneqq\OO_X(-n-1)$. Then $H^n(X,\OO_X(-n-1))\cong k$, so we can fix some isomorphism $t$. Then $t$ allows us to choose an element $\alpha\in H^n(X,\OO_X(-n-1))$ such that $t(\alpha)=1$, and now one can check that $(\omega,t)$ is a dualizing sheaf by tracking $\alpha$ around as needed.
\end{remark}

\subsection{Dualizing Sheaves for Projective Schemes}
We would like to transfer duality from $\PP^N_k$ back down to $X$.
\begin{lemma} \label{lem:ext-of-dualizing-sheaf}
	Let $X$ be a closed subscheme of $\PP^N_k$ of codimension $r$. Then
	\[\mc Ext^i_{\PP^N_k}(\OO_X,\omega_{\PP^N_k})=0\]
	for all $i<r$.
\end{lemma}
\begin{proof}
	For brevity, let the sheaf in question be $\mc F^i$. We can do cohomology just with coherent sheaves, so $\mc F^i$ is coherent (see also \cite[Exercise~6.3]{hartshorne}). Thus, $\mc F^i(q)$ is globally generated for $q$ large enough. So by undoing the twisting, it is enough to show that
	\[\Gamma\left(\PP^N_k,\mc F^i(q)\right)\stackrel?=0\]
	for $q$ large enough. Well, by expanding out our definitions and moving around the twisting inside the $\mc Ext$ and applying \Cref{prop:twist-ext-vanishes}, we see
	\begin{align*}
		\Gamma\left(\PP^N_k,\mc F^i(q)\right) &= \Gamma\left(\PP^N_k,\mc Ext^i_{\PP^N_k}(\OO_X,\omega_{\PP^N_k}(q))\right) \\
		&= \op{Ext}^i_{\PP^N_k}(\OO_X,\omega_{\PP^N_k}(q)) \\
		&= \op{Ext}^i_{\PP^N_k}(\OO_X(-q),\omega_{\PP^N_k}) \\
		&\stackrel*= H^{N-i}\left(X,\OO_X(-q)\right)^\lor,
	\end{align*}
	where the last step has used \Cref{thm:serre-dual-proj-space}. Now, this last cohomology group vanishes for $q$ large enough by \Cref{thm:cohom-proj-space}, so we are done.
\end{proof}
\begin{remark}
	Later in life, we will be able to upgrade this result to replace $\PP^N_k$ with any equidimensional Cohen--Macaulay scheme.
\end{remark}
\begin{lemma} \label{lem:check-dualizing-sheaf}
	Let $X$ be a closed subscheme of $\PP^N_k$ of codimension $r$. Set $\omega_X^\circ\coloneqq\mc Ext^r\left(\OO_X,\omega_{\PP^N_k}\right)$. Then we have a natural isomorphism
	\[\op{Hom}_X\left(\mc F,\omega_X^\circ\right)\cong\op{Ext}^r_{\PP^N_k}\left(\mc F,\omega_{\PP^N_k}\right),\]
	where $\mc F$ is any $\OO_X$-module.
\end{lemma}
\begin{proof}
	Fix an injective resolution $\omega_{\PP^N_k}\to\mc I^\bullet$ of $\omega_{\PP^N_k}$ by injective $\OO_{\PP^N_k}$-modules. Notably,
	\[\mc Ext^i_{\PP^N_k}(\mc F,\omega_{\PP^N_k})=h^i\left(\mc Hom_{\PP^N_k}(\mc F,\mc I^\bullet)\right)\qquad\text{and}\qquad\op{Ext}^i_{\PP^N_k}(\mc F,\omega_{\PP^N_k})=h^i\left(\op{Hom}_{\PP^N_k}(\mc F,\mc I^\bullet)\right).\]
	We now proceed in steps.
	\begin{enumerate}
		\item We begin with an algebraic lemma. Fix a ring $A$, and let $I\subseteq A$ be an ideal. Given an $A/I$-module $M$ and an $N$-module $A$, we claim
		\[\op{Hom}_A(M,N)\stackrel?\cong\op{Hom}_{A/I}(M,\op{Hom}_A(A/I,N)).\]
		Indeed, note $\op{Hom}_A(A/I,N)$ is isomorphic to $N'\coloneqq\{n\in N:an=0\text{ for }a\in I\}$ by the map $\varphi\mapsto\varphi(1)$. So our right-hand side is $\op{Hom}_{A/I}(M,N')$, but that's just $\op{Hom}_A(M,N')$ because asserting that our morphism is over $(A/I)$ or over $A$ has no content. Lastly, $\op{Hom}_A(M,N')$ is $\op{Hom}_A(M,N)$ because the image of any morphism out of $M$ needs to land inside the submodule of $N$ killed by $I$, which is precisely $N'$.

		\item Let's apply this. If $\mc F$ is a sheaf of $\OO_X$-modules, and $\mc I$ is a sheaf of $\OO_{\PP^N_k}$-modules, then we claim that
		\begin{equation}
			\op{Hom}_X\left(\mc F,\mc Hom_{\PP^N_k}(\OO_X,\mc I)\right)\stackrel?\cong\op{Hom}_{\PP^N_k}(\mc F,\mc I). \label{eq:get-out-of-x}
		\end{equation}
		Indeed, in one direction, we have an inclusion
		\[\op{Hom}_X\left(\mc F,\mc Hom_{\PP^N_k}(\OO_X,\mc I)\right)=\op{Hom}_{\PP^N_k}\left(\mc F,\mc Hom_{\PP^N_k}(\OO_X,\mc I)\right)\subseteq\op{Hom}_{\PP^N_k}(\mc F,\mc I).\]
		Namely, the first map simply acknowledge that any morphism out of $\mc F$ must be killed by the ideal sheaf of $X$ anyway, and the second map is an inclusion because the surjection $\OO_{\PP^N_k}\onto\OO_X$ yields an inclusion $\mc Hom_{\PP^N_k}(\OO_X,\mc I)\to\mc Hom_{\PP^N_k}(\OO_{\PP^N_k},\mc I)$, which we can then upgrade to $\mc F$.
		
		It remains to check that our map in \eqref{eq:get-out-of-x} is a surjection. Namely, we would like to show that a morphism $\varphi\in\op{Hom}_{\PP^N_k}(\mc F,\mc I)$ has its image contained in $\mc Hom_{\PP^N_k}(\OO_X,\mc I)$. Well, note $\OO_X$ is coherent over $\PP^N_k$, so we get
		\[\mc Hom_{\PP^N_k}(\OO_X,\mc I)_p=\op{Hom}_{\OO_{\PP^N_k,p}}(\OO_{X,p},\mc I_p)\]
		by \Cref{prop:stalk-of-ext}. As such, we want to show that $\im\varphi_p\subseteq\op{Hom}_{\OO_{\PP^N_k,p}}(\OO_{X,p},\mc I_p)$, but this target is just the subset of $\mc I_p$ killed by the ideal sheaf defining $\OO_{X,p}$, which is surely in the image of $\varphi_p$ because $\varphi$ factors through $\mc F$, which is an $\mathcal O_X$-module. This finishes the verification of \eqref{eq:get-out-of-x}.

		\item We now claim that injective $\OO_{\PP^N_k}$-modules $\mc I$ produces injective $\OO_X$-modules $\mc J\coloneqq\mc Hom_{\PP^N_k}(\OO_X,\mc I)$. The above step promises that $\op{Hom}_X(-,\mc J)$ and $\op{Hom}_{\PP^N_k}(-,\mc I)$ are naturally isomorphic functors, so the exactness of the latter produces the exactness of the former.

		\item Now set $\mc J^\bullet\coloneqq\mc Hom_{\PP^N_k}(\OO_X,\mc I^\bullet)$. We claim that
		\[0\to\mc J^0\to\mc J^1\to\cdots\to\mc J^{r-1}\to\mc J^r\]
		is exact. Indeed, for $i<r$, we see
		\[h^i(\mc J^\bullet)=h^i(\mc Hom_X(\OO_X,\mc I^\bullet))=h^i\left(\mc Hom_{\PP^N_k}(\OO_X,\mc I^\bullet)\right)=\mc Ext^i_{\PP^N_k}(\OO_X,\omega_{\PP^N_k}),\]
		which vanishes by \Cref{lem:ext-of-dualizing-sheaf}.

		\item Now, set $\mc J_1^r$ to be the image of the map $\mc J^{r-1}\to\mc J^r$ so that we get the exact sequence
		\[0\to\mc J^0\to\mc J^1\to\cdots\to\mc J^{r-1}\to\mc J_1^r\to0.\]
		We claim that $\mc J_1^r$ is in fact injective by an induction on $r$. Indeed, the main point is that we can decompose this exact sequence into short exact sequences of the form
		\[0\to\mc I'\to\mc I\to\mc I''\to0,\]
		where $\mc I'$ is injective by inductive hypothesis, and $\mc I$ is injective. Then this short exact sequence splits because $\mc I'$ is injective, and then $\mc I''$ is injective because $\op{Hom}(-,\mc I'')$ then embeds (via the splitting) into the exact functor $\op{Hom}(-,\mc I)$, forcing exactness.

		\item We now complete the proof. Set $\mc J_2^r$ via the splitting so that $\mc J^r=\mc J_1^r\oplus\mc J_2^r$. Then define the two complexes
		\[\mc J_1^i\coloneqq\begin{cases}
			\mc J^i & \text{if }i<r, \\
			\mc J_1^r & \text{if }i=r, \\
			0 & \text{if }i>r,
		\end{cases}\qquad\text{and}\qquad\mc J_2^i\coloneqq\begin{cases}
			0 & \text{if }i<r, \\
			\mc J_2^r & \text{if }i=r ,\\
			\mc J^i & \text{if }i>r.
		\end{cases}\]
		Thus, we see that $\mc J^\bullet\cong\mc J_1^\bullet\oplus\mc J_2^\bullet$ by construction, all terms involved are injective, and $\mc J_1^\bullet$ is exact.

		We now compute using our resolutions. For example, we see that
		\[\omega_X^\circ=\mc Ext^r_{\PP^N_k}(\OO_X,\omega_{\PP^N_k})=h^r(\mc J^\bullet)\]
		using our injective resolution, but then this is $h^r(\mc J_2^\bullet)$ by construction of $\mc J_2^\bullet$, so we see that
		\[\omega_X^\circ=\ker\left(\mc J_2^r\to\mc J_2^{r+1}\right)\]
		because $\mc J_2^{r-1}=0$. So we live in a left-exact sequence
		\[0\to\omega_X^\circ\to\mc J_2^r\to\mc J_2^{r+1}.\]

		We now introduce $\mc F$. For any $\OO_X$-module $\mc F$, we may compute
		\begin{align*}
			\op{Ext}^r(\mc F,\omega_{\PP^N_k}) &= h^r(\op{Hom}_{\PP^N_k}(\mc F,\mc I^\bullet)) \\
			&= h^r(\op{Hom}_X(\mc F,\mc J^\bullet)) \\
			&= h^r(\op{Hom}_X(\mc F,\mc J_1^\bullet))\oplus h^r(\op{Hom}_X(\mc F,\mc J_2^\bullet)) \\
			&= \op{Hom}_X(\mc F,\omega_X^\circ),
		\end{align*}
		where the last equality follows in two pieces: note $\op{Hom}_X(\mc F,\mc J_1^{r-1})\to\op{Hom}_X(\mc F,\mc J_1^r)$ is surjective because $\mc J_1^r$ is a direct summand of $\mc J^r$, so the left term with $\mc J_1^\bullet$ vanishes, and then the previous paragraph provides the right-exact sequence
		\[\op{Hom}(\mc F,\mc J_2^r)\to\op{Hom}_X\left(\mc F,\mc J_2^{r+1}\right)\to\op{Hom}(\mc F,\omega_X^\circ)\to0,\]
		thus completing the proof. We take a moment to recognize that all the above isomorphisms are indeed functorial in $\mc F$.
		\qedhere
	\end{enumerate}
\end{proof}

\end{document}