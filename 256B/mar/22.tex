% !TEX root = ../notes.tex

\documentclass[../notes.tex]{subfiles}

\begin{document}

\section{March 22}

We continue our discussion of Serre duality. Our goal for today is to discuss the dualizing sheaf.

\subsection{The Dualizing Sheaf}
Serre duality arises from the dualizing sheaf. On $\PP^n_k$, our dualizing sheaf was $\omega\coloneqq\Omega{\PP^n_k/k}^{\lor n}$, where the ``dualizing'' refers to \Cref{thm:serre-duality-pn}. Let's make rigorous what a dualizing sheaf should be.
\begin{definition}[dualizing sheaf]
	Fix a proper $n$-dimensional $k$-scheme $X$. Then a \textit{dualizing sheaf} is a coherent sheaf $\omega^\circ_X$ on $X$ equipped with a trace morphism $t\colon H^n(X,\omega^\circ_X)\to k$ such that the induced pairing
	\[\op{Hom}(\mc F,\omega^\circ_X)\times H^n(X,\mc F)\to H^n(X,\omega_X^\circ)\stackrel t\to k\]
	is a perfect pairing; here, $\varphi\colon\mc F\to\omega_X^\circ$ is sent to the natural map $H^n(\varphi)\colon H^n(X,\mc F)\to H^n(X,\omega_X^\circ)$.
\end{definition}
Here is a quick remark that allows us to say ``the dualizing sheaf.''
\begin{proposition}
	Fix a proper $n$-dimensional $k$-scheme $X$. If the dualizing sheaf $(\omega^\circ_X,t)$ exists, then it is unique up to unique isomorphism.
\end{proposition}
\begin{proof}
	Suppose that we have dualizing sheaves $(\omega,t)$ and $(\omega',t')$. We show there is a unique isomorphism $\omega\cong\omega'$ such that the induced composite
	\[H^n(X,\omega)\cong H^n(X,\omega')\stackrel{t'}\to k\]
	is simply $t$.
	
	Well, there's not much that we can do here. Because $\omega'$ is a dualizing sheaf, we see that
	\[\op{Hom}(\omega,\omega')\cong H^n(X,\omega)^\lor,\]
	so there is a unique morphism $\varphi'\colon\omega\to\omega'$ such that the composite $t'\circ H^n(\varphi')$ is equal to $t$. Thus, we see that the map $\omega\to\omega'$ satisfying the requirement on our composite above is unique, so it remains to show that this unique map is actually an isomorphism.
	
	Well, reversing the roles of $\omega$ and $\omega'$ in this argument, there is also a unique morphism $\varphi\colon\omega'\to\omega$ such that $t\circ H^n(\varphi)=t'$. We now claim that $\varphi$ and $\varphi'$ are our canonical isomorphisms. By symmetry, it is enough to check that $\varphi\circ\varphi'=\id_\omega$. Well, we note that
	\[t\circ H^n(\varphi\circ\varphi')=t\circ H^n(\varphi)\circ H^n(\varphi')=t'\circ H^n(\varphi')=t\]
	by construction of $\varphi$ and $\varphi'$. However, there is a unique map $\psi\colon\omega\to\omega$ such that $t\circ H^n(\psi)=t$ because $\omega$ is a dualizing sheaf, and this map $\psi$ must be $\id_\omega$, so we conclude that $\varphi\circ\varphi'=\id_\omega$. This completes the proof.
\end{proof}
It remains to construct a dualizing sheaf for projective schemes. Roughly speaking, this arises from the more general framework of Grothendieck duality. Namely, the more natural statement is that we have to look at a ``dualizing complex'' as an adjunction statement like
\[Rf_*(R\mathcal Hom(\mc F,Rf^!\mc G))=\mathcal Hom(Rf_*\mc F,\mc G).\]
Here, one has to look at complexes instead of sheaves, which is slightly problematic for our statement of Serre duality, but we will be able to show that this dualizing complex is in fact concentrated in a single degree, under nice enough hypotheses.

Explicitly, our dualizing sheaf is going to be $\omega_X=Ri^!\omega_\PP$, where $i\colon X\to\PP$ is our closed embedding, and it turns out that most of this complex vanishes. Here is our result.
\begin{proposition}
	Set $\PP\coloneqq\PP^n_k$ for a field $k$, and fix a closed subscheme $i\colon X\to\PP$ of codimension $r$. Then $\mathcal Ext^i(i_*\OO_X,\omega_\PP^\circ)=0$ for $i<r$.
\end{proposition}
\begin{proof}
	For brevity, set $\mc F^i\coloneqq\mathcal Ext^i(i_*\OO_X,\omega_\PP^\circ)=0$. Because $\mc F^i$ is coherent, it is generated by global sections after large enough twisting (this is the definition of being ample), so it is enough to show that
	\[\Gamma(X,\mc F^i(q))=0\]
	for $q$ sufficiently large. Well, for $q$ sufficiently large, \Cref{prop:global-secs-ext} (and \Cref{lem:twist-ext-by-vector-bundle}) tells us that
	\[\Gamma(X,\mc F^i(q))=\op{Ext}^i(i_*\OO_X,\omega^\circ_\PP(q))=\op{Ext}^i(i_*\OO_X(-q),\omega^\circ_\PP).\]
	We can now use Serre duality on projective space: by \Cref{thm:serre-duality-pn} (and \Cref{cor:closed-embed-preserve-cohom}), we see
	\[\op{Ext}^i(i_*\OO_X(-q),\omega^\circ_\PP)=H^{n-i}(\PP,i_*\OO_X(-q))^\lor=H^{n-i}(X,\OO_X(-q))^\lor.\]
	However, for $i<r$, we see $n-i>r$, so these cohomology groups $H^{n-i}(X,\OO_X(-q))$ vanishes by \Cref{thm:dimension-bound-cohom}, so we are done.
\end{proof}
We've been talking about $i^!$ for some time now, but we haven't given it a formal definition, so we should do that now. Roughly speaking, topologically, this should mean cohomology with supports, but we need to add in our algebraic geometry information of nilpotents for everything to go through. So here is our definition.
\begin{definition}
	Fix a closed embedding $i\colon Y\to X$ of schemes given by the quasicoherent ideal sheaf $\mc I$. Then for an abelian sheaf $\mc F$ on $X$, we define
	\[i^!(\mc F)\coloneqq i^*\mathcal Hom_X(i_*\OO_Y,\mc F).\]
	Explicitly, $\mathcal Hom_X(i_*\OO_X,\mc F)$ is naturally a module over $\OO_X/\mc I$, so we have defined a sheaf on $Y$.
\end{definition}
By the definition, we see that $i^!$ is left-exact, and we have an adjunction
\[\op{Hom}(i_*\mc F,\mc G)=\op{Hom}(i_*\mc F\otimes i_*\OO_Y,\mc G)=\op{Hom}(i_*\mc F,\mathcal Hom(i_*\OO_Y,\mc G)).\]
But now $\mathcal Hom(i_*\OO_Y,\mc G)$ is supported in $Y$ as noted above, so nothing changes if we hit with $i_*i^*$ to do nothing, and so because $i_*$ is fully faithful, we see
\[\op{Hom}(i_*\mc F,\mc G)=\op{Hom}(\mc F,i^*\mathcal Hom(i_*\OO_Y,\mc G))=\op{Hom}(\mc F,i^!\mc G).\]
Similarly, there is a natural isomorphism $\mathcal Hom(i_*\mc F,\mc G)\to i_*\mathcal Hom(\mc F,i^!\mc G)$. Applying the adjunction $(i_*,i^*)$, it is enough to provide a natural isomorphism
\[\mathcal Hom(i_*\mc F,\mc G)\otimes i_*\mc F\cong i_*(i^*\mathcal Hom(i_*\mc F,\mc G)\otimes\mc F).\]
Applying the adjunction again, it is enough to provide the map $i^*i_*\mc F\to\mc F$ and then take the tensor product with $i^*\mathcal Hom(i_*\mc F,\mc G)$.

Anyway, because $i^!$ is left-exact (it's basically $\mathcal Hom_X(i_*\OO_Y,-)$), we can right-derive it and so on.
\begin{lemma}
	Set $\PP\coloneqq\PP^n_k$ for a field $k$, and fix a closed subscheme $i\colon X\to\PP$ of codimension $r$. Then set $\omega^\circ_X\coloneqq H^rRi^!\omega_\PP$. Then $\omega^\circ_X=\mathcal Ext^r(i_*\OO_X,\omega_\PP)$, and for any $\OO_X$-module $\mc F$, we have
	\[\op{Hom}_X(\mc F,\omega_X^\circ)\cong\op{Ext}^r_\PP(i_*\mc F,\omega_\PP).\]
\end{lemma}
\begin{proof}
	Let $\tau$ denote the truncation of a complex. Then we see that we have a short exact sequence of complexes
	\[0\to R\op{Hom}(\mc F,\omega_X^\circ)\to R\op{Hom}(\mc F,Ri^!\omega_\PP[r])\to R\op{Hom}(\mc F,\tau_{>0}Ri^!\omega_\PP[r])\to0,\]
	so the long exact sequence in degree $0$ produces
	\[0\to\op{Hom}(\mc F,\omega_X^\circ)\to\op{Ext}^r(i_*\mc F,\omega_\PP)\to0,\]
	which is the result that we wanted in conclusion. (Notably, the rightmost term vanishes in degree $0$ because it has been truncated to positive degrees.)

	For the other claim, we use the previous adjunction to write
	\[R\mathcal Hom(i_*\OO_X,\omega_\PP)=i_*R\mathcal Hom_Y(\OO_X,Ri^!\omega_\PP)=i_*Ri^!\omega_\PP,\]
	so taking cohomology in degree $r$ completes the proof.
\end{proof}

\end{document}